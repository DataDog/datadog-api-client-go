---
version: 1
interactions:
- request:
    body: |
      {"cases":[{"condition":"nevermatch \u003e 1000","name":"rule-case","status":"info"}],"enabled":true,"message":"rule message","name":"go-TestSecMonRulesCRUD-local-1595581175-0","options":{"evaluationWindow":300,"keepAlive":300,"maxSignalDuration":300},"queries":[{"distinctFields":[],"groupByFields":[],"name":"nevermatch","query":"thiswillnevernevermatch"}],"tags":["datadog-api-client-test-go"]}
    form: {}
    headers:
      Accept:
      - application/json
      Content-Type:
      - application/json
      Dd-Operation-Id:
      - CreateSecurityMonitoringRule
      User-Agent:
      - datadog-api-client-go/1.0.0-beta.7+dev (go go1.14.1; os darwin; arch amd64)
      X-Datadog-Parent-Id:
      - "6111120968537487820"
      X-Datadog-Sampling-Priority:
      - "1"
      X-Datadog-Trace-Id:
      - "8825420659722329676"
    url: https://api.datadoghq.com/api/v2/security_monitoring/rules
    method: POST
  response:
    body: '{"creationAuthorId":7194,"tags":["datadog-api-client-test-go"],"isEnabled":false,"hasExtendedTitle":false,"message":"rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1595581176119,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"wva-emy-ucy","isDefault":false,"name":"go-TestSecMonRulesCRUD-local-1595581175-0"}'
    headers:
      Cache-Control:
      - no-cache
      Connection:
      - keep-alive
      Content-Disposition:
      - inline
      Content-Type:
      - application/json;charset=utf-8
      Date:
      - Fri, 24 Jul 2020 08:59:36 GMT
      Pragma:
      - no-cache
      Set-Cookie:
      - AWSALB=GtWloabdGDeuU1y8Nf4ggIaqiGczV87JjbCPVx6fEw3/4WQi16kESXA8kUSKpcQ3dPhuF3Ugh/ixN5gsZOsWVUY+ae5FhwoviKdiZYq/jMui5biKRV+vB1fujsW7;
        Expires=Fri, 31 Jul 2020 08:59:35 GMT; Path=/
      - AWSALBCORS=GtWloabdGDeuU1y8Nf4ggIaqiGczV87JjbCPVx6fEw3/4WQi16kESXA8kUSKpcQ3dPhuF3Ugh/ixN5gsZOsWVUY+ae5FhwoviKdiZYq/jMui5biKRV+vB1fujsW7;
        Expires=Fri, 31 Jul 2020 08:59:35 GMT; Path=/; SameSite=None; Secure
      - DD-PSHARD=0; Max-Age=604800; Path=/; expires=Fri, 31-Jul-2020 08:59:36 GMT;
        secure; HttpOnly
      Strict-Transport-Security:
      - max-age=15724800;
      Vary:
      - Accept-Encoding
      X-Content-Type-Options:
      - nosniff
      X-Dd-Version:
      - "35.2781816"
      X-Frame-Options:
      - SAMEORIGIN
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: |
      {"cases":[{"condition":"nevermatch \u003e 1000","name":"rule-case","status":"info"}],"enabled":true,"message":"rule message","name":"go-TestSecMonRulesCRUD-local-1595581175-1","options":{"evaluationWindow":300,"keepAlive":300,"maxSignalDuration":300},"queries":[{"distinctFields":[],"groupByFields":[],"name":"nevermatch","query":"thiswillnevernevermatch"}],"tags":["datadog-api-client-test-go"]}
    form: {}
    headers:
      Accept:
      - application/json
      Content-Type:
      - application/json
      Dd-Operation-Id:
      - CreateSecurityMonitoringRule
      User-Agent:
      - datadog-api-client-go/1.0.0-beta.7+dev (go go1.14.1; os darwin; arch amd64)
      X-Datadog-Parent-Id:
      - "9219252492348085309"
      X-Datadog-Sampling-Priority:
      - "1"
      X-Datadog-Trace-Id:
      - "8825420659722329676"
    url: https://api.datadoghq.com/api/v2/security_monitoring/rules
    method: POST
  response:
    body: '{"creationAuthorId":7194,"tags":["datadog-api-client-test-go"],"isEnabled":false,"hasExtendedTitle":false,"message":"rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1595581176350,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"ops-rol-bmn","isDefault":false,"name":"go-TestSecMonRulesCRUD-local-1595581175-1"}'
    headers:
      Cache-Control:
      - no-cache
      Connection:
      - keep-alive
      Content-Disposition:
      - inline
      Content-Type:
      - application/json;charset=utf-8
      Date:
      - Fri, 24 Jul 2020 08:59:36 GMT
      Pragma:
      - no-cache
      Set-Cookie:
      - AWSALB=x6CMffFFVeKjMMxQy1SLqP7UssnThVr5Me7ST6Sg5OvMKXLNA5YnhckYixooaTXQy2gHRRHu5lSsAJGs8Eu1M3tgahGh6dFYpFmySlIdQEqAi8s7KKKig1pex2wO;
        Expires=Fri, 31 Jul 2020 08:59:36 GMT; Path=/
      - AWSALBCORS=x6CMffFFVeKjMMxQy1SLqP7UssnThVr5Me7ST6Sg5OvMKXLNA5YnhckYixooaTXQy2gHRRHu5lSsAJGs8Eu1M3tgahGh6dFYpFmySlIdQEqAi8s7KKKig1pex2wO;
        Expires=Fri, 31 Jul 2020 08:59:36 GMT; Path=/; SameSite=None; Secure
      - DD-PSHARD=0; Max-Age=604800; Path=/; expires=Fri, 31-Jul-2020 08:59:36 GMT;
        secure; HttpOnly
      Strict-Transport-Security:
      - max-age=15724800;
      Vary:
      - Accept-Encoding
      X-Content-Type-Options:
      - nosniff
      X-Dd-Version:
      - "35.2781816"
      X-Frame-Options:
      - SAMEORIGIN
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: |
      {"cases":[{"condition":"nevermatch \u003e 1000","name":"rule-case","status":"info"}],"enabled":true,"message":"rule message","name":"go-TestSecMonRulesCRUD-local-1595581175-2","options":{"evaluationWindow":300,"keepAlive":300,"maxSignalDuration":300},"queries":[{"distinctFields":[],"groupByFields":[],"name":"nevermatch","query":"thiswillnevernevermatch"}],"tags":["datadog-api-client-test-go"]}
    form: {}
    headers:
      Accept:
      - application/json
      Content-Type:
      - application/json
      Dd-Operation-Id:
      - CreateSecurityMonitoringRule
      User-Agent:
      - datadog-api-client-go/1.0.0-beta.7+dev (go go1.14.1; os darwin; arch amd64)
      X-Datadog-Parent-Id:
      - "8879271761613837710"
      X-Datadog-Sampling-Priority:
      - "1"
      X-Datadog-Trace-Id:
      - "8825420659722329676"
    url: https://api.datadoghq.com/api/v2/security_monitoring/rules
    method: POST
  response:
    body: '{"creationAuthorId":7194,"tags":["datadog-api-client-test-go"],"isEnabled":false,"hasExtendedTitle":false,"message":"rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1595581176519,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"6lt-fvq-qaw","isDefault":false,"name":"go-TestSecMonRulesCRUD-local-1595581175-2"}'
    headers:
      Cache-Control:
      - no-cache
      Connection:
      - keep-alive
      Content-Disposition:
      - inline
      Content-Type:
      - application/json;charset=utf-8
      Date:
      - Fri, 24 Jul 2020 08:59:36 GMT
      Pragma:
      - no-cache
      Set-Cookie:
      - AWSALB=tXk8p7Vnjn5bTh9gcGzqNNTC0flBM7hjWpFQNo/2JuHgzQqvdh/vwJrh8ff6T1Rs7m9VqpWaqr/thXR9TU90IokOCgAwzlnk0YDhvruO65nhwb1HpmOfB4KlSe8p;
        Expires=Fri, 31 Jul 2020 08:59:36 GMT; Path=/
      - AWSALBCORS=tXk8p7Vnjn5bTh9gcGzqNNTC0flBM7hjWpFQNo/2JuHgzQqvdh/vwJrh8ff6T1Rs7m9VqpWaqr/thXR9TU90IokOCgAwzlnk0YDhvruO65nhwb1HpmOfB4KlSe8p;
        Expires=Fri, 31 Jul 2020 08:59:36 GMT; Path=/; SameSite=None; Secure
      - DD-PSHARD=0; Max-Age=604800; Path=/; expires=Fri, 31-Jul-2020 08:59:36 GMT;
        secure; HttpOnly
      Strict-Transport-Security:
      - max-age=15724800;
      Vary:
      - Accept-Encoding
      X-Content-Type-Options:
      - nosniff
      X-Dd-Version:
      - "35.2781836"
      X-Frame-Options:
      - SAMEORIGIN
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: |
      {"cases":[{"condition":"nevermatch \u003e 1000","name":"rule-case","status":"info"}],"enabled":true,"message":"rule message","name":"go-TestSecMonRulesCRUD-local-1595581175-3","options":{"evaluationWindow":300,"keepAlive":300,"maxSignalDuration":300},"queries":[{"distinctFields":[],"groupByFields":[],"name":"nevermatch","query":"thiswillnevernevermatch"}],"tags":["datadog-api-client-test-go"]}
    form: {}
    headers:
      Accept:
      - application/json
      Content-Type:
      - application/json
      Dd-Operation-Id:
      - CreateSecurityMonitoringRule
      User-Agent:
      - datadog-api-client-go/1.0.0-beta.7+dev (go go1.14.1; os darwin; arch amd64)
      X-Datadog-Parent-Id:
      - "3276631464784904754"
      X-Datadog-Sampling-Priority:
      - "1"
      X-Datadog-Trace-Id:
      - "8825420659722329676"
    url: https://api.datadoghq.com/api/v2/security_monitoring/rules
    method: POST
  response:
    body: '{"creationAuthorId":7194,"tags":["datadog-api-client-test-go"],"isEnabled":false,"hasExtendedTitle":false,"message":"rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1595581176689,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"qw8-rph-tqi","isDefault":false,"name":"go-TestSecMonRulesCRUD-local-1595581175-3"}'
    headers:
      Cache-Control:
      - no-cache
      Connection:
      - keep-alive
      Content-Disposition:
      - inline
      Content-Type:
      - application/json;charset=utf-8
      Date:
      - Fri, 24 Jul 2020 08:59:36 GMT
      Pragma:
      - no-cache
      Set-Cookie:
      - AWSALB=7GAYP+iCA82rNm1Qds9Q5uHIZSF9vbkb4DO6wcwZFfooSecMZInvryANTFne+oIePzpGokCSJmNuNUXme8nZNQBS6LURo3j9wHfhSdH050FNKR9yraqonoaP2zb7;
        Expires=Fri, 31 Jul 2020 08:59:36 GMT; Path=/
      - AWSALBCORS=7GAYP+iCA82rNm1Qds9Q5uHIZSF9vbkb4DO6wcwZFfooSecMZInvryANTFne+oIePzpGokCSJmNuNUXme8nZNQBS6LURo3j9wHfhSdH050FNKR9yraqonoaP2zb7;
        Expires=Fri, 31 Jul 2020 08:59:36 GMT; Path=/; SameSite=None; Secure
      - DD-PSHARD=0; Max-Age=604800; Path=/; expires=Fri, 31-Jul-2020 08:59:36 GMT;
        secure; HttpOnly
      Strict-Transport-Security:
      - max-age=15724800;
      Vary:
      - Accept-Encoding
      X-Content-Type-Options:
      - nosniff
      X-Dd-Version:
      - "35.2781816"
      X-Frame-Options:
      - SAMEORIGIN
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: |
      {"cases":[{"condition":"nevermatch \u003e 1000","name":"rule-case","status":"info"}],"enabled":true,"message":"rule message","name":"go-TestSecMonRulesCRUD-local-1595581175-4","options":{"evaluationWindow":300,"keepAlive":300,"maxSignalDuration":300},"queries":[{"distinctFields":[],"groupByFields":[],"name":"nevermatch","query":"thiswillnevernevermatch"}],"tags":["datadog-api-client-test-go"]}
    form: {}
    headers:
      Accept:
      - application/json
      Content-Type:
      - application/json
      Dd-Operation-Id:
      - CreateSecurityMonitoringRule
      User-Agent:
      - datadog-api-client-go/1.0.0-beta.7+dev (go go1.14.1; os darwin; arch amd64)
      X-Datadog-Parent-Id:
      - "5966057275666681995"
      X-Datadog-Sampling-Priority:
      - "1"
      X-Datadog-Trace-Id:
      - "8825420659722329676"
    url: https://api.datadoghq.com/api/v2/security_monitoring/rules
    method: POST
  response:
    body: '{"creationAuthorId":7194,"tags":["datadog-api-client-test-go"],"isEnabled":false,"hasExtendedTitle":false,"message":"rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1595581176878,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"px2-lnb-fwf","isDefault":false,"name":"go-TestSecMonRulesCRUD-local-1595581175-4"}'
    headers:
      Cache-Control:
      - no-cache
      Connection:
      - keep-alive
      Content-Disposition:
      - inline
      Content-Type:
      - application/json;charset=utf-8
      Date:
      - Fri, 24 Jul 2020 08:59:36 GMT
      Pragma:
      - no-cache
      Set-Cookie:
      - AWSALB=MFiOFHI+cb3ByGNsNxDbjxoJ2uNiiMj40Ai34YeTkD48I4wiPh1VunAGUKlCN1bZ3Sw+KvvxtrxYEutH03NjgIhVgMDpNZ83Hg62QWYPyffleEv0n0hjI2fKebte;
        Expires=Fri, 31 Jul 2020 08:59:36 GMT; Path=/
      - AWSALBCORS=MFiOFHI+cb3ByGNsNxDbjxoJ2uNiiMj40Ai34YeTkD48I4wiPh1VunAGUKlCN1bZ3Sw+KvvxtrxYEutH03NjgIhVgMDpNZ83Hg62QWYPyffleEv0n0hjI2fKebte;
        Expires=Fri, 31 Jul 2020 08:59:36 GMT; Path=/; SameSite=None; Secure
      - DD-PSHARD=0; Max-Age=604800; Path=/; expires=Fri, 31-Jul-2020 08:59:36 GMT;
        secure; HttpOnly
      Strict-Transport-Security:
      - max-age=15724800;
      Vary:
      - Accept-Encoding
      X-Content-Type-Options:
      - nosniff
      X-Dd-Version:
      - "35.2781836"
      X-Frame-Options:
      - SAMEORIGIN
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      Accept:
      - application/json
      Dd-Operation-Id:
      - GetSecurityMonitoringRule
      User-Agent:
      - datadog-api-client-go/1.0.0-beta.7+dev (go go1.14.1; os darwin; arch amd64)
      X-Datadog-Parent-Id:
      - "754431352768708752"
      X-Datadog-Sampling-Priority:
      - "1"
      X-Datadog-Trace-Id:
      - "8825420659722329676"
    url: https://api.datadoghq.com/api/v2/security_monitoring/rules/wva-emy-ucy
    method: GET
  response:
    body: '{"creationAuthorId":7194,"tags":["datadog-api-client-test-go"],"isEnabled":false,"hasExtendedTitle":false,"message":"rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1595581176119,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"wva-emy-ucy","isDefault":false,"name":"go-TestSecMonRulesCRUD-local-1595581175-0"}'
    headers:
      Cache-Control:
      - no-cache
      Connection:
      - keep-alive
      Content-Disposition:
      - inline
      Content-Type:
      - application/json;charset=utf-8
      Date:
      - Fri, 24 Jul 2020 08:59:37 GMT
      Pragma:
      - no-cache
      Set-Cookie:
      - AWSALB=9pzubIkUBwbCGA0NaGUbfcMb8eZL0n2ljjQGliRH7uhES3O1OHijkxlwdtCGmq11NSPhuGY2UDNlCAegbaGH6TJK6U7qa2rIuRRTpJgrAqPW360MNz3H3o23rr8W;
        Expires=Fri, 31 Jul 2020 08:59:36 GMT; Path=/
      - AWSALBCORS=9pzubIkUBwbCGA0NaGUbfcMb8eZL0n2ljjQGliRH7uhES3O1OHijkxlwdtCGmq11NSPhuGY2UDNlCAegbaGH6TJK6U7qa2rIuRRTpJgrAqPW360MNz3H3o23rr8W;
        Expires=Fri, 31 Jul 2020 08:59:36 GMT; Path=/; SameSite=None; Secure
      - DD-PSHARD=0; Max-Age=604800; Path=/; expires=Fri, 31-Jul-2020 08:59:37 GMT;
        secure; HttpOnly
      Strict-Transport-Security:
      - max-age=15724800;
      Vary:
      - Accept-Encoding
      X-Content-Type-Options:
      - nosniff
      X-Dd-Version:
      - "35.2781836"
      X-Frame-Options:
      - SAMEORIGIN
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      Accept:
      - application/json
      Dd-Operation-Id:
      - ListSecurityMonitoringRules
      User-Agent:
      - datadog-api-client-go/1.0.0-beta.7+dev (go go1.14.1; os darwin; arch amd64)
      X-Datadog-Parent-Id:
      - "5739410299036228414"
      X-Datadog-Sampling-Priority:
      - "1"
      X-Datadog-Trace-Id:
      - "8825420659722329676"
    url: https://api.datadoghq.com/api/v2/security_monitoring/rules?page%5Bnumber%5D=0&page%5Bsize%5D=1
    method: GET
  response:
    body: '{"meta":{"page":{"total_filtered_count":232,"total_count":232}},"data":[{"creationAuthorId":5410,"tags":[],"isEnabled":false,"hasExtendedTitle":true,"message":"test","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":7,"createdAt":1574203869376,"queries":[{"query":"test","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":["@sllllllllack-security-analytics-alerts-low"],"name":"","condition":"a>1"}],"type":"threshold","id":"59c-44e-2ec","isDefault":true,"name":"test"}]}'
    headers:
      Cache-Control:
      - no-cache
      Connection:
      - keep-alive
      Content-Disposition:
      - inline
      Content-Type:
      - application/json;charset=utf-8
      Date:
      - Fri, 24 Jul 2020 08:59:37 GMT
      Pragma:
      - no-cache
      Set-Cookie:
      - AWSALB=e5Tj1Cpg2F/wA5z5Q+ItMklAw3Arn9J/KDSfPI/L/65wbw3ArrF6ZZx3Ude4Hp5Fdw+hIzcmvXWE3e+rWYncKudMdDncjuad8/LOVZr4djhEbO0qT9k9hPJiMw51;
        Expires=Fri, 31 Jul 2020 08:59:37 GMT; Path=/
      - AWSALBCORS=e5Tj1Cpg2F/wA5z5Q+ItMklAw3Arn9J/KDSfPI/L/65wbw3ArrF6ZZx3Ude4Hp5Fdw+hIzcmvXWE3e+rWYncKudMdDncjuad8/LOVZr4djhEbO0qT9k9hPJiMw51;
        Expires=Fri, 31 Jul 2020 08:59:37 GMT; Path=/; SameSite=None; Secure
      - DD-PSHARD=0; Max-Age=604800; Path=/; expires=Fri, 31-Jul-2020 08:59:37 GMT;
        secure; HttpOnly
      Strict-Transport-Security:
      - max-age=15724800;
      Vary:
      - Accept-Encoding
      X-Content-Type-Options:
      - nosniff
      X-Dd-Version:
      - "35.2781816"
      X-Frame-Options:
      - SAMEORIGIN
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      Accept:
      - application/json
      Dd-Operation-Id:
      - ListSecurityMonitoringRules
      User-Agent:
      - datadog-api-client-go/1.0.0-beta.7+dev (go go1.14.1; os darwin; arch amd64)
      X-Datadog-Parent-Id:
      - "7390713862924249342"
      X-Datadog-Sampling-Priority:
      - "1"
      X-Datadog-Trace-Id:
      - "8825420659722329676"
    url: https://api.datadoghq.com/api/v2/security_monitoring/rules?page%5Bnumber%5D=0&page%5Bsize%5D=232
    method: GET
  response:
    body: '{"meta":{"page":{"total_filtered_count":232,"total_count":232}},"data":[{"creationAuthorId":5410,"tags":[],"isEnabled":false,"hasExtendedTitle":true,"message":"test","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":7,"createdAt":1574203869376,"queries":[{"query":"test","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":["@sllllllllack-security-analytics-alerts-low"],"name":"","condition":"a>1"}],"type":"threshold","id":"59c-44e-2ec","isDefault":true,"name":"test"},{"creationAuthorId":0,"tags":["security:compliance","framework:cis","control:cis-3.5","source:cloudtrail","scope:cloudtrail"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an attacker is trying to evade defenses by disabling or modifying
      CloudTrail.\n\n### Strategy\nThis rule lets you monitor these CloudTrail API
      calls to detect if an attacker is modifying or disabling CloudTrail:\n\n* [DeleteTrail][1]\n*
      [UpdateTrail][2]\n* [StopLogging][3]\n\n### Triage & Response\n1. Determine
      which user in your organization owns the API key that made this API call.\n2.
      Contact the user to see if they intended to make this API call.\n3. If the user
      did not make the API call:\n * Rotate the credentials.\n * Investigate if the
      same credentials made other unauthorized API calls.\n\n[1]: https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_DeleteTrail.html\n[2]:
      https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_UpdateTrail.html\n[3]:
      https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_StopLogging.html","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":701,"createdAt":1585058906229,"queries":[{"query":"source:cloudtrail
      @evt.name:(DeleteTrail OR UpdateTrail OR StopLogging OR CreateTrail OR StartLogging)","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"4c9-ccc-12d","isDefault":true,"name":"AWS
      CloudTrail Configuration Modified"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0007-discovery","technique:T1069-permission-groups-discovery","source:guardduty","scope:iam"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an attacker is enumerating IAM principals.\n\n### Strategy\nThis
      rule lets you leverage GuardDuty to detect when an attacker is enumerating IAM
      principals. The GuardDuty Findings which trigger this signal:\n\n* [Recon:IAMUser/NetworkPermissions][1]\n*
      [Recon:IAMUser/ResourcePermissions][2]\n* [Recon:IAMUser/UserPermissions][3]
      \n\n\n### Triage & Response\n1. Determine which user in your organization owns
      the API key that made this API call.\n2. Contact the user to see if they intended
      to make this API call.\n3. If the user did not make the API call:\n * Rotate
      the credentials.\n * Investigate if the same credentials made other unauthorized
      API calls.\n\n[1]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon7\n[2]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon8\n[3]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon9","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":702,"createdAt":1584994647235,"queries":[{"query":"source:guardduty
      @evt.name:(Recon\\:IAMUser\\/NetworkPermissions OR Recon\\:IAMUser\\/ResourcePermissions
      OR Recon\\:IAMUser\\/UserPermissions)","groupByFields":["@detail.resource.accessKeyDetails.userName"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"bf2-ea6-578","isDefault":true,"name":"AWS IAM
      Principal Enumeration"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0040-impact","technique:T1496-resource-hijacking","source:guardduty","scope:ec2"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an EC2 instance is communicating with a cryptocurrency server\n\n###
      Strategy\nThis rule lets you leverage GuardDuty to detect when an EC2 instance
      has made a DNS request or is communicating with an IP that is associated with
      cryptocurrency operations. The following GuardDuty Findings trigger this signal:\n\n*
      [CryptoCurrency:EC2/BitcoinTool.B!DNS][1]\n* [CryptoCurrency:EC2/BitcoinTool.B][2]\n\n\n###
      Triage & Response\n1. Determine which domain name or IP address triggered the
      signal. This can be found in the samples. \n2. If the domain or IP address should
      not have been requested, open a security investigation, and determine which
      process requested the domain name or IP address.\n\n[1]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_crypto.html#crypto3\n[2]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_crypto.html#crypto4","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":722,"createdAt":1584994648047,"queries":[{"query":"source:guardduty
      @evt.name:(CryptoCurrency\\:EC2\\/BitcoinTool.B\\!DNS OR CryptoCurrency\\:EC2\\/BitcoinTool.B)","groupByFields":["instance-id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"647-57c-610","isDefault":true,"name":"AWS EC2
      Instance Communicating With a Cryptocurrency Server"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0006-credential-access","technique:T1110-brute-force","scope:template"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect Account Take Over (ATO) through brute force attempts\n\n### Strategy\nTo
      determine a successful attempt: Detect a high amount of failed logins and at
      least one successful login for a given user. This will generate a `HIGH` severity
      signal.\nTo determine an attempt: Detect a high amount of failed logins. This
      will generate an `INFO` severity signal.\n\n### Triage & Response\n1. Inspect
      the logs to see if this was a valid login attempt.\n2. See if 2FA was authenticated.\n3.
      If the user was compromised, rotate user credentials.","options":{"evaluationWindow":300,"maxSignalDuration":7200,"keepAlive":3600},"version":722,"createdAt":1585058893314,"queries":[{"query":"@evt.name:authentication
      @evt.outcome:failure @usr.name:*","groupByFields":["@usr.name"],"name":"","distinctFields":[]},{"query":"@evt.name:authentication
      @evt.outcome:success @usr.name:*","groupByFields":["@usr.name"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":["@slack-secops"],"name":"Successful","condition":"a>0"}],"type":"threshold","id":"cb5-a15-e7b","isDefault":true,"name":"TEMPLATE
      - Brute Force Attack Grouped By User"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0005-defense-evasion","technique:T1089-disabling-security-tools","source:cloudtrail","scope:eventbridge"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an attacker is trying to evade defenses by deleting or disabling
      EventBridge rules.\n\n### Strategy\nThis rule lets you monitor these CloudTrail
      API calls to detect if an attacker is modifying or disabling EventBridge rules:\n\n*
      [DeleteRule][1]\n* [DisableRule][2]\n\n### Triage & Response\n1. Determine which
      user in your organization owns the API key that made this API call.\n2. Contact
      the user to see if they intended to make this API call.\n3. If the user did
      not make the API call:\n * Rotate the credentials.\n * Investigate if the same
      credentials made other unauthorized API calls.\n\n[1]: https://docs.aws.amazon.com/eventbridge/latest/APIReference/API_DeleteRule.html\n[2]:
      https://docs.aws.amazon.com/eventbridge/latest/APIReference/API_DisableRule.html","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":722,"createdAt":1585058894158,"queries":[{"query":"source:cloudtrail
      @evt.name:(DeleteRule OR DisableRule)","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"d54-bf1-4c8","isDefault":true,"name":"AWS
      EventBridge Rule Disabled or Deleted"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0005-defense-evasion","technique:T1066-indicator-removal-from-tools","source:cloudtrail","scope:ec2"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an attacker is removing FlowLogs to cover their tracks.\n\n###
      Strategy\nThis rule lets you monitor this CloudTrail API call to detect if an
      attacker is deleting FlowLogs:\n\n* [DeleteFlowLogs][1]\n\n### Triage & Response\n1.
      Determine which user in your organization owns the API key that made this API
      call.\n2. Contact the user to see if they intended to make this API call.\n3.
      If the user did not make the API call:\n * Rotate the credentials.\n * Investigate
      if the same credentials made other unauthorized API calls.\n\n[1]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteFlowLogs.html","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":721,"createdAt":1585058896109,"queries":[{"query":"source:cloudtrail
      @evt.name:DeleteFlowLogs","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"281-b74-2c4","isDefault":true,"name":"AWS
      FlowLogs Removed"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0040-impact","technique:T1485-data-destruction","source:cloudtrail","scope:ecs"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an attacker is destroying an ECS Cluster\n\n### Strategy\nThis
      rule lets you monitor this CloudTrail API call to detect if an ECS cluster is
      deleted:\n\n* [DeleteCluster][1]\n\n### Triage & Response\n1. Determine which
      user in your organization owns the API key that made this API call.\n2. Contact
      the user to see if they intended to make this API call.\n3. If the user did
      not make the API call:\n * Rotate the credentials.\n * Investigate if the same
      credentials made other unauthorized API calls.\n\n[1]: https://docs.aws.amazon.com/AmazonECS/latest/APIReference/API_DeleteCluster.html","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":701,"createdAt":1585058898709,"queries":[{"query":"source:cloudtrail
      @evt.name:DeleteCluster","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"61c-ac3-3fc","isDefault":true,"name":"AWS
      ECS Cluster Deleted"},{"creationAuthorId":0,"tags":["security:compliance","source:cloudtrail","scope:s3"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when the S3 Public Access Block configuration has been removed
      \n\n### Strategy\nThis rule lets you monitor this CloudTrail API call to detect
      if an attacker is deleting the S3 Public Access Block configuration:\n\n* [DeleteAccountPublicAccessBlock][1]\n\n###
      Triage & Response\n1. Determine who the user was who made this API call.\n2.
      Contact the user and inform them of best practices of enabling Public Access
      Block on S3 buckets.\n3. Re-enable Public Access Block on the S3 bucket.\n\nMore
      details on S3 Public Block Public Access can be found [here][2].\n\n[1]: https://docs.aws.amazon.com/cli/latest/reference/s3api/delete-public-access-block.html\n[2]:
      https://docs.aws.amazon.com/AmazonS3/latest/dev/access-control-block-public-access.html","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":701,"createdAt":1585058899365,"queries":[{"query":"source:cloudtrail
      @evt.name:DeleteAccountPublicAccessBlock","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"3ec-7ef-11e","isDefault":true,"name":"AWS
      S3 Public Access Block Removed"},{"creationAuthorId":0,"tags":["security:threat-intel","source:gsuite","scope:gsuite"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a user attempts to log in with a password which is known to
      be compromised.\n\n### Strategy\nThis rule allows you to monitor this Google
      Activity API call to detect if an attacker is trying to login with a leaked
      password: \n\n* [Leaked password][1]\n\n### Triage & Response\n1. Determine
      which user in your organization owns the compromised password.\n2. Contact the
      user and ensure they rotate the password on Google and any other accounts where
      they may have reused this password. Ensure the user is aware of strong password
      guidelines.\n\n[1]: https://developers.google.com/admin-sdk/reports/v1/appendix/activity/login#account_disabled_password_leak","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":700,"createdAt":1585058900004,"queries":[{"query":"source:gsuite
      @event.type:account_warning @event.name:account_disabled_password_leak","groupByFields":["@actor.email"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"6d2-a01-709","isDefault":true,"name":"User
      Attempted Login with Leaked Password"},{"creationAuthorId":0,"tags":["security:compliance","framework:cis","control:cis-3.14","source:cloudtrail","scope:ec2"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an attacker is destroying a VPC.\n\n### Strategy\nThis rule
      lets you monitor this CloudTrail API call to detect if an attacker is deleting
      a VPC:\n\n* [DeleteVpc][1]\n\n### Triage & Response\n1. Determine which user
      in your organization owns the API key that made this API call.\n2. Contact the
      user to see if they intended to make this API call.\n3. If the user did not
      make the API call:\n * Rotate the credentials.\n * Investigate if the same credentials
      made other unauthorized API calls.\n\n[1]: https://docs.aws.amazon.com/cli/latest/reference/ec2/delete-vpc.html","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":701,"createdAt":1585058900634,"queries":[{"query":"source:cloudtrail
      @evt.name:(DeleteVpc OR CreateVpc OR ModifyVpcAttribute OR AcceptVpcPeeringConnection
      OR CreateVpcPeeringConnection OR DeleteVpcPeeringConnection OR RejectVpcPeeringConnection
      OR  AttachClassicLinkVpc OR  DetachClassicLinkVpc OR DisableVpcClassicLink OR
      EnableVpcClassicLink)","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"0e0-332-f42","isDefault":true,"name":"AWS
      VPC Created or Modified"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0007-discovery","technique:T1083-file-and-directory-discovery","source:cloudtrail","scope:s3"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an EC2 instance makes an API call to AWS to list all of the
      S3 Buckets.\n\n### Strategy\nThis rule lets you monitor CloudTrail to detect
      a [ListBuckets][1] API call with the session name prefixed with `i-`. A session
      name prefixed with `i-` typically indicates that it is an EC2 instance using
      an [Instance Profile][2] to communicate with other AWS services, which is a
      common attacker technique to see the full list of S3 buckets in your AWS account.\n
      Determine if the EC2 instance should be making this API call. \n* If not, rotate
      the credentials, verify what else may have been accessed and open an investigation
      into how this instance was compromised.\n   * If the application or legitimate
      user on the EC2 instance is making the `ListBuckets` API call, consider whether
      this API call is really needed.  \n\n[1]: https://docs.aws.amazon.com/AmazonS3/latest/API/API_ListBuckets.html\n[2]:
      https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-roles-for-amazon-ec2.html#ec2-instance-profile","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":702,"createdAt":1585058901276,"queries":[{"query":"source:cloudtrail
      @userIdentity.session_name:i-* @evt.name:ListBuckets","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"8c8-4d8-9d3","isDefault":true,"name":"AWS
      S3 Buckets Enumerated"},{"creationAuthorId":0,"tags":["security:compliance","framework:cis","control:cis-3.3","source:cloudtrail","scope:amazon"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect AWS root user activity. \n\n### Strategy\nMonitor CloudTrail and
      detect when any `@userIdentity.type` has a value of `Root`, but is not invoked
      by an AWS service.\n\n### Triage & Response\n1. Reach out to the user to determine
      if the login was legitimate. \n2. If the login wasn''t legitimate, rotate the
      credentials, enable 2FA, and open an investigation. \n\nFor best practices,
      check out the [AWS Root Account Best Practices][1] documentation.\n\n[1]: https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":707,"createdAt":1585058902527,"queries":[{"query":"source:cloudtrail
      @userIdentity.type:Root  -@userIdentity.invokedBy:*  -@eventType:AwsServiceEvent","groupByFields":["@network.client.ip"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"2f3-4de-467","isDefault":true,"name":"AWS Root
      Account Activity"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0040-impact","technique:T1485-data-destruction","source:cloudtrail","scope:ec2"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an attacker is destroying an EC2 subnet.\n\n### Strategy\nThis
      rule lets you monitor this CloudTrail API call to detect if an attacker is deleting
      an EC2 subnet.\n\n* [DeleteSubnet][1]\n\n### Triage & Response\n1. Determine
      which user in your organization owns the API key that made this API call.\n2.
      Contact the user to see if they intended to make this API call.\n3. If the user
      did not make the API call:\n * Rotate the credentials.\n * Investigate if the
      same credentials made other unauthorized API calls.\n\n[1]: https://docs.aws.amazon.com/cli/latest/reference/ec2/delete-subnet.html","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":699,"createdAt":1585058903161,"queries":[{"query":"source:cloudtrail
      @evt.name:DeleteSubnet","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"bbe-abb-05d","isDefault":true,"name":"AWS
      EC2 Subnet Deleted"},{"creationAuthorId":0,"tags":["security:compliance","framework:cis","control:cis-3.9","source:cloudtrail","scope:amazon-config"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an attacker is trying to evade defenses by disabling an AWS
      configuration.\n\n### Strategy\nThis rule lets you monitor these CloudTrail
      API calls to detect if an attacker is trying to stop recording configurations
      of your AWS resources or trying to delete a delivery channel:\n\n* [StopConfigurationRecorder][1]
      \n* [DeleteDeliveryChannel][2] \n\n### Triage & Response\n1. Determine which
      user in your organization owns the API key that made this API call.\n2. Contact
      the user to see if they intended to make this API call.\n3. If the user did
      not make the API call:\n * Rotate the credentials.\n * Investigate if the same
      credentials made other unauthorized API calls.\n\n[1]: https://docs.aws.amazon.com/config/latest/APIReference/API_StopConfigurationRecorder.html\n[2]:
      https://docs.aws.amazon.com/config/latest/APIReference/API_DeleteDeliveryChannel.html","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":703,"createdAt":1585058903800,"queries":[{"query":"source:cloudtrail
      @evt.name:(StopConfigurationRecorder OR DeleteDeliveryChannel OR PutDeliveryChannel
      OR PutConfigurationRecorder)","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"c5e-474-5c0","isDefault":true,"name":"AWS
      Config Modified"},{"creationAuthorId":0,"tags":["security:threat-intel","scope:template"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a stolen laptop has been connected to the network.\n\n###
      Strategy\nUsing the Datadog [Lookup Processor](https://docs.datadoghq.com/logs/processing/processors/?tab=ui#lookup-processor)
      you can maintain a blocklist of MAC addresses.\nWhen a MAC address connects
      to the network, the @threat.stolen_laptop attribute is set to `true`.\nThis
      threat detection rule queries for `@threat.stolen_laptop:true` and generates
      a security signal. \n\n### Triage & Response\nEnter your triage and response
      process for when a stolen laptop has connected to your network to help users
      responding to the security signal quickly triage and respond to the signal.
      \n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":696,"createdAt":1585058904417,"queries":[{"query":"@threat.stolen_laptop:true
      @network.client.mac:*","groupByFields":["@network.client.mac"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"cb3-fe6-37d","isDefault":true,"name":"TEMPLATE
      - Stolen Laptop Connected to Network"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0006-credential-access","technique:T1110-brute-force"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect an account take over (ATO) through brute force attempts.\n\n###
      Strategy\nTo determine a successful attempt: Detect a high amount of failed
      logins and at least one successful login for a given IP address. This will generate
      a `HIGH` severity signal.\nTo determine an attempt: Detect a high amount of
      failed logins for a given IP address. This will generate an `INFO severity signal.\n\n###
      Triage & Response\n1. Inspect the logs to see if this was a valid login attempt.\n2.
      See if 2FA was authenticated.\n3. If the user was compromised, rotate user credentials.","options":{"evaluationWindow":300,"maxSignalDuration":7200,"keepAlive":3600},"version":695,"createdAt":1585058905610,"queries":[{"query":"@evt.name:authentication
      @evt.outcome:failure","groupByFields":["@usr.name"],"name":"","distinctFields":[]},{"query":"@evt.name:authentication
      @evt.outcome:success","groupByFields":["@usr.name"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":["@slack-secops"],"name":"Successful","condition":"a>5
      && b>0"},{"status":"info","notifications":[],"name":"Attempted","condition":"a>5"}],"type":"threshold","id":"331-2e1-053","isDefault":true,"name":"TEMPLATE
      - Brute Force Attack Grouped By IP"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0006-credential-access","technique:T1110-brute-force","source:guardduty","scope:ec2"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect Brute Force Attacks\n\n### Strategy\nLeverage GuardDuty and detect
      when an attacker is performing a brute force attack. The following are GuardDuty
      findings trigger this signal:\n\n* [UnauthorizedAccess:EC2/SSHBruteForce][1]\n*
      [UnauthorizedAccess:EC2/RDPBruteForce][2]\n\n\n### Triage & Response\n1. Inspect
      the role of the EC2 instance in the attack. Find the role in the signal name
      - either `ACTOR` or `TARGET`.\n   * If you are the `TARGET` and the instance
      is available on the internet, expect to see IPs scanning your systems.\n   *
      If you are the `TARGET` and the instance is **not** available on the internet,
      this means a host on your internal network is scanning your EC2 instance. Open
      an investigation.\n   * If you are the `ACTOR`, this means that your instance
      is performing brute force attacks on other systems. Open an investigation.\n\n[1]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#unauthorized9\n[2]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#unauthorized10","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":699,"createdAt":1585058906864,"queries":[{"query":"source:guardduty
      @evt.name:(UnauthorizedAccess\\:EC2\\/SSHBruteForce OR UnauthorizedAccess\\:EC2\\/RDPBruteForce)
      @detail.service.resourceRole:ACTOR","groupByFields":["instance-id"],"name":"","distinctFields":[]},{"query":"source:guardduty
      @evt.name:(UnauthorizedAccess\\:EC2\\/SSHBruteForce OR UnauthorizedAccess\\:EC2\\/RDPBruteForce)
      @detail.service.resourceRole:TARGET","groupByFields":["instance-id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"ACTOR","condition":"a
      > 0"},{"status":"info","notifications":[],"name":"TARGET","condition":"b > 0"}],"type":"threshold","id":"c30-970-f9c","isDefault":true,"name":"AWS
      EC2 Instance Involved in Brute Force Attack"},{"creationAuthorId":0,"tags":["security:compliance","source:cloudtrail","scope:ec2"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an EBS encryption is disabled by default. \n\n### Strategy\nMonitor
      CloudTrail and detect when EBS encryption is disabled by default via the following
      API call:\n\n* [DisableEbsEncryptionByDefault][1]\n\n### Triage & Response\n1.
      Determine which user in your organization owns the API key that made this API
      call.\n2. Contact the user and let them know that it is best practice to enable
      EBS encryption by default.\n3. Re-enable EBS encryption by default.\n\nFor more
      information about Amazon EBS Encryption, check out the [Amazon EBS Encryption][2]
      documentation.\n\n[1]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DisableEbsEncryptionByDefault.html\n[2]:
      https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":699,"createdAt":1585058907473,"queries":[{"query":"source:cloudtrail
      @evt.name:DisableEbsEncryptionByDefault","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"5ba-d8e-506","isDefault":true,"name":"AWS
      EBS Default Encryption Disabled"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0040-impact","technique:T1485-data-destruction","source:cloudtrail","scope:rds"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an attacker is destroying a RDS Cluster.\n\n### Strategy\nThis
      rule lets you monitor this CloudTrail API call to detect if an attacker is deleting
      a RDS cluster:\n\n* [DeleteDBCluster][1]\n\n### Triage & Response\n1. Determine
      which user in your organization owns the API key that made this API call.\n2.
      Contact the user to see if they intended to make this API call.\n3. If the user
      did not make the API call:\n * Rotate the credentials.\n * Investigate if the
      same credentials made other unauthorized API calls.\n\n[1]: https://docs.aws.amazon.com/cli/latest/reference/rds/delete-db-cluster.html","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":722,"createdAt":1584994648708,"queries":[{"query":"source:cloudtrail
      @evt.name:DeleteDBCluster","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"678-420-51c","isDefault":true,"name":"AWS
      RDS Cluster Deleted"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0005-defense-evasion","technique:T1089-disabling-security-tools"],"isEnabled":false,"hasExtendedTitle":true,"message":"##
      **Goal:**\nDetect when an attacker is trying to evade defenses by disabling
      AWS Config.\\n\\n## **Strategy:**\\nMonitor CloudTrail and detect when AWS config
      is being disabled via the following API calls:\\n* [StopConfigurationRecorder](https://docs.aws.amazon.com/config/latest/APIReference/API_StopConfigurationRecorder.html)
      \\n* [DeleteDeliveryChannel](https://docs.aws.amazon.com/config/latest/APIReference/API_DeleteDeliveryChannel.html)
      \\n\\n## **Triage & Response:**\\n1. Determine who the user was who made this
      API call.\\n2. Contact the user and see if this was an API call which was made
      by the user.\\n3. If the API call was not made by the user:\\n * Rotate the
      user credentials and investigate what other API calls.\\n * Determine what other
      API calls the user made which were not made by the user.","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":4,"createdAt":1579013244994,"queries":[{"query":"source:cloudtrail
      @evt.name:(StopConfigurationRecorder OR DeleteDeliveryChannel)","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"262-72e-7af","isDefault":true,"name":"test
      test test"},{"creationAuthorId":39006,"tags":["security:anomaly","security:data-leak","technique:T1175-component-object-model-and-distributed-com","technique:T1156-.bash_profile-and-.bashrc"],"isEnabled":false,"hasExtendedTitle":false,"message":"Message","options":{"evaluationWindow":300,"maxSignalDuration":86400,"keepAlive":3600},"version":23,"createdAt":1579429670435,"queries":[{"query":"service:mcnulty-web
      login","groupByFields":["@rid"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 10"}],"type":"threshold","id":"356-893-be1","isDefault":false,"name":"Catch
      all"},{"creationAuthorId":39006,"tags":[],"isEnabled":true,"hasExtendedTitle":false,"message":"Message","options":{"evaluationWindow":300,"maxSignalDuration":86400,"keepAlive":3600},"version":24,"createdAt":1579429817386,"queries":[{"query":"service:mcnulty-web","groupByFields":["@rid"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 100"}],"type":"threshold","id":"9ef-5b6-f40","isDefault":false,"name":"Catch
      all 2"},{"creationAuthorId":38857,"tags":["security:attack","tactic:TA0005-defense-evasion","technique:T1089-disabling-security-tools","source:java"],"isEnabled":false,"hasExtendedTitle":true,"message":"##
      **Goal:**\nDetect when an attacker is trying to evade defenses by disabling
      AWS Config.\\n\\n## **Strategy:**\\nMonitor CloudTrail and detect when AWS config
      is being disabled via the following API calls:\\n* [StopConfigurationRecorder](https://docs.aws.amazon.com/config/latest/APIReference/API_StopConfigurationRecorder.html)
      \\n* [DeleteDeliveryChannel](https://docs.aws.amazon.com/config/latest/APIReference/API_DeleteDeliveryChannel.html)
      \\n\\n## **Triage & Response:**\\n1. Determine who the user was who made this
      API call.\\n2. Contact the user and see if this was an API call which was made
      by the user.\\n3. If the API call was not made by the user:\\n * Rotate the
      user credentials and investigate what other API calls.\\n * Determine what other
      API calls the user made which were not made by the user.","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":25,"createdAt":1579644210847,"queries":[{"query":"source:java","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"9ba-6a4-dad","isDefault":true,"name":"test
      default rule"},{"creationAuthorId":5703,"tags":["security:attack","tactic:TA0005-defense-evasion","technique:T1089-disabling-security-tools","source:java"],"isEnabled":false,"hasExtendedTitle":false,"message":"##
      **Goal:**\nDetect when an attacker is trying to evade defenses by disabling
      AWS Config.\\n\\n## **Strategy:**\\nMonitor CloudTrail and detect when AWS config
      is being disabled via the following API calls:\\n* [StopConfigurationRecorder](https://docs.aws.amazon.com/config/latest/APIReference/API_StopConfigurationRecorder.html)
      \\n* [DeleteDeliveryChannel](https://docs.aws.amazon.com/config/latest/APIReference/API_DeleteDeliveryChannel.html)
      \\n\\n## **Triage & Response:**\\n1. Determine who the user was who made this
      API call.\\n2. Contact the user and see if this was an API call which was made
      by the user.\\n3. If the API call was not made by the user:\\n * Rotate the
      user credentials and investigate what other API calls.\\n * Determine what other
      API calls the user made which were not made by the user.","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":5,"createdAt":1579818241872,"queries":[{"query":"source:cloudtrail
      @evt.name:(StopConfigurationRecorder OR DeleteDeliveryChannel)","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"dd1-fcb-3de","isDefault":false,"name":"rule
      name here - just edited this"},{"creationAuthorId":38857,"tags":["service:amazon-ecs-agent","source:cloudtrail"],"isEnabled":false,"hasExtendedTitle":false,"message":"##
      **Goal:**\nDetect when an attacker is trying to evade defenses by disabling
      AWS Config.\\n\\n## **Strategy:**\\nMonitor CloudTrail and detect when AWS config
      is being disabled via the following API calls:\\n* [StopConfigurationRecorder](https://docs.aws.amazon.com/config/latest/APIReference/API_StopConfigurationRecorder.html)
      \\n* [DeleteDeliveryChannel](https://docs.aws.amazon.com/config/latest/APIReference/API_DeleteDeliveryChannel.html)
      \\n\\n## **Triage & Response:**\\n1. Determine who the user was who made this
      API call.\\n2. Contact the user and see if this was an API call which was made
      by the user.\\n3. If the API call was not made by the user:\\n * Rotate the
      user credentials and investigate what other API calls.\\n * Determine what other
      API calls the user made which were not made by the user.","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":19,"createdAt":1579879419915,"queries":[{"query":"source:java","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      my case","condition":"a > 0"}],"type":"threshold","id":"5ee-f2d-9e3","isDefault":false,"name":"test
      integration image"},{"creationAuthorId":5703,"tags":["security:attack","tactic:TA0005-defense-evasion","source:java","technique:user-random-technique-id"],"isEnabled":false,"hasExtendedTitle":false,"message":"##
      **Goal:**\nDetect when an attacker is trying to evade defenses by disabling
      AWS Config.\\n\\n## **Strategy:**\\nMonitor CloudTrail and detect when AWS config
      is being disabled via the following API calls:\\n* [StopConfigurationRecorder](https://docs.aws.amazon.com/config/latest/APIReference/API_StopConfigurationRecorder.html)
      \\n* [DeleteDeliveryChannel](https://docs.aws.amazon.com/config/latest/APIReference/API_DeleteDeliveryChannel.html)
      \\n\\n## **Triage & Response:**\\n1. Determine who the user was who made this
      API call.\\n2. Contact the user and see if this was an API call which was made
      by the user.\\n3. If the API call was not made by the user:\\n * Rotate the
      user credentials and investigate what other API calls.\\n * Determine what other
      API calls the user made which were not made by the user.","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":4,"createdAt":1579899394766,"queries":[{"query":"source:java","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      my case","condition":"a > 0"}],"type":"threshold","id":"402-d1a-3c7","isDefault":false,"name":"test
      default rule bis 2"},{"creationAuthorId":38857,"tags":["security:attack","tactic:TA0005-defense-evasion","technique:T1089-disabling-security-tools","source:foobar"],"isEnabled":false,"hasExtendedTitle":false,"message":"Just
      a testing rule","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":6,"createdAt":1580206979133,"queries":[{"query":"source:java","groupByFields":["service"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"High
      10","condition":"a > 9"},{"status":"medium","notifications":[],"name":"Medium
      7","condition":"a > 6"},{"status":"low","notifications":[],"name":"Low 4","condition":"a
      > 3"},{"status":"info","notifications":[],"name":"Info 1","condition":"a > 0"}],"type":"threshold","id":"457-adf-fc1","isDefault":false,"name":"Fhou
      Rule Java"},{"creationAuthorId":5774,"tags":["rwerewr:d/q"],"isEnabled":false,"hasExtendedTitle":false,"message":"##
      Rule message\n\nA test with a [link](https://app.datadoghq.com/)!","options":{"evaluationWindow":300,"maxSignalDuration":600,"keepAlive":60},"version":18,"createdAt":1580485133416,"queries":[{"query":"source:java
      @level:ERROR","groupByFields":["kube_deployment"],"name":"errors_per_kube_deployment","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":[],"name":"Errors
      per kube deployment","condition":"errors_per_kube_deployment > 0"}],"type":"threshold","id":"208-095-106","isDefault":false,"name":"Tanguy
      Testing rule"},{"creationAuthorId":38857,"tags":["security:attack","tactic:TA0040-impact","technique:T1485-data-destruction"],"isEnabled":false,"hasExtendedTitle":false,"message":"##
      **Goal:**\nDetect when an attacker is destroying a VPC\n\n## **Strategy:**\nMonitor
      CloudTrail and detect when a VPC is deleted via the following API call:\n* [DeleteVpc](https://docs.aws.amazon.com/cli/latest/reference/ec2/delete-vpc.html)\n\n##
      **Triage & Response:**\n1. Determine who the user was who made this API call.\n2.
      Contact the user and see if this was an API call which was made by the user.\n3.
      If the API call was not made by the user:\n   * Rotate the user credentials
      and investigate what other API calls.\n   * Determine what other API calls the
      user made which were not made by the user.","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":14,"createdAt":1580981006763,"queries":[{"query":"source:cloudtrail
      @evt.name:DeleteVpc","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"3a2-141-312","isDefault":false,"name":"AWS
      VPC Deleted"},{"creationAuthorId":5678,"tags":[],"isEnabled":false,"hasExtendedTitle":false,"message":"test
      for grouping by service","options":{"evaluationWindow":900,"maxSignalDuration":3600,"keepAlive":600},"version":9,"createdAt":1582151350460,"queries":[{"query":"host:i-0c773f1dd11189e4f","groupByFields":["service"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"low","notifications":[],"name":"more
      than 10","condition":"a > 10"},{"status":"info","notifications":[],"name":"more
      than 5","condition":"a > 5"}],"type":"threshold","id":"6d8-94a-1ca","isDefault":false,"name":"Test
      group by service"},{"creationAuthorId":39006,"tags":[],"isEnabled":false,"hasExtendedTitle":false,"message":"Just
      a test","options":{"evaluationWindow":300,"maxSignalDuration":86400,"keepAlive":3600},"version":10,"createdAt":1583418327315,"queries":[{"query":"service:kafka-toolbox","groupByFields":["kafka_broker_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 3"}],"type":"threshold","id":"9c5-825-560","isDefault":false,"name":"Kafka
      toolbox"},{"creationAuthorId":40247,"tags":[],"isEnabled":false,"hasExtendedTitle":false,"message":"test","options":{"evaluationWindow":60,"maxSignalDuration":600,"keepAlive":600},"version":33,"createdAt":1583509617349,"queries":[{"query":"status:error","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"critical","notifications":["test"],"name":"","condition":"a
      > 100"}],"type":"threshold","id":"0ce-15c-c28","isDefault":false,"name":"test
      moez"},{"creationAuthorId":5410,"tags":["rwerewr:d/q","source:aws-ec2"],"isEnabled":false,"hasExtendedTitle":false,"message":"##
      Rule message\n\nA test with a [link](https://app.datadoghq.com/)!","options":{"evaluationWindow":300,"maxSignalDuration":600,"keepAlive":600},"version":10,"createdAt":1583771275211,"queries":[{"query":"source:java
      @level:ERROR status:blah","groupByFields":["host","pod_name"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"Errors
      per kube deployment","condition":"a > 0"}],"type":"threshold","id":"dba-512-f97","isDefault":false,"name":"Justins
      Testing rule"},{"creationAuthorId":0,"tags":["source:signal_sciences","scope:signal_sciences"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an IP is flagged by Signal Sciences.\n\n### Strategy\nThis
      rule lets you monitor Signal Sciences events submitted through the Signal Sciences
      [integration][1] to detect when an IP is flagged. \n\n### Triage & Response\n1.
      Determine whether the attack is a false positive.\n2. Determine whether the
      attack was successful.\n3. If the attack exploited a vulnerability in the application,
      triage the vulnerability.\n\n[1]: https://app.datadoghq.com/account/settings#integrations/sigsci","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":721,"createdAt":1584464116420,"queries":[{"query":"source:signal_sciences
      @title:*flag","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"low","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"05a-034-83b","isDefault":true,"name":"Signal
      Sciences Flagged an IP"},{"creationAuthorId":0,"tags":["security:compliance","framework:cis","control:cis-3.2","source:cloudtrail","scope:aws"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when any user logs in to your AWS console without multi-factor
      authentication.\n\n### Strategy\nThis rule monitors CloudTrail and detects when
      any `@evt.name` has a value of  `Console Login`, and `@additionalEventData.MFAUsed`
      has a value of `no`. \n\n**Note:** This rule ignores logins using SAML because
      2FA is implemented on the IdP and not through AWS.\n\n### Triage & Response\n1.
      Reach out to the user to determine if the login was legitimate. \n2. If the
      login was legitimate, request that the user enables 2FA. \n3. If the login wasn''t
      legitimate, rotate the credentials. \n4. Review all user accounts to ensure
      MFA is enabled. \n\n**Note:** There is a separate rule to detect [Root Login
      without MFA][1]. \n\n[1]: /security_monitoring/default_rules/cloudtrail-aws-root-login-without-mfa/","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":726,"createdAt":1585058895478,"queries":[{"query":"source:cloudtrail
      @evt.name:ConsoleLogin @additionalEventData.MFAUsed:No @responseElements.ConsoleLogin:Success
      -@userIdentity.type:Root -@additionalEventData.SamlProviderArn:*","groupByFields":["@userIdentity.accountId","@usr.name"],"name":"user_login_without_mfa","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"low","notifications":[],"name":"","condition":"user_login_without_mfa
      > 0"}],"type":"threshold","id":"b5f-53d-ea1","isDefault":true,"name":"AWS Console
      Login Without MFA"},{"creationAuthorId":0,"tags":["source:twistlock"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect vulnerabilities in container images.\n\n### Strategy\nThis rule
      lets you monitor Twistlock logs to detect `Critical` severity vulnerabilities
      in a container image. \n\n### Triage & Response\n1. Determine the impact of
      this vulnerability.\n2. Update the container image in the registry with a patched
      version of the software.\n3. Deploy the new image to all containers running
      the vulnerable image.","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":699,"createdAt":1585058896752,"queries":[{"query":"source:twistlock
      @vulnerability.log_type:vulnerability @vulnerability.severity:critical","groupByFields":["@vulnerability.cve","@vulnerability.package.name","@vulnerability.image_name"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"14a-4d9-c05","isDefault":true,"name":"Container
      Image Vulnerability Detected"},{"creationAuthorId":0,"tags":["security:compliance","framework:cis","control:cis-3.2","source:cloudtrail","scope:amazon"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a root user logs into the AWS console without multi-factor
      authentication.\n\n### Strategy\nMonitor CloudTrail and detect when any `@evt.name`
      has a value of `Console Login`, `@userIdentity.type` has a value of `Root`,
      and `@additionalEventData.MFAUsed` has a value of `no`. \n\n**Note:** This rule
      ignores logins using SAML because 2FA is implemented on the IdP and not through
      AWS.\n\n### Triage & Response\n1. Reach out to the user to determine if the
      login was legitimate. \n2. If the login was legitimate, request that the user
      enables 2FA on the root account. \n3. If the login wasn''t legitimate, rotate
      the credentials. \n4. Review all root user accounts to ensure MFA is enabled.
      \n\n**Note:** There is a separate rule to detect [Login without MFA for non-root
      users][1]. \n\n[1]: /security_monitoring/default_rules/cloudtrail-aws-login-without-mfa/","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":708,"createdAt":1585058897422,"queries":[{"query":"source:cloudtrail
      @evt.name:ConsoleLogin @additionalEventData.MFAUsed:No @responseElements.ConsoleLogin:Success
      @userIdentity.type:Root -@additionalEventData.SamlProviderArn:*","groupByFields":["@userIdentity.accountId"],"name":"root_login_without_mfa","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"","condition":"root_login_without_mfa
      > 0"}],"type":"threshold","id":"3e0-650-0ab","isDefault":true,"name":"AWS Console
      Root Login Without MFA"},{"creationAuthorId":0,"tags":["source:twistlock"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a container is not running within compliance standards.\n\n###
      Strategy\nThis rule lets you monitor Twistlock logs to detect when `Critical`
      severity compliance issues are discovered in a running container. \n\n### Triage
      & Response\n1. Determine the impact of the compliance finding.\n2. Remediate
      the compliance finding.","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":699,"createdAt":1585058901906,"queries":[{"query":"source:twistlock
      @vulnerability.log_type:compliance @vulnerability.severity:critical","groupByFields":["@vulnerability.compliance_id","@vulnerability.container_name"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"1ae-a90-5f3","isDefault":true,"name":"Container
      Violated Compliance Standards"},{"creationAuthorId":38857,"tags":["security:compliance","control:blabla","framework:dsadsad"],"isEnabled":false,"hasExtendedTitle":false,"message":"##
      **Goal:**\nDetect when EBS encryption is disabled by default \n\n## **Strategy:**\nMonitor
      CloudTrail and detect when EBS encryption is disabled by default via the following
      API call:\n* [DisableEbsEncryptionByDefault](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DisableEbsEncryptionByDefault.html)\n\n##
      **Triage & Response:**\n1. Determine who the user was who made this API call.\n2.
      Contact the user and inform them of best practices to enable EBS encryption
      by default.\n3. Re-enable EBS encryption by default.\n\nMore details on Amazon
      EBS Encryption can be found [here](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html).","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":1,"createdAt":1584546360747,"queries":[{"query":"source:cloudtrail
      @evt.name:DisableEbsEncryptionByDefault","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"c4d-64e-0a5","isDefault":false,"name":"AWS
      EBS Default Encryption Disabled test"},{"creationAuthorId":5774,"tags":[],"isEnabled":true,"hasExtendedTitle":false,"message":"Message","options":{"evaluationWindow":300,"maxSignalDuration":86400,"keepAlive":3600},"version":3,"createdAt":1584908108047,"queries":[{"query":"service:mcnulty-web","groupByFields":["@rid"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 100"}],"type":"threshold","id":"8fd-deb-ac7","isDefault":false,"name":"Catch
      all 3"},{"creationAuthorId":5774,"tags":[],"isEnabled":true,"hasExtendedTitle":false,"message":"Message","options":{"evaluationWindow":300,"maxSignalDuration":86400,"keepAlive":3600},"version":3,"createdAt":1584908122124,"queries":[{"query":"service:mcnulty-web","groupByFields":["@rid"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 100"}],"type":"threshold","id":"a9b-897-bfb","isDefault":false,"name":"Catch
      all 4"},{"creationAuthorId":5774,"tags":[],"isEnabled":false,"hasExtendedTitle":false,"message":"Test
      notifs TLB","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":2,"createdAt":1584914206125,"queries":[{"query":"service:system-probe","groupByFields":["pod_name"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@slack-Datadog-k9-notify"],"name":"Case
      1","condition":"a > 0"}],"type":"threshold","id":"2da-796-9a5","isDefault":false,"name":"Test
      notifs TLB"},{"creationAuthorId":5410,"tags":[],"isEnabled":true,"hasExtendedTitle":false,"message":"rolling
      up over 0","options":{"evaluationWindow":0,"maxSignalDuration":0,"keepAlive":0},"version":12,"createdAt":1585151787425,"queries":[{"query":"@test_rule:true","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":["@slack-datadog-k9-notify"],"name":"test","condition":"a
      > 0"}],"type":"threshold","id":"212-021-5ba","isDefault":false,"name":"testing
      roll up 0"},{"creationAuthorId":5774,"tags":["source:test1","service:test2","scope:test3"],"isEnabled":true,"hasExtendedTitle":false,"message":"Message","options":{"evaluationWindow":60,"maxSignalDuration":60,"keepAlive":60},"version":8,"createdAt":1585172190810,"queries":[{"query":"service:mcnulty-web","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":[],"name":"Case
      1","condition":"a > 100"},{"status":"low","notifications":[],"name":"Case 2","condition":"a
      > 10"},{"status":"info","notifications":[],"name":"Case 3","condition":"a >
      1"}],"type":"threshold","id":"007-d1a-1f3","isDefault":false,"name":"Catch all
      5"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0005-defense-evasion","technique:T1089-disabling-security-tools","source:cloudtrail","scope:guardduty"],"isEnabled":false,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an attacker is trying to evade defenses by deleting a GuardDuty
      detector.\n\n### Strategy\nThis rule lets you monitor this CloudTrail API call
      to detect if an attacker is deleting a GuardDuty Detector:\n\n* [DeleteDetector][1]\n\n###
      Triage & Response\n1. Determine which user in your organization owns the API
      key that made this API call.\n2. Contact the user to see if they intended to
      make this API call.\n3. If the user did not make the API call:\n * Rotate the
      credentials.\n * Investigate if the same credentials made other unauthorized
      API calls.\n\n[1]: https://docs.aws.amazon.com/guardduty/latest/ug/delete-detector.html","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":699,"createdAt":1585219239135,"queries":[{"query":"source:cloudtrail
      @evt.name:DeleteDetector","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"e1a-547-397","isDefault":true,"name":"AWS
      GuardDuty Detector Deleted"},{"creationAuthorId":39529,"tags":["security:compliance","framework:cis_aws","control:cis_aws-04","rule:cis_aws-4.1","service:ec2","aws","source:inventories","level:1"],"isEnabled":true,"hasExtendedTitle":false,"message":"Description:\nSecurity
      groups provide stateful filtering of ingress/egress network traffic to AWS resources.
      It is recommended that no security group allows unrestricted ingress access
      to port 22 .\n\nRationale:\nRemoving unfettered connectivity to remote console
      services, such as SSH, reduces a server''s exposure to risk.\n\nRemediation:\nPerform
      the following to implement the prescribed state:\n1. Login to the AWS Management
      Console at\nhttps://console.aws.amazon.com/vpc/home\n2. In the left pane, click
      Security Groups\n3. For each security group, perform the following:\n4. Select
      the security group\n5. Click the Inbound Rules tab\n6. Identify the rules to
      be removed\n7. Click the x in the Remove column\n8. Click Save\n\nCIS Controls:\n9.2
      Ensure Only Approved Ports, Protocols and Services Are Running\nEnsure that
      only network ports, protocols, and services listening on a system with validated
      business needs, are running on each system.","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":900},"version":25,"createdAt":1585747351594,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule @resource_direction:ingress @resource_to_port:(22
      OR ALL)","groupByFields":["@resource_group_id"],"name":"","distinctFields":[]},{"query":"source:inventories
      resource_type:aws_security_group_rule @resource_direction:ingress -@resource_to_port:(22
      OR ALL)","groupByFields":["@resource_group_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"Fail","condition":"a>0"},{"status":"info","notifications":[],"name":"Pass","condition":"b>0"}],"type":"threshold","id":"796-a4d-6a2","isDefault":false,"name":"[CIS
      AWS] 4.1 Ensure no security groups allow ingress from 0.0.0.0/0 to port 22"},{"creationAuthorId":39529,"tags":["security:compliance","framework:cis_aws","control:cis_aws-04","rule:cis_aws-4.2","aws","service:ec2","source:inventories","level:1"],"isEnabled":true,"hasExtendedTitle":false,"message":"Description:\nSecurity
      groups provide stateful filtering of ingress/egress network traffic to AWS resources.
      It is recommended that no security group allows unrestricted ingress access
      to port 3389.\n\nRationale:\nRemoving unfettered connectivity to remote console
      services, such as RDP, reduces a server''s exposure to risk.\n\nRemediation:\nPerform
      the following to implement the prescribed state:\n1. Login to the AWS Management
      Console at\nhttps://console.aws.amazon.com/vpc/home\n2. In the left pane, click
      Security Groups\n3. For each security group, perform the following:\n4. Select
      the security group\n5. Click the Inbound Rules tab\n6. Identify the rules to
      be removed\n7. Click the x in the Remove column\n8. Click Save\n\nCIS Controls:\n9.2
      Ensure Only Approved Ports, Protocols and Services Are Running\nEnsure that
      only network ports, protocols, and services listening on a system with validated
      business needs, are running on each system.\n\n\n","options":{"evaluationWindow":300,"maxSignalDuration":1800,"keepAlive":300},"version":12,"createdAt":1585748314560,"queries":[{"query":"@source:inventories    @resource_type:aws_security_group_rule   @resource_direction:ingress   @resource_to_port:(3389
      OR ALL)","groupByFields":["@resource_group_id"],"name":"","distinctFields":[]},{"query":"@source:inventories    @resource_type:aws_security_group_rule   @resource_direction:ingress    -@resource_to_port:(3389
      OR ALL)","groupByFields":["@resource_group_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"Fail","condition":"a>0"},{"status":"info","notifications":[],"name":"Pass","condition":"b>0"}],"type":"threshold","id":"24c-655-d6b","isDefault":false,"name":"[CIS
      AWS] 4.2 Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389"},{"creationAuthorId":40247,"tags":[],"isEnabled":true,"hasExtendedTitle":false,"message":"My
      message hello ! Hellooooooooo! hey!k","options":{"evaluationWindow":60,"maxSignalDuration":60,"keepAlive":60},"version":24,"createdAt":1585906171378,"queries":[{"query":"service:k9_test_service","groupByFields":[],"name":"","distinctFields":[]},{"query":"source:k9_test_source","groupByFields":[],"name":"","distinctFields":[]},{"query":"source:k9_test_source","groupByFields":[],"name":"","distinctFields":[]},{"query":"source:k9_test_source","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"critical","notifications":[],"name":"","condition":"a
      > 1 && b > 1 && c > 1 && d > 1"}],"type":"threshold","id":"a6c-015-fa3","isDefault":false,"name":"LA
      RULE de test2"},{"creationAuthorId":40247,"tags":[],"isEnabled":false,"hasExtendedTitle":false,"message":"test
      message  test te","options":{"evaluationWindow":60,"maxSignalDuration":60,"keepAlive":60},"version":5,"createdAt":1585908773821,"queries":[{"query":"service:k9_test_service","groupByFields":[],"name":"","distinctFields":[]},{"query":"source:k9_test_source","groupByFields":[],"name":"","distinctFields":[]},{"query":"host:moez_laptop","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"critical","notifications":["@slack-k9-testing-channel"],"name":"","condition":"a
      > 1 && b > 1 && c > 1"}],"type":"threshold","id":"73d-bd4-9fc","isDefault":false,"name":"UPDATED
      RULE"},{"creationAuthorId":39529,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws","control:pci_aws-01","subcontrol:pci_aws-1.1.4a"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for inbound rules that allow unrestricted access (i.e.
      0.0.0.0/0 or ::/0) to TCP port 22. Restrict access to only those IP addresses
      that require it, in order to implement the principle of least privilege and
      reduce the possibility of a breach. TCP port 22 is used for secure remote login
      by connecting an SSH client application with an SSH server: https://en.wikipedia.org/wiki/Secure_Shell\n\nThis
      rule can help you with the following compliance standards:\nThe Center of Internet
      Security AWS Foundations Benchmark\nPayment Card Industry Data Security Standard
      (PCI DSS)","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":3,"createdAt":1585937401747,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:22","groupByFields":["@resource_id"],"name":"","distinctFields":[]},{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:ALL","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@michael.yamnitsky@datadoghq.com"],"name":"Fail","condition":"a>0  ||
      b>0"}],"type":"threshold","id":"e0f-930-857","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Inbound SSH Access"},{"creationAuthorId":39529,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws","control:pci_aws-01","subcontrol:pci_aws-1.1.4a"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for outbound rules that allow unrestricted access (i.e.
      0.0.0.0/0 or ::/0) to TCP port 22. Restrict access to only those IP addresses
      that require it, in order to implement the principle of least privilege and
      reduce the possibility of a breach. TCP port 22 is used for secure remote login
      by connecting an SSH client application with an SSH server: https://en.wikipedia.org/wiki/Secure_Shell\n\nThis
      rule can help you with the following compliance standards:\nThe Center of Internet
      Security AWS Foundations Benchmark\nPayment Card Industry Data Security Standard
      (PCI DSS)","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":3,"createdAt":1585937474879,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:egress resource_to_port:22","groupByFields":["@resource_id"],"name":"","distinctFields":[]},{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:egress resource_to_port:ALL","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@michael.yamnitsky@datadoghq.com"],"name":"Fail","condition":"a>0  ||
      b>0"}],"type":"threshold","id":"31e-8cd-14b","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Outbound SSH Access"},{"creationAuthorId":39529,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws","control:pci_aws-01","subcontrol:pci_aws-1.1.4a"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for inbound rules that allow unrestricted access (i.e.
      0.0.0.0/0) to TCP port 80 and restrict access to only those IP addresses that
      require it in order to implement the principle of least privilege and reduce
      the possibility of a breach. TCP port 80 is used by the HTTP\n\nThis rule can
      help you with the following compliance standards:\nPayment Card Industry Data
      Security Standard (PCI DSS)\nAPRA\nMAS\nNational Institute of Standards and
      Technology (NIST)","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":3,"createdAt":1585937775851,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:80","groupByFields":["@resource_id"],"name":"","distinctFields":[]},{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:ALL","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@michael.yamnitsky@datadoghq.com"],"name":"Fail","condition":"a>0  ||
      b>0"}],"type":"threshold","id":"1af-90e-566","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Inbound HTTP Access"},{"creationAuthorId":39529,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws","control:pci_aws-01","subcontrol:pci_aws-1.1.4a"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for outbound rules that allow unrestricted access (i.e.
      0.0.0.0/0) to TCP port 80 and restrict access to only those IP addresses that
      require it in order to implement the principle of least privilege and reduce
      the possibility of a breach. TCP port 80 is used by the HTTP\n\nThis rule can
      help you with the following compliance standards:\nPayment Card Industry Data
      Security Standard (PCI DSS)\nAPRA\nMAS\nNational Institute of Standards and
      Technology (NIST)","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":4,"createdAt":1585937868730,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:egress resource_to_port:80
      (ip_range:\"0.0.0.0/0\" OR ip_range:\"::/0\")","groupByFields":["@resource_id"],"name":"","distinctFields":[]},{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:egress resource_to_port:ALL","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@michael.yamnitsky@datadoghq.com"],"name":"Fail","condition":"a>0  ||
      b>0"}],"type":"threshold","id":"e80-eb1-d5e","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Outbound HTTP Access"},{"creationAuthorId":39529,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for inbound rules that allow unrestricted access (i.e.
      0.0.0.0/0 or ::/0) to TCP port 445 and restrict access to only those IP addresses
      that require it in order to implement the principle of least privilege and reduce
      the possibility of a breach. Common Internet File System (CIFS) port 445 is
      used by client/server applications to provide shared access to files, printers
      and communications between network nodes directly over TCP (without NetBIOS)
      in Microsoft Windows Server 2003 and later. CIFS is based on the enhanced version
      of Server Message Block (SMB) protocol for internet/intranet file sharing, developed
      by Microsoft: https://goo.gl/VJyR8O.\n\nThis rule can help you with the following
      compliance standards:\nPayment Card Industry Data Security Standard (PCI DSS)\nAPRA\nMAS\nNational
      Institute of Standards and Technology (NIST)\n\nThis rule can help you work
      with the AWS Well-Architected Framework\n\nRemediation:\n1. First, run revoke-security-group-ingress
      command (OSX/Linux/UNIX) to remove the inbound rule(s) that allow unrestricted
      access through TCP port 445, from the selected EC2 security group (the command
      does not return an output):\n\naws ec2 revoke-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MSActiveDirectorySecurityGroup\n\t--protocol tcp\n\t--port
      445\n\t--cidr 0.0.0.0/0\n\n2. Run authorize-security-group-ingress command (OSX/Linux/UNIX)
      to add the inbound rules removed at the previous step with a different set of
      parameters in order to restrict CIFS access to specific entities. To add custom
      inbound/ingress rules to the selected security group, use one of the following
      options (the command does not produce an output):\n\n>> Add an inbound rule
      that allows CIFS access to the specific static IP/Elastic IP address of the
      permitted host via port 445:\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MSActiveDirectorySecurityGroup\n\t--protocol tcp\n\t--port
      445\n\t--cidr 54.164.53.250/32\n\n>> Add an inbound rule that allows CIFS access
      to the IP address range of the permitted hosts via port 445:\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MSActiveDirectorySecurityGroup\n\t--protocol tcp\n\t--port
      445\n\t--cidr 54.164.53.250/24\n\n>> Add an inbound rule that allows CIFS access
      to another EC2 security group in the same AWS region via port 445:\naws ec2
      authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name MSActiveDirectorySecurityGroup\n\t--protocol
      tcp\n\t--port 445\n\t--source-group MyMSAppSecurityGroup\n\n3. Repeat step no.
      1 and 2 to update other EC2 security groups that allow unrestricted CIFS access
      using AWS CLI.\n\n4. Repeat steps no. 1 - 3 to implement the entire process
      for other AWS regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":3,"createdAt":1585938251759,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:445","groupByFields":["@resource_id"],"name":"","distinctFields":[]},{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:ALL","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@michael.yamnitsky@datadoghq.com"],"name":"Fail","condition":"a>0  ||
      b>0"}],"type":"threshold","id":"e73-24e-375","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Inbound CIFS Access"},{"creationAuthorId":39529,"tags":["security:compliance","aws","source:inventories","framework:pci_aws","service:s3"],"isEnabled":true,"hasExtendedTitle":false,"message":"Ensure
      that default encryption is enabled at the bucket level to automatically encrypt
      all objects when stored in Amazon S3. The S3 objects are encrypted during the
      upload process using Server-Side Encryption with either AWS S3-managed keys
      (SSE-S3) or AWS KMS-managed keys (SSE-KMS).\n\nThis rule can help you with the
      following compliance standards:\nPayment Card Industry Data Security Standard
      (PCI DSS)\nHealth Insurance Portability and Accountability Act (HIPAA)\nGeneral
      Data Protection Regulation (GDPR)\nAPRA\nMAS\nNational Institute of Standards
      and Technology (NIST)\nThis rule can help you work with the AWS Well-Architected
      Framework","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":4,"createdAt":1585938635153,"queries":[{"query":"source:inventories
      resource_type:aws_s3 resource_is_public:true","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@michael.yamnitsky@datadoghq.com"],"name":"Fail","condition":"a>0"}],"type":"threshold","id":"1e8-24d-447","isDefault":false,"name":"[PCI
      AWS] S3 Bucket With Default Encryption Turned On"},{"creationAuthorId":5774,"tags":[],"isEnabled":true,"hasExtendedTitle":false,"message":"Test
      *","options":{"evaluationWindow":900,"maxSignalDuration":3600,"keepAlive":3600},"version":1,"createdAt":1586120963343,"queries":[{"query":"*","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 1000000000"}],"type":"threshold","id":"567-969-1a9","isDefault":false,"name":"TLB
      - Test *"},{"creationAuthorId":0,"tags":["security:compliance","framework:cis","control:cis-3.7","source:cloudtrail","scope:kms"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a CMK is deleted or scheduled for deletion.\n\n### Strategy\nThis
      rule lets you monitor these CloudTrail API calls to detect if an attacker is
      deleting CMKs:\n* [DisableKey][1]\n* [ScheduleKeyDeletion][2]\n\n### Triage
      & Response\n1. Determine which user in your organization owns the API key that
      made this API call.\n2. Contact the user to see if they intended to make this
      API call.\n3. If the user did not make the API call:\n * Rotate the credentials.\n
      * Investigate if the same credentials made other unauthorized API calls.\n\n[1]:
      https://docs.aws.amazon.com/kms/latest/APIReference/API_DisableKey.html\n[2]:
      https://docs.aws.amazon.com/kms/latest/APIReference/API_ScheduleKeyDeletion.html
      ","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":726,"createdAt":1586196604008,"queries":[{"query":"source:cloudtrail
      @evt.name:(DisableKey OR ScheduleKeyDeletion)","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"6e0-b59-56c","isDefault":true,"name":"AWS
      CMK Deleted or Scheduled for Deletion"},{"creationAuthorId":0,"tags":["security:compliance","framework:cis","control:cis-3.8","source:cloudtrail","scope:s3"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a S3 Bucket policy is modified.\n\n### Strategy\nMonitor CloudTrail
      and detect when S3 policies are being modified via one of the following API
      calls:\n* [PutBucketAcl][1]\n* [PutBucketPolicy][2]\n* [PutBucketCors][3]\n*
      [PutBucketLifecycle][4]\n* [PutBucketReplication][5]\n* [DeleteBucketPolicy][6]\n*
      [DeleteBucketCors][7]\n* [DeleteBucketLifecycle][8]\n* [DeleteBucketReplication][9]\n\n###
      Triage & Response\n1. Determine who the user was who made this API call.\n2.
      Contact the user and see if this was an API call which was made by the user.\n3.
      If the API call was not made by the user:\n   * Rotate the user credentials
      and investigate what other API calls.\n   * Determine what other API calls the
      user made which were not made by the user.\n\n[1]: https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketAcl.html\n
      [2]: https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketPolicy.html\n
      [3]: https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketCors.html\n
      [4]: https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketLifecycle.html\n
      [5]: https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketReplication.html\n
      [6]: https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteBucketPolicy.html\n
      [7]:  https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteBucketCors.html\n
      [8]: https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteBucketLifecycle.html\n
      [9]: https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteBucketReplication.html","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":697,"createdAt":1586196606187,"queries":[{"query":"source:cloudtrail
      @evt.name:(PutBucketAcl OR PutBucketPolicy OR PutBucketCors OR PutBucketLifecycle
      OR PutBucketReplication OR DeleteBucketPolicy OR DeleteBucketCors OR DeleteBucketLifecycle
      OR DeleteBucketReplication)","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"878-b3d-99d","isDefault":true,"name":"AWS
      S3 Bucket Policy Modified"},{"creationAuthorId":0,"tags":["security:compliance","framework:cis","control:cis-3.11","source:cloudtrail","scope:ec2"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an AWS Network Access Control List (NACL) has been created
      or modified.\n\n### Strategy\nThis rule lets you monitor CloudTrail and detect
      when an AWS NACL has been created or modified with one of the following API
      calls:\n* [CreateNetworkAcl][1] \n* [CreateNetworkAclEntry][2] \n* [DeleteNetworkAcl][3]
      \n* [DeleteNetworkAclEntry][4] \n* [ReplaceNetworkAclEntry][5] \n* [ReplaceNetworkAclAssociation][6]\n\n###
      Triage & Response\n1. Determine who the user was who made this API call.\n2.
      Contact the user and see if this was an API call which was made by the user.\n3.
      If the API call was not made by the user:\n   * Rotate the user credentials
      and investigate what other API calls.\n   * Determine what other API calls the
      user made which were not made by the user.\n\n[1]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateNetworkAcl.html\n[2]:
      https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateNetworkAclEntry.html\n[3]:
      https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteNetworkAcl.html\n[4]:
      https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteNetworkAclEntry.html\n[5]:
      https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_ReplaceNetworkAclEntry.html\n[6]:
      https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_ReplaceNetworkAclAssociation.html","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":697,"createdAt":1586196606343,"queries":[{"query":"source:cloudtrail
      @evt.name:(CreateNetworkAcl OR CreateNetworkAclEntry OR DeleteNetworkAcl OR
      DeleteNetworkAclEntry OR ReplaceNetworkAclEntry OR ReplaceNetworkAclAssociation)","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"b93-e43-4f6","isDefault":true,"name":"AWS
      Network Access Control List Created or Modified"},{"creationAuthorId":0,"tags":["security:compliance","framework:cis","control:cis-3.12","source:cloudtrail","scope:ec2"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an AWS Network Gateway has been created or modified.\n\n###
      Strategy\nMonitor CloudTrail and detect when an AWS Network Gateway has been
      created or modified with one of the following API calls:\n* [CreateCustomerGateway][1]
      \n* [DeleteCustomerGateway][2] \n* [AttachInternetGateway][3] \n* [CreateInternetGateway][4]\n*
      [DeleteInternetGateway][5] \n* [DetachInternetGateway][6]\n\n### Triage & Response\n1.
      Determine who the user was who made this API call.\n2. Contact the user and
      see if this was an API call which was made by the user.\n3. If the API call
      was not made by the user:\n   * Rotate the user credentials and investigate
      what other API calls.\n   * Determine what other API calls the user made which
      were not made by the user.\n\n[1]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateCustomerGateway
      \n [2]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteCustomerGateway
      \n [3]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_AttachInternetGateway
      \n [4]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateInternetGateway
      \n [5]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteInternetGateway
      \n [6]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DetachInternetGateway.html","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":697,"createdAt":1586196607314,"queries":[{"query":"source:cloudtrail
      @evt.name:(CreateCustomerGateway OR DeleteCustomerGateway OR AttachInternetGateway
      OR CreateInternetGateway OR DeleteInternetGateway OR DetachInternetGateway)","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"aa7-cbb-9d0","isDefault":true,"name":"AWS
      Network Gateway Created or Modified"},{"creationAuthorId":0,"tags":["security:compliance","framework:cis","control:cis-3.6","source:cloudtrail","scope:iam"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a user is a victim of an Account Take Over (ATO) by a brute
      force attack.\n\n### Strategy\n This rule monitors CloudTrail and detects when
      any `@evt.name` has a value of `Console Login`, and `@error.message:` has a
      value of `Failed authentication`. \n\n### Triage & Response\n1. Determine if
      the user logged in with 2FA.\n2. Reach out to the user and ensure the login
      was legitimate.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":703,"createdAt":1586196607801,"queries":[{"query":"source:cloudtrail
      @evt.name:ConsoleLogin @error.message:\"Failed authentication\"","groupByFields":["@userIdentity.accountId","@usr.name"],"name":"failed_login","distinctFields":[]},{"query":"source:cloudtrail
      @evt.name:ConsoleLogin -@error.message:* @additionalEventData.MFAUsed:No","groupByFields":["@userIdentity.accountId","@usr.name"],"name":"successful_login_without_mfa","distinctFields":[]},{"query":"source:cloudtrail
      @evt.name:ConsoleLogin -@error.message:* @additionalEventData.MFAUsed:Yes","groupByFields":["@userIdentity.accountId","@usr.name"],"name":"successful_login_with_mfa","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"Potentially
      Successful - NO MFA","condition":"failed_login > 5 && successful_login_without_mfa
      > 0"},{"status":"info","notifications":[],"name":"Potentially Successful - MFA
      Used","condition":"failed_login > 5 && successful_login_with_mfa > 0"},{"status":"info","notifications":[],"name":"Unsuccessful","condition":"failed_login
      > 5"}],"type":"threshold","id":"65e-e8e-499","isDefault":true,"name":"AWS Console
      Brute Force Login"},{"creationAuthorId":0,"tags":["security:compliance","framework:cis","control:cis-3.13","source:cloudtrail","scope:ec2"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an AWS Route Table has been created or modified.\n\n### Strategy\nThis
      rule lets you monitor CloudTrail and detect when an AWS Route Table has been
      created or modified with one of the following API calls:\n* [CreateRoute][1]
      \n* [CreateRouteTable][2] \n* [ReplaceRoute][3] \n* [ReplaceRouteTableAssociation][4]
      \n* [DeleteRouteTable][5] \n* [DeleteRoute][6] \n* [DisassociateRouteTable][7]\n\n###
      Triage & Response\n1. Determine who the user was who made this API call.\n2.
      Contact the user and see if this was an API call which was made by the user.\n3.
      If the API call was not made by the user:\n   * Rotate the user credentials
      and investigate what other API calls.\n   * Determine what other API calls the
      user made which were not made by the user.\n\n[1]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateRoute.html
      \n [2]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateRouteTable
      \n [3]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_ReplaceRoute.html
      \n [4]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_ReplaceRouteTableAssociation
      \n [5]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteRouteTable.html
      \n [6]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteRoute.html
      \n [7]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DisassociateRouteTable.html","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":801,"createdAt":1586196608167,"queries":[{"query":"source:cloudtrail
      @evt.name:(CreateRoute OR CreateRouteTable OR ReplaceRoute OR ReplaceRouteTableAssociation
      OR DeleteRouteTable OR DeleteRoute OR DisassociateRouteTable)","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":["slack"],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"eb8-3be-97c","isDefault":true,"name":"AWS
      Route Table Created or Modified"},{"creationAuthorId":0,"tags":["security:compliance","framework:cis","control:cis-3.1","source:cloudtrail","scope:amazon"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when unauthorized activity is detected in AWS.\n\n### Strategy\nThis
      rule lets you monitor CloudTrail to detect when the error message of `AccessDenied`
      is returned.\n\n### Triage & Response\n1. Determine which user in your organization
      owns the API key that made this API call.\n2. Contact the user to see if they
      intended to make this API call.\n3. If the user did not make the API call:\n
      * Rotate the credentials.\n * Investigate if the same credentials made other
      unauthorized API calls.\n","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":745,"createdAt":1586196608310,"queries":[{"query":"source:cloudtrail
      @error.message:AccessDenied","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":["slack","slack2"],"name":"greater
      than 1000 failed attempts","condition":"a > 1000"},{"status":"medium","notifications":[],"name":"greater
      than 100 failed attempts","condition":"a > 100"},{"status":"low","notifications":["slack2"],"name":"greater
      than 10 failed attempts","condition":"a > 10"}],"type":"threshold","id":"4ee-43a-9e9","isDefault":true,"name":"AWS
      Unauthorized Activity"},{"creationAuthorId":0,"tags":["security:compliance","framework:cis","control:cis-3.10","source:cloudtrail","scope:ec2"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an AWS security group has been modified.\n\n### Strategy\nMonitor
      CloudTrail and detect when an AWS security group has been created or modified
      with one of the following API calls:\n* [AuthorizeSecurityGroupIngress][1] \n*
      [AuthorizeSecurityGroupEgress][2] \n* [RevokeSecurityGroupIngress][3] \n* [RevokeSecurityGroupEgress][4]
      \n* [CreateSecurityGroup][5] \n* [DeleteSecurityGroup][6]\n\n### Triage & Response\n1.
      Determine who the user was who made this API call.\n2. Contact the user and
      see if this was an API call which was made by the user.\n3. If the API call
      was not made by the user:\n   * Rotate the user credentials and investigate
      what other API calls.\n   * Determine what other API calls the user made which
      were not made by the user.\n\n[1]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_AuthorizeSecurityGroupIngress.html
      \n [2]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_AuthorizeSecurityGroupEgress.html
      \n [3]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_RevokeSecurityGroupIngress.html
      \n [4]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_RevokeSecurityGroupEgress.html
      \n [5]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateSecurityGroup.html
      \n [6]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteSecurityGroup.html","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":693,"createdAt":1586196608633,"queries":[{"query":"source:cloudtrail
      @evt.name:(AuthorizeSecurityGroupIngress OR AuthorizeSecurityGroupEgress OR
      RevokeSecurityGroupIngress OR RevokeSecurityGroupEgress OR CreateSecurityGroup
      OR DeleteSecurityGroup)","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"e86-8c1-209","isDefault":true,"name":"AWS
      Security Group Created or Modified"},{"creationAuthorId":0,"tags":["security:compliance","framework:cis","control:cis-3.4","source:cloudtrail","scope:iam"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect a change to an AWS IAM Policy.\n\n### Strategy\nThis rule lets
      you monitor CloudTrail and detect when any event pertaining to an AWS IAM policy
      is detected with one of the following API calls:\n* [DeleteGroupPolicy][1]\n*
      [DeleteRolePolicy](https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeleteRolePolicy.html)\n*
      [DeleteUserPolicy][2]\n* [PutGroupPolicy][3]\n* [PutRolePolicy]\n* [PutUserPolicy][5]\n*
      [CreatePolicy]\n* [DeletePolicy][7]\n* [CreatePolicyVersion][8]\n* [DeletePolicyVersion][9]\n*
      [AttachRolePolicy][10]\n* [DetachRolePolicy][11]\n* [AttachUserPolicy][12]\n*
      [DetachUserPolicy][13]\n* [AttachGroupPolicy][14]\n* [DetachGroupPolicy][15]\n\n###
      Triage & Response\n1. Review the IAM Policy change and ensure it does not negatively
      impact your risk in relation to authentication or authorization controls.\n\n[1]:
      https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeleteGroupPolicy.html\n[2]:
      https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeleteUserPolicy.html\n[3]:
      https://docs.aws.amazon.com/IAM/latest/APIReference/API_PutGroupPolicy.html\n[4]:
      https://docs.aws.amazon.com/IAM/latest/APIReference/API_PutRolePolicy.html\n[5]:
      https://docs.aws.amazon.com/IAM/latest/APIReference/API_PutUserPolicy.html\n[6]:
      https://docs.aws.amazon.com/IAM/latest/APIReference/API_CreatePolicy.html\n[7]:
      https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeletePolicy.html\n[8]:
      https://docs.aws.amazon.com/IAM/latest/APIReference/API_CreatePolicyVersion.html\n[9]:
      https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeletePolicyVersion.html\n[10]:
      https://docs.aws.amazon.com/IAM/latest/APIReference/API_AttachRolePolicy.html\n[11]:
      https://docs.aws.amazon.com/IAM/latest/APIReference/API_DetachRolePolicy.html\n[12]:
      https://docs.aws.amazon.com/IAM/latest/APIReference/API_AttachUserPolicy.html\n[13]:
      https://docs.aws.amazon.com/IAM/latest/APIReference/API_DetachUserPolicy.html\n[14]:
      https://docs.aws.amazon.com/IAM/latest/APIReference/API_AttachGroupPolicy.html\n[15]:
      https://docs.aws.amazon.com/IAM/latest/APIReference/API_DetachGroupPolicy.html","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":702,"createdAt":1586196608971,"queries":[{"query":"source:cloudtrail
      @evt.name:(DeleteGroupPolicy OR DeleteRolePolicy OR DeleteUserPolicy OR PutGroupPolicy
      OR PutRolePolicy OR PutUserPolicy OR CreatePolicy OR DeletePolicy OR CreatePolicyVersion
      OR DeletePolicyVersion OR AttachRolePolicy OR DetachRolePolicy OR AttachUserPolicy
      OR DetachUserPolicy OR AttachGroupPolicy OR DetachGroupPolicy)","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"608-41c-e59","isDefault":true,"name":"AWS IAM
      Policy Changed"},{"creationAuthorId":0,"tags":["source:gcp","scope:gcp.project","security:compliance"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a change to a GCP logging sink has been made. This could stop
      audit logs from being sent to Datadog.\n\n### Strategy\nMonitor GCP admin activity
      audit logs to determine when any of the following methods are invoked:\n\n*
      `google.logging.v2.ConfigServiceV2.UpdateSink`\n* `google.logging.v2.ConfigServiceV2.DeleteSink`\n\n###
      Triage & Response\n1. Review the sink and ensure the sink is properly configured.","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":717,"createdAt":1586205178345,"queries":[{"query":"source:gcp.project
      @evt.name:(google.logging.v2.ConfigServiceV2.UpdateSink OR google.logging.v2.ConfigServiceV2.DeleteSink)","groupByFields":["@usr.id","@data.protoPayload.resourceName"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"18e-0cd-59f","isDefault":true,"name":"GCP
      Logging Sink Modified"},{"creationAuthorId":0,"tags":["source:gcp","scope:gcp.gce.route","security:compliance"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a VPC network is created. \n\n### Strategy\nThis rule lets
      you monitor GCP GCE activity audit logs to determine when the following method
      is invoked to create a new VPC network:\n\n* `beta.compute.networks.insert`\n\n###
      Triage & Response\n1. Review the VPC network.","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":716,"createdAt":1586205179774,"queries":[{"query":"source:gcp.gce.route
      @evt.name:beta.compute.networks.insert","groupByFields":["project_id","@data.protoPayload.resourceName","@usr.id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"058-635-5a3","isDefault":true,"name":"GCP
      GCE VPC Network Modified"},{"creationAuthorId":0,"tags":["source:gcp","scope:gcp.service.account","security:compliance"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a new service account key is created.  An attacker could use
      this key as a backdoor to your account. \n\n### Strategy\nThis rule lets you
      monitor GCP admin activity audit logs to detect the creation of a service account
      key. \n\n### Triage & Response\n1. Contact the user who created the service
      account key to ensure they''re managing the key securely.","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":715,"createdAt":1586205180248,"queries":[{"query":"source:gcp.service.account
      @evt.name:google.iam.admin.v1.CreateServiceAccountKey","groupByFields":["@usr.id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"02f-c6a-0a5","isDefault":true,"name":"GCP
      Service Account Key Created"},{"creationAuthorId":0,"tags":["source:gcp","scope:gcp.gcs.bucket","security:compliance"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when permissions have changed on a GCS Bucket.\n\n### Strategy\nMonitor
      GCS bucket admin activity audit logs to determine the following method is invoked:\n\n*
      `storage.setIamPermissions`\n\n### Triage & Response\n1. Review the bucket permissions
      and ensure they are not overly permissive.","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":695,"createdAt":1586205181966,"queries":[{"query":"source:gcp.gcs.bucket
      @evt.name:storage.setIamPermissions","groupByFields":["project_id","bucket_name","@usr.id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"5f5-aa6-00e","isDefault":true,"name":"GCP
      Bucket Permissions Modified"},{"creationAuthorId":0,"tags":["source:gcp","scope:gcp.gce.firewall.rule","security:compliance"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a firewall rule is created, modified or deleted. \n\n### Strategy\nMonitor
      GCP GCE activity audit logs to determine when any of the following methods are
      invoked:\n\n* `v1.compute.firewalls.delete`\n* `v1.compute.firewalls.insert`\n*
      `v1.compute.firewalls.patch` \n\n### Triage & Response\n1. Review the log and
      role and ensure the permissions are scoped properly.\n2. Review the users associated
      with the role and ensure they should have the permissions attached to the role.","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":695,"createdAt":1586205182471,"queries":[{"query":"source:gcp.gce.firewall.rule
      @evt.name:(v1.compute.firewalls.delete OR v1.compute.firewalls.insert OR v1.compute.firewalls.patch)","groupByFields":["project_id","@data.protoPayload.resourceOriginalState.name","@usr.id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"909-b56-e6a","isDefault":true,"name":"GCP
      GCE Firewall Rule Modified"},{"creationAuthorId":0,"tags":["source:gcp","scope:gcp.project","security:compliance"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect a change to the IAM policy. \n\n### Strategy\nThis rule lets you
      monitor GCP admin activity audit logs to determine when the `SetIamPolicy` method
      is invoked. \n\n### Triage & Response\n1. Review the log and inspect the policy
      deltas (`@data.protoPayload.serviceData.policyDelta.bindingDeltas`) and ensure
      none of the actions are `REMOVE`.","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":695,"createdAt":1586205182963,"queries":[{"query":"source:gcp.project
      @evt.name:SetIamPolicy","groupByFields":["@usr.id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"569-043-83b","isDefault":true,"name":"GCP
      IAM Policy Modified"},{"creationAuthorId":0,"tags":["source:gcp","scope:gcp.service.account","security:compliance"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a new service account is created.\n\n### Strategy\nThis rule
      lets you monitor GCP admin activity audit logs to determine when a service account
      is created. \n\n### Triage & Response\n1. Contact the user who created the service
      account and ensure that the account is needed and that the role is scoped properly.","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":693,"createdAt":1586205184542,"queries":[{"query":"source:gcp.service.account
      @evt.name:google.iam.admin.v1.CreateServiceAccount","groupByFields":["@usr.id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"010-56b-b59","isDefault":true,"name":"GCP
      Service Account Created"},{"creationAuthorId":0,"tags":["source:gcp","scope:gcp.iam.role","security:compliance"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a custom role is created or modified. \n\n### Strategy\nMonitor
      GCP IAM activity audit logs to determine when any of the following methods are
      invoked:\n\n* `google.iam.admin.v1.CreateRole`\n* `google.iam.admin.v1.UpdateRole`
      \n\n### Triage & Response\n1. Review the log and role and ensure the permissions
      are scoped properly.\n2. Review the users associated with the role and ensure
      they should have the permissions attached to the role.","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":692,"createdAt":1586205185432,"queries":[{"query":"source:gcp.iam.role
      @evt.name:(google.iam.admin.v1.CreateRole OR google.iam.admin.v1.UpdateRole)","groupByFields":["@usr.id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"3e3-3ea-9b9","isDefault":true,"name":"GCP
      IAM Custom Role Created or Modified"},{"creationAuthorId":0,"tags":["source:gcp","scope:gcp.cloudsql.database","security:compliance"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a Cloud SQL DB has been modified.\n\n### Strategy\nThis rule
      lets you monitor GCP Cloud SQL admin activity audit logs to determine when one
      of the following methods are invoked:\n\n* `cloudsql.instances.create`\n* `cloudsql.instances.create`\n*
      `cloudsql.users.update`\n\n### Triage & Response\n1. Review the Cloud SQL DB
      and ensure it is configured properly with the correct permissions.","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":691,"createdAt":1586205185720,"queries":[{"query":"source:gcp.cloudsql.database
      @evt.name:(cloudsql.instances.create OR cloudsql.instances.create OR cloudsql.users.create
      OR cloudsql.users.update)","groupByFields":["project_id","database_id","@usr.id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"1b4-3c0-786","isDefault":true,"name":"GCP
      Cloud SQL Database Modified"},{"creationAuthorId":0,"tags":["source:gcp","scope:gcp.gce.route","security:compliance"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a firewall rule is created or modified. \n\n### Strategy\nThis
      rule lets you monitor GCP GCE activity audit logs to determine if a firewall
      is being adjusted by showing you when any of the following methods are invoked:\n\n*
      `beta.compute.routes.insert`\n* `beta.compute.routes.patch`\n\n### Triage &
      Response\n1. Veirify that the GCP route is configured properly and that the
      user intended to modify the firewall.","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":692,"createdAt":1586205185981,"queries":[{"query":"source:gcp.gce.route
      @evt.name(beta.compute.routes.insert OR beta.compute.routes.patch)","groupByFields":["project_id","@data.protoPayload.resourceName","@usr.id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":["@slack-datadog-k9-notify"],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"310-f5e-48c","isDefault":true,"name":"GCP
      GCE Network Route Created or Modified"},{"creationAuthorId":0,"tags":["source:gcp","security:compliance"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when there is unauthorized activity by a service account in GCP\n\n###
      Strategy\nMonitor GCP logs and detect when the error message of `PERMISSION_DENIED`
      is returned for a service account.\n\n### Triage & Response\n1. Determine the
      service account that made the unauthorized calls.\n2. Investigate if there is
      a misconfiguration in IAM permissions or if an attacker compromised the service
      account","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":717,"createdAt":1586205297459,"queries":[{"query":"source:gcp.*
      @evt.outcome:PERMISSION_DENIED @usr.id:(*gserviceaccount.com OR *google.com)","groupByFields":["@usr.id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"greater
      than 1000 failed attempts","condition":"a > 1000"},{"status":"medium","notifications":[],"name":"greater
      than 100 failed attempts","condition":"a > 100"},{"status":"low","notifications":[],"name":"greater
      than 10 failed attempts","condition":"a > 10"}],"type":"threshold","id":"1ef-c8d-29a","isDefault":true,"name":"GCP
      Unauthorized Service Account Activity"},{"creationAuthorId":0,"tags":["source:gcp","security:compliance"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when unauthorized activity by a user is detected in GCP\n\n###
      Strategy\nMonitor GCP logs and detect when the error message of `PERMISSION_DENIED`
      is returned for a user account.\n\n### Triage & Response\n1. Determine the user
      who made the unauthorized calls.\n2. Determine if there is a misconfiguration
      in IAM permissions or whether an attacker has compromised the user account.","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":719,"createdAt":1586205298392,"queries":[{"query":"source:gcp.*
      @evt.outcome:PERMISSION_DENIED -@usr.id:(*gserviceaccount.com OR *google.com)","groupByFields":["@usr.id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"greater
      than 1000 failed attempts","condition":"a > 1000"},{"status":"medium","notifications":[],"name":"greater
      than 100 failed attempts","condition":"a > 100"},{"status":"low","notifications":[],"name":"greater
      than 10 failed attempts","condition":"a > 10"}],"type":"threshold","id":"042-e2a-f47","isDefault":true,"name":"GCP
      Unauthorized User Activity"},{"creationAuthorId":0,"tags":["source:gcp","scope:gcp.gcs.bucket","security:attack","tactic:TA0007-discovery","technique:T1083-file-and-directory-discovery"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a service account lists out GCS Buckets.\n\n### Strategy\nThis
      rule lets you monitor GCS bucket admin activity audit logs to determine when
      a service account invokes the following method:\n\n* `storage.buckets.list`\n\n###
      Triage & Response\n1. Determine whether this service account should be making
      list bucket calls.\n * If the account was compromised, secure the account and
      investigate how it was compromised and if the account made other unauthorized
      calls.\n * If the owner of the service account intended to make the `ListBuckets`
      API call, consider whether this API call is needed. It could cause a security
      issue for the application to know the name of the bucket it needs to access.
      If it''s not needed, modify this rule''s filter to stop generating signals for
      this specific service account.","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":695,"createdAt":1586205301197,"queries":[{"query":"source:gcp.gcs.bucket
      @evt.name:storage.buckets.list @usr.id:*gserviceaccount.com","groupByFields":["project_id","bucket_name","@usr.id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"low","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"9c8-204-86e","isDefault":true,"name":"GCP
      Bucket Enumerated"},{"creationAuthorId":0,"tags":["source:gcp","scope:gcp.gcs.bucket","security:compliance"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an administrative change to a GCS Bucket has been made. This
      could change the retention policy or bucket lock. For more information, see
      the [GCS Bucket Lock docs][1].\n\n### Strategy\nThis rule lets you monitor GCS
      bucket admin activity audit logs to determine if a bucket has been updated with
      the following method:\n\n* `storage.buckets.update`\n\n### Triage & Response\n1.
      Review the bucket to ensure that it is properly configured.\n\n[1]: https://cloud.google.com/storage/docs/bucket-lock","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":691,"createdAt":1586205336776,"queries":[{"query":"source:gcp.gcs.bucket
      @evt.name:storage.buckets.update","groupByFields":["project_id","bucket_name","@usr.id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"488-fb9-e6b","isDefault":true,"name":"GCP
      Bucket Modified"},{"creationAuthorId":0,"tags":["source:gcp","scope:gcp.pubsub.topic","security:compliance"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a GCP Pub/Sub Subscribtion has been deleted. This could stop
      audit logs from being sent to Datadog.\n\n### Strategy\nMonitor GCP admin activity
      audit logs to determine when the following method is invoked:\n\n* `google.pubsub.v1.Publisher.DeleteTopic`\n\n###
      Triage & Response\n1. Review the subscribtion and ensure it is properly configured.","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":695,"createdAt":1586207537027,"queries":[{"query":"source:gcp.pubsub.topic
      @evt.name:google.pubsub.v1.Publisher.DeleteTopic","groupByFields":["@usr.id","@data.protoPayload.resourceName"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"fb1-ea6-c9b","isDefault":true,"name":"GCP
      Pub/Sub Topic Deleted"},{"creationAuthorId":0,"tags":["source:gcp","scope:gcp.pubsub.subscription","security:compliance"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a change to a GCP Pub/Sub Subscribtion has been made. This
      could stop audit logs from being sent to Datadog.\n\n### Strategy\nMonitor GCP
      admin activity audit logs to determine when any of the following methods are
      invoked:\n\n* `google.pubsub.v1.Subscriber.UpdateSubscription`\n* `google.pubsub.v1.Subscriber.DeleteSubscription`\n\n###
      Triage & Response\n1. Review the subscribtion and ensure it is properly configured.","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":695,"createdAt":1586207539465,"queries":[{"query":"source:gcp.pubsub.subscription
      @evt.name:(google.pubsub.v1.Subscriber.UpdateSubscription OR google.pubsub.v1.Subscriber.DeleteSubscription)","groupByFields":["@usr.id","@data.protoPayload.resourceName"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"352-0fb-a81","isDefault":true,"name":"GCP
      Pub/Sub Subscriber Modified"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0007-discovery","technique:T1046-network-service-scanning","source:guardduty","scope:ec2"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an EC2 instance is conducting a port scan.\n\n### Strategy\nThis
      rule lets you monitor this [GuardDuty integration][1] finding:\n\n* [Recon:EC2/Portscan][2]\n\n\n###
      Triage & Response\n1. Determine why traffic from the EC2 instance appears to
      be conducting a port scan.\n2. If the instance is compromised:\n   * Review
      the AWS [documentation][3] on remediating a compromised EC2 instance.\n \n[1]:
      https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon5\n[3]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-ec2\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":722,"createdAt":1587524594934,"queries":[{"query":"source:guardduty
      @evt.name:(Recon\\:EC2\\/Portscan)","groupByFields":["instance-id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"487-e83-6ad","isDefault":true,"name":"AWS EC2
      Instance Conducting a Port Scan"},{"creationAuthorId":0,"tags":["security:compliance","source:guardduty","scope:iam"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an AWS IAM user disables [S3 Block Public Access][1]\n\n###
      Strategy\nThis rule lets you monitor this [GuardDuty integration][2] finding:\n\n*
      [Policy:IAMUser/S3BlockPublicAccessDisabled][3]\n\n\n### Triage & Response\n1.
      Determine which user triggered the signal. This can be found in the signal.\n2.
      Contact the user and determine why the user disabled the S3 Block Access feature.   \n3.
      Re-enable S3 Block Public Access.\n\n[1]: https://docs.aws.amazon.com/AmazonS3/latest/dev/access-control-block-public-access.html\n[2]:
      https://docs.datadoghq.com/integrations/amazon_guardduty/\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_policy.html#policy2\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":716,"createdAt":1587524595668,"queries":[{"query":"source:guardduty
      @evt.name:(Policy\\:IAMUser\\/S3BlockPublicAccessDisabled)","groupByFields":["@detail.resource.accessKeyDetails.userName"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"low","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"ed9-73b-f79","isDefault":true,"name":"AWS IAM
      User Disabled S3 Block Public Access"},{"creationAuthorId":0,"tags":["security:threat-intel","source:guardduty","scope:iam"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an AWS IAM user makes API requests from a malicious IP.\n\n###
      Strategy\nThis rule lets you monitor these [GuardDuty integration][1] findings:\n\n*
      [Recon:IAMUser/TorIPCaller][2]\n* [Recon:IAMUser/MaliciousIPCaller.Custom][3]\n*
      [Recon:IAMUser/MaliciousIPCaller][4]\n* [UnauthorizedAccess:IAMUser/MaliciousIPCaller][5]\n\n\n###
      Triage & Response\n1. Determine which user triggered the signal. This can be
      found in the signal.\n2. Determine if the user''s credentials are compromised.  \n3.
      If the user''s credentials are compromised:\n  * Review the AWS [documentation][6]
      on remediating compromised AWS credentials.\n\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon1\n[3]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon2\n[4]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon3\n[5]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#unauthorized5\n[6]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-creds\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":715,"createdAt":1587524597386,"queries":[{"query":"source:guardduty
      @evt.name:(Recon\\:IAMUser\\/TorIPCaller OR Recon\\:IAMUser\\/MaliciousIPCaller.Custom
      OR Recon\\:IAMUser\\/MaliciousIPCaller OR UnauthorizedAccess\\:IAMUser\\/MaliciousIPCaller)","groupByFields":["@detail.resource.accessKeyDetails.userName"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"b0e-d31-05d","isDefault":true,"name":"AWS IAM
      User Requests from Malicious IP"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0007-discovery","technique:T1046-network-service-scanning","source:guardduty","scope:ec2"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an EC2 instance is being probed by a scanner.\n\n### Strategy\nThis
      rule lets you monitor these [GuardDuty integration][1] findings:\n\n* [Recon:EC2/PortProbeUnprotectedPort][2]\n*
      [Recon:EC2/PortProbeEMRUnprotectedPort][3]\n\n\n### Triage & Response\n1. This
      is typically an informative signal. However, if this instance should not be
      publicly available, you should review the security group for this instance.
      \n\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon6\n[3]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#PortProbeEMRUnprotectedPort\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":714,"createdAt":1587524598073,"queries":[{"query":"source:guardduty
      @evt.name:(Recon\\:EC2\\/PortProbeUnprotectedPort OR Recon\\:EC2\\/PortProbeEMRUnprotectedPort)","groupByFields":["instance-id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"bdb-300-f68","isDefault":true,"name":"AWS EC2
      Instance Probed by Scanner"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0011-command-and-control","technique:T1188-multi-hop-proxy","source:guardduty","scope:ec2"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an EC2 instance makes an outbound network connection from
      TOR.\n\n### Strategy\nThis rule lets you monitor this [GuardDuty integration][1]
      finding:\n\n* [UnauthorizedAccess:EC2/TorClient][2]\n\n\n### Triage & Response\n1.
      Determine if the EC2 instance should be making requests to TOR. \n2. If the
      instance is compromised:\n   * Review the AWS [documentation][3] on remediating
      a compromised EC2 instance. \n\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#unauthorized13\n[3]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-ec2\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":695,"createdAt":1587524598542,"queries":[{"query":"source:guardduty
      @evt.name:(UnauthorizedAccess\\:EC2\\/TorClient)","groupByFields":["instance-id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"31a-6cc-8ef","isDefault":true,"name":"AWS EC2
      Instance Outbound Connections to TOR"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0040-impact","technique:T1496-resource-hijacking","source:guardduty","scope:iam"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an AWS IAM user is launching compute resources and has no
      prior history of invoking this API.\n\n### Strategy\nThis rule lets you monitor
      this [GuardDuty integration][1] finding:\n\n* [ResourceConsumption:IAMUser/ComputeResources][2]\n\n\n###
      Triage & Response\n1. Determine which user triggered the signal. This can be
      found in the signal.\n2. Determine if the user''s credentials are compromised.  \n3.
      If the user''s credentials are compromised:\n  * Review the AWS [documentation][3]
      on remediating compromised AWS credentials.\n\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_resource.html#resourceconsumption\n[3]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-creds\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":694,"createdAt":1587524599205,"queries":[{"query":"source:guardduty
      @evt.name:(ResourceConsumption\\:IAMUser\\/ComputeResources)","groupByFields":["@detail.resource.accessKeyDetails.userName"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"5c5-4a8-c26","isDefault":true,"name":"AWS IAM
      User Anomalous Resource Consumption"},{"creationAuthorId":0,"tags":["security:threat-intel","source:guardduty","scope:ec2"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an EC2 instance receives an inbound network connection from
      TOR.\n\n### Strategy\nThis rule lets you monitor this [GuardDuty integration][1]
      finding:\n\n* [UnauthorizedAccess:EC2/TorIPCaller][2]\n\n\n### Triage & Response\n1.
      This is typically an informative signal. However, if this instance should not
      be publicly available, you should review the security group for this instance.
      \n\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#unauthorized7\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":696,"createdAt":1587524599442,"queries":[{"query":"source:guardduty
      @evt.name:(UnauthorizedAccess\\:EC2\\/TorIPCaller)","groupByFields":["instance-id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"e9d-74b-bb2","isDefault":true,"name":"AWS EC2
      Instance Inbound Connections from TOR"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0040-impact","technique:T1496-resource-hijacking","source:guardduty","scope:ec2"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an EC2 instance is participating in a Denial of Service (DoS)
      attack.\n\n### Strategy\nThis rule lets you monitor these [GuardDuty integration][1]
      findings:\n\n* [Backdoor:EC2/DenialOfService.Tcp][2]\n* [Backdoor:EC2/DenialOfService.Udp][3]\n*
      [Backdoor:EC2/DenialOfService.Dns][4]\n* [Backdoor:EC2/DenialOfService.UdpOnTcpPorts][5]\n*
      [Backdoor:EC2/DenialOfService.UnusualProtocol][6]\n\n\n### Triage & Response\n1.
      Determine if the EC2 instance is compromised and participating in a DoS attack.\n2.
      If the instance is compromised:\n   * Review the AWS [documentation][7] on remediating
      a compromised EC2 instance.\n\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_backdoor.html#backdoor8\n[3]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_backdoor.html#backdoor9\n[4]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_backdoor.html#backdoor10\n[5]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_backdoor.html#backdoor11\n[6]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_backdoor.html#backdoor12\n[7]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-ec2\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":695,"createdAt":1587524599875,"queries":[{"query":"source:guardduty
      @evt.name:(Backdoor\\:EC2\\/DenialOfService.Tcp OR Backdoor\\:EC2\\/DenialOfService.Udp
      OR Backdoor\\:EC2\\/DenialOfService.Dns OR Backdoor\\:EC2\\/DenialOfService.UdpOnTcpPorts
      OR Backdoor\\:EC2\\/DenialOfService.UnusualProtocol)","groupByFields":["instance-id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"c7f-627-02b","isDefault":true,"name":"AWS EC2
      Instance Participating in a DoS Attack"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0005-defense-evasion","technique:T1089-disabling-security-tools","source:guardduty","scope:iam"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an AWS IAM user is changing sensitive configurations and has
      no prior history of invoking these APIs.\n\n### Strategy\nThis rule lets you
      monitor these [GuardDuty integration][1] findings:\n\n* [Stealth:IAMUser/S3ServerAccessLoggingDisabled][2]\n*
      [Stealth:IAMUser/PasswordPolicyChange][3]\n* [Stealth:IAMUser/CloudTrailLoggingDisabled][4]\n*
      [Stealth:IAMUser/LoggingConfigurationModified][5]\n\n\n### Triage & Response\n1.
      Determine which user triggered the signal. This can be found in the signal.\n2.
      Determine if the user''s credentials are compromised.  \n3. If the user''s credentials
      are compromised:\n  * Review the AWS [documentation][6] on remediating compromised
      AWS credentials.\n\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_stealth.html#stealth4\n[3]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_stealth.html#stealth1\n[4]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_stealth.html#stealth2\n[5]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_stealth.html#stealth3\n[6]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-creds\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":694,"createdAt":1587524600798,"queries":[{"query":"source:guardduty
      @evt.name:(Stealth\\:IAMUser\\/S3ServerAccessLoggingDisabled OR Stealth\\:IAMUser\\/PasswordPolicyChange
      OR Stealth\\:IAMUser\\/CloudTrailLoggingDisabled OR Stealth\\:IAMUser\\/LoggingConfigurationModified)","groupByFields":["@detail.resource.accessKeyDetails.userName"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"low","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"8b7-fca-c47","isDefault":true,"name":"AWS IAM
      User Changing Sensitive Configurations"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0040-impact","technique:T1496-resource-hijacking","source:guardduty","scope:ec2"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an EC2 instance is compromised and sending spam emails.\n\n###
      Strategy\nThis rule lets you monitor this [GuardDuty integration][1] finding:\n\n*
      [Backdoor:EC2/Spambot][2]\n\n\n### Triage & Response\n1. Determine if the EC2
      should be sending out email over port 25. \n2. If the instance is compromised:\n   *
      Review the AWS [documentation][3] on remediating a compromised EC2 instance.\n\n[1]:
      https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_backdoor.html#backdoor6\n[3]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-ec2\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":695,"createdAt":1587524601247,"queries":[{"query":"source:guardduty
      @evt.name:(Backdoor\\:EC2\\/Spambot)","groupByFields":["instance-id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"590-b8f-fe6","isDefault":true,"name":"AWS EC2
      Instance Sending Spam Emails"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0003-persistence","source:guardduty","scope:iam"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an AWS IAM user is attempting to gain persistence within an
      AWS account.\n\n### Strategy\nThis rule lets you monitor these [GuardDuty integration][1]
      findings:\n\n* [Persistence:IAMUser/NetworkPermissions][2]\n* [Persistence:IAMUser/ResourcePermissions][3]\n*
      [Persistence:IAMUser/UserPermissions][4]\n\n\n### Triage & Response\n1. Determine
      which user triggered the signal. This can be found in the signal.\n2. Determine
      if the user''s credentials are compromised.  \n3. If the user''s credentials
      are compromised:\n  * Review the AWS [documentation][5] on remediating compromised
      AWS credentials.\n\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_persistence.html#persistence1\n[3]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_persistence.html#persistence2\n[4]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_persistence.html#persistence3\n[5]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-creds\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":694,"createdAt":1587524601694,"queries":[{"query":"source:guardduty
      @evt.name:(Persistence\\:IAMUser\\/NetworkPermissions OR Persistence\\:IAMUser\\/ResourcePermissions
      OR Persistence\\:IAMUser\\/UserPermissions)","groupByFields":["@detail.resource.accessKeyDetails.userName"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"552-9a7-5c4","isDefault":true,"name":"AWS IAM
      User Attempting to Gain Persistence"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0040-impact","technique:T1496-resource-hijacking","source:guardduty","scope:ec2"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an EC2 instance is being used as a TOR relay.\n\n### Strategy\nThis
      rule lets you monitor this [GuardDuty integration][1] finding:\n\n* [UnauthorizedAccess:EC2/TorRelay][2]\n\n\n###
      Triage & Response\n1. Determine if the EC2 instance should be uses as a TOR
      relay. \n2. If the instance is compromised:\n   * Review the AWS [documentation][3]
      on remediating a compromised EC2 instance. \n\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#unauthorized14\n[3]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-ec2\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":696,"createdAt":1587524602580,"queries":[{"query":"source:guardduty
      @evt.name:(UnauthorizedAccess\\:EC2\\/TorRelay)","groupByFields":["instance-id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":["@slack-Team_Name-dont-make-me-now","@slack-aaa-ops"],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"468-0e5-110","isDefault":true,"name":"AWS EC2
      Instance Connecting to TOR as a Relay"},{"creationAuthorId":0,"tags":["security:anomaly","source:guardduty","scope:iam"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an AWS IAM user login is suspicious.\n\n### Strategy\nThis
      rule lets you monitor these [GuardDuty integration][1] findings:\n\n* [UnauthorizedAccess:IAMUser/ConsoleLoginSuccess.B][2]\n*
      [UnauthorizedAccess:IAMUser/ConsoleLogin][3]\n\n\n### Triage & Response\n1.
      Determine which user triggered the signal. This can be found in the signal.\n2.
      Determine if the user''s credentials are compromised.  \n3. If the user''s credentials
      are compromised:\n  * Review the AWS [documentation][4] on remediating compromised
      AWS credentials.\n\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#unauthorized4\n[3]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#unauthorized12\n[4]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-creds\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":694,"createdAt":1587524602836,"queries":[{"query":"source:guardduty
      @evt.name:(UnauthorizedAccess\\:IAMUser\\/ConsoleLoginSuccess.B OR UnauthorizedAccess\\:IAMUser\\/ConsoleLogin)","groupByFields":["@detail.resource.accessKeyDetails.userName"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"1c3-b3c-314","isDefault":true,"name":"AWS IAM
      User Suspicious Login"},{"creationAuthorId":0,"tags":["security:threat-intel","source:guardduty","scope:ec2"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an EC2 instance makes an outbound network connection to a
      malcious IP address.\n\n### Strategy\nThis rule lets you monitor this [GuardDuty
      integration][1] finding:\n\n* [UnauthorizedAccess:EC2/MaliciousIPCaller.Custom][2]\n\n\n###
      Triage & Response\n1. Determine which IP address triggered the signal. This
      can be found in the sample.\n2. If the instance is compromised:\n   * Review
      the AWS [documentation][3] on remediating a compromised EC2 instance.\n\n[1]:
      https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#unauthorized5\n[3]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-creds\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":693,"createdAt":1587524603816,"queries":[{"query":"source:guardduty
      @evt.name:(UnauthorizedAccess\\:EC2\\/MaliciousIPCaller.Custom)","groupByFields":["instance-id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"ae2-e7c-13a","isDefault":true,"name":"AWS EC2
      Instance Communicating with Malicious IP"},{"creationAuthorId":0,"tags":["security:anomaly","source:guardduty","scope:ec2"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an EC2 instance is communicating over an unusual port.\n\n###
      Strategy\nThis rule lets you monitor this [GuardDuty integration][1] finding:\n\n*
      [Behavior:EC2/NetworkPortUnusual][2]\n\n\n### Triage & Response\n1. Determine
      which port triggered the signal. This can be found in the samples.\n2. If the
      instance is compromised:\n   * Review the AWS [documentation][3] on remediating
      a compromised EC2 instance.\n\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_behavior.html#behavior3\n[3]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-ec2\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":691,"createdAt":1587524605686,"queries":[{"query":"source:guardduty
      @evt.name:(Behavior\\:EC2\\/NetworkPortUnusual)","groupByFields":["instance-id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"162-a35-e90","isDefault":true,"name":"AWS EC2
      Instance Communicating Over Unusual Port"},{"creationAuthorId":0,"tags":["source:guardduty","scope:iam"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an AWS IAM user makes API requests with hacking tools.\n\n###
      Strategy\nThis rule lets you monitor these [GuardDuty integration][1] findings:\n\n*
      [PenTest:IAMUser/KaliLinux][2]\n* [PenTest:IAMUser/ParrotLinux][3]\n* [PenTest:IAMUser/PentooLinux][4]\n\n\n###
      Triage & Response\n1. Determine which user triggered the signal. This can be
      found in the signal.\n2. Determine if the user''s credentials are compromised.  \n3.
      If the user''s credentials are compromised:\n  * Review the AWS [documentation][5]
      on remediating compromised AWS credentials.\n\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_pentest.html#pentest1\n[3]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_pentest.html#pentest2\n[4]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_pentest.html#pentest3\n[5]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-creds\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":690,"createdAt":1587524606570,"queries":[{"query":"source:guardduty
      @evt.name:(PenTest\\:IAMUser\\/KaliLinux OR PenTest\\:IAMUser\\/ParrotLinux
      OR PenTest\\:IAMUser\\/PentooLinux)","groupByFields":["@detail.resource.accessKeyDetails.userName"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"6c4-403-0f6","isDefault":true,"name":"AWS IAM
      User Making API Requests With Hacking Tools"},{"creationAuthorId":0,"tags":["security:attack","source:guardduty","scope:ec2"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an EC2 instance is communicating with a malicious server.\n\n###
      Strategy\nThis rule lets you monitor these [GuardDuty integration][1] findings:\n\n*
      [Backdoor:EC2/C&CActivity.B!DNS][2]\n* [Trojan:EC2/BlackholeTraffic][3]\n* [Trojan:EC2/DropPoint][4]\n*
      [Trojan:EC2/BlackholeTraffic!DNS][5]\n* [Trojan:EC2/DriveBySourceTraffic!DNS][6]\n*
      [Trojan:EC2/DropPoint!DNS][7]\n* [Trojan:EC2/DGADomainRequest.B][8]\n* [Trojan:EC2/DGADomainRequest.C!DNS][9]\n*
      [Trojan:EC2/DNSDataExfiltration][10]\n* [Trojan:EC2/PhishingDomainRequest!DNS][11]\n\n\n###
      Triage & Response\n1. Determine which domain name or IP address triggered the
      signal. This can be found in the samples.\n2. If the instance is compromised:\n   *
      Review the AWS [documentation][12] on remediating a compromised EC2 instance.\n\n[1]:
      https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_backdoor.html#backdoor6\n[3]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_trojan.html#trojan4\n[4]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_trojan.html#trojan5\n[5]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_trojan.html#trojan6\n[6]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_trojan.html#trojan7\n[7]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_trojan.html#trojan8\n[8]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_trojan.html#trojan9\n[9]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_trojan.html#trojan95\n[10]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_trojan.html#trojan10\n[11]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_trojan.html#trojan11\n[12]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-ec2\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":691,"createdAt":1587524606780,"queries":[{"query":"source:guardduty
      @evt.name:(Trojan\\:EC2\\/BlackholeTraffic OR Trojan\\:EC2\\/DropPoint OR Trojan\\:EC2\\/BlackholeTraffic\\!DNS
      OR Trojan\\:EC2\\/DriveBySourceTraffic\\!DNS OR Trojan\\:EC2\\/DropPoint\\!DNS
      OR Trojan\\:EC2\\/DGADomainRequest.B OR Trojan\\:EC2\\/DGADomainRequest.C\\!DNS
      OR Backdoor\\:EC2\\/C&CActivity.B\\!DNS OR Trojan\\:EC2\\/PhishingDomainRequest\\!DNS)","groupByFields":["instance-id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"ce9-f5c-414","isDefault":true,"name":"AWS EC2
      Instance Communicated with a Malicious Server"},{"creationAuthorId":0,"tags":["security:compliance","framework:cis","control:cis-3.3","source:guardduty","scope:iam"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when the AWS root user credentials are used.\n\n### Strategy\nThis
      rule lets you monitor this [GuardDuty integration][1] finding:\n\n* [Policy:IAMUser/RootCredentialUsage][2]\n\n\n###
      Triage & Response\n1. Determine whether the root account activity was legitimate.
      \n * Review the sample for context. \n * Review CloudTrail logs for a full investigation.
      \n3. If the root user''s credentials are compromised:\n * Review the AWS [documentation][3]
      on remediating compromised AWS credentials.\n\n**[Root Account Best Practices][4]**\n\n[1]:
      https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_policy.html#policy1\n[3]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-creds\n[4]:
      https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":691,"createdAt":1587524607023,"queries":[{"query":"source:guardduty
      @evt.name:(Policy\\:IAMUser\\/RootCredentialUsage)","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"low","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"5fa-d16-013","isDefault":true,"name":"AWS Root
      Credential Activity"},{"creationAuthorId":0,"tags":["security:anomaly","source:guardduty","scope:ec2"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an EC2 instance network traffic volume is unusual.\n\n###
      Strategy\nThis rule lets you monitor this [GuardDuty integration][1] finding:\n\n*
      [Behavior:EC2/TrafficVolumeUnusual][2]\n\n\n### Triage & Response\n1. Determine
      which port triggered the signal. This can be found in the samples.\n2. If the
      instance is compromised:\n   * Review the AWS [documentation][3] on remediating
      a compromised EC2 instance.\n\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_behavior.html#behavior4\n[3]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-ec2\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":691,"createdAt":1587524607258,"queries":[{"query":"source:guardduty
      @evt.name:(Behavior\\:EC2\\/TrafficVolumeUnusual)","groupByFields":["instance-id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"25c-6c9-5f0","isDefault":true,"name":"AWS EC2
      Instance Network Traffic Volume Unusual"},{"creationAuthorId":0,"tags":["security:threat-intel","source:guardduty","scope:ec2"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an AWS API call is made from a non EC2 IP for a credential
      which is scoped to an EC2 Instance.  \n\n### Strategy\nThis rule lets you monitor
      this [GuardDuty integration][1] finding:\n\n* [UnauthorizedAccess:IAMUser/InstanceCredentialExfiltration][2]\n\n\n###
      Triage & Response\n1. Determine the EC2 instance this credential is scoped to.
      This can be found in the samples. \n2. Determine if the EC2 instance credentials
      are compromised.  \n3. If the instance is compromised:\n   * Review the AWS
      [documentation][3] on remediating a compromised EC2 instance.\n\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#unauthorized11\n[3]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-ec2\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":716,"createdAt":1587524648558,"queries":[{"query":"source:guardduty
      @evt.name:(UnauthorizedAccess\\:IAMUser\\/InstanceCredentialExfiltration)","groupByFields":["@detail.resource.accessKeyDetails.userName"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"b7f-889-b21","isDefault":true,"name":"AWS EC2
      Instance Credential Exfiltrated"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0004-privilege-escalation","source:guardduty","scope:iam"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an AWS IAM user is attempting to escalate permissions.\n\n###
      Strategy\nThis rule lets you monitor this [GuardDuty integration][1] finding:\n\n*
      [PrivilegeEscalation:IAMUser/AdministrativePermissions][2]\n\n\n### Triage &
      Response\n1. Determine which user triggered the signal. This can be found in
      the signal.\n2. Determine if the user''s credentials are compromised.  \n3.
      If the user''s credentials are compromised:\n  * Review the AWS [documentation][3]
      on remediating compromised AWS credentials.\n\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_privilegeescalation.html#privilegeescalation1\n[5]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-creds\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":694,"createdAt":1587524652630,"queries":[{"query":"source:guardduty
      @evt.name:(PrivilegeEscalation\\:IAMUser\\/AdministrativePermissions)","groupByFields":["@detail.resource.accessKeyDetails.userName"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"1af-eca-788","isDefault":true,"name":"AWS IAM
      User Escalating Privileges"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0006-credential-access","technique:T1522-cloud-instance-metadata-api","source:guardduty","scope:ec2"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an EC2 instance makes a DNS request and resolves to the AWS
      metadata IP address (169.254.169.254).\n\n### Strategy\nThis rule lets you monitor
      this [GuardDuty integration][1] finding:\n\n* [UnauthorizedAccess:EC2/MetadataDNSRebind][2]\n\n\n###
      Triage & Response\n1. Determine which process made the DNS request. The DNS
      request can be found in the samples.\n2. Ensure the process is not a victim
      of an SSRF attack to steal the AWS EC2 Instance profile''s STS credentials.  \n2.
      If the STS credentials are compromised:\n   * Review the AWS [documentation][3]
      on revoking the session.\n\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\n[2]:
      https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#ec2-metadatadnsrebind\n[3]:
      https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_revoke-sessions.html\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":694,"createdAt":1587524685843,"queries":[{"query":"source:guardduty
      @evt.name:(UnauthorizedAccess\\:EC2\\/MetadataDNSRebind)","groupByFields":["instance-id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"593-2e3-2bb","isDefault":true,"name":"AWS EC2
      Instance Victim to Metadata DNS Rebind Attack"},{"creationAuthorId":0,"tags":[],"isEnabled":true,"hasExtendedTitle":true,"message":"test
      staging rule","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":1,"createdAt":1587543386976,"queries":[{"query":"source:cloudtrail
      @evt.name:(DeleteTrail OR UpdateTrail OR StopLogging)","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"e1f-3b1-8a5","isDefault":true,"name":"Staged
      Test"},{"creationAuthorId":39119,"tags":["security:attack"],"isEnabled":false,"hasExtendedTitle":false,"message":"-
      [Rules Engine Error Logs](https://dd.datad0g.com/logs?saved_view=30657)\n- [Mapper
      Dashboard](https://dd.datad0g.com/dashboard/zyg-wt4-h3e)\n- [Reducer Dashboard](https://dd.datad0g.com/dashboard/qtu-r7r-jdc)","options":{"evaluationWindow":1800,"maxSignalDuration":1800,"keepAlive":1800},"version":26,"createdAt":1587659150224,"queries":[{"query":"service:logs-rule-reducer
      status:error -\"OpenJDK\" -\"[dd.trace\" -JAVA_TOOL_OPTIONS","groupByFields":[],"name":"","distinctFields":[]},{"query":"service:logs-rule-mapper
      status:error -\"OpenJDK\" -\"[dd.trace\" -JAVA_TOOL_OPTIONS","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"rule-reducer","condition":"a
      > 0"},{"status":"high","notifications":[],"name":"rule-mapper","condition":"b
      > 0"}],"type":"threshold","id":"xvd-vgo-crj","isDefault":false,"name":"The Rule
      Engine has some errors "},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0001-initial-access","technique:T1190-exploit-public-facing-application","source:apache","scope:apache"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a web application is being scanned. This identifies attacker
      IP addresses who are not trying to hide their attempt to attack your system.
      More advanced hackers will use an inconspicuous user agent. \n\n### Strategy\nInspect
      the user agent in the HTTP headers to determine if an IP is scanning your application
      and generate an `INFO` signal. \n\n### Triage and Response\n1. Determine if
      this IP is making authenticated requests to the application.\n2. If the IP is
      making authenticated requests to the application:\n * Investigate the HTTP logs
      and determine if the user is attacking your application.\n\nThe HTTP headers
      in the query are from [darkqusar][1]''s [gist][2] \n\n[1]: https://gist.github.com/darkquasar\n[2]:
      https://gist.github.com/darkquasar/84fb2cec6cc1668795bd97c02302d380\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":714,"createdAt":1587733579122,"queries":[{"query":"source:apache
      @network.client.ip:* @http.useragent:(\"burp\" OR \"burpcollaborator.net\" OR
      \"qualys\" OR \"nexpose\" OR \"OpenVAS\" OR \"Nikto\" OR \"Meterpreter\" OR
      \"IceWeasel\" OR \"DirB\" OR \"Comodo\" OR \"Tripwire\" OR \"Retina\" OR \"MBSA\"
      OR \"ImmuniWeb\" OR \"Netsparker\" OR \"Acunetix\" OR \"Intruder\" OR \"WinHttp.WinHttpRequest\"
      OR \"nmap\" OR \"CVE\" OR \"base64\" OR \"eval\" OR \"ftp\" OR \"script\" OR
      \"javascript\" OR \"alert\")","groupByFields":["@network.client.ip"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"pz0-v2d-udq","isDefault":true,"name":"Apache
      HTTP Requests from Security Scanner"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0001-initial-access","technique:T1190-exploit-public-facing-application","source:nginx-ingress-controller","scope:nginx-ingress-controller"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a web application is being scanned. This will identify attacker
      IP addresses who are not trying to hide their attempt to attack your system.
      More advanced hackers will use an inconspicuous user agent. \n\n### Strategy\nInspect
      the user agent in the HTTP headers to determine if an IP is scanning your application
      and generate an `INFO` signal. \n\n### Triage and Response\n1. Determine if
      this IP is making authenticated requests to the application.\n2. If the IP is
      making authenticated requests to the application:\n * Investigate the HTTP logs
      and determine if the user is attacking your application.\n\nThe HTTP headers
      in the query are from [darkqusar][1]''s [gist][2] \n\n[1]: https://gist.github.com/darkquasar\n[2]:
      https://gist.github.com/darkquasar/84fb2cec6cc1668795bd97c02302d380\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":714,"createdAt":1587733581879,"queries":[{"query":"source:nginx-ingress-controller
      @network.client.ip:* @http.useragent:(\"burp\" OR \"burpcollaborator.net\" OR
      \"qualys\" OR \"nexpose\" OR \"OpenVAS\" OR \"Nikto\" OR \"Meterpreter\" OR
      \"IceWeasel\" OR \"DirB\" OR \"Comodo\" OR \"Tripwire\" OR \"Retina\" OR \"MBSA\"
      OR \"ImmuniWeb\" OR \"Netsparker\" OR \"Acunetix\" OR \"Intruder\" OR \"WinHttp.WinHttpRequest\"
      OR \"nmap\" OR \"CVE\" OR \"base64\" OR \"eval\" OR \"ftp\" OR \"script\" OR
      \"javascript\" OR \"alert\")","groupByFields":["@network.client.ip"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"vdu-aka-h7o","isDefault":true,"name":"NGINX
      Ingress Controller HTTP Requests from Security Scanner"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0001-initial-access","technique:T1190-exploit-public-facing-application","source:elb","scope:elb"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a web application is being scanned. This will identify attacker
      IP addresses who are not trying to hide their attempt to attack your system.
      More advanced hackers will use an inconspicuous User Agent. \n\n### Strategy\nInspect
      the user agent in the HTTP headers to determine if an IP is scanning your application
      and generate an INFO signal.  \n\n### Triage and Response\n1. Determine if this
      IP is making authenticated requests to the application.\n2. If the IP is making
      authenticated requests to the application:\n * Investigate the HTTP logs and
      determine if the user is attacking your application.\n\nThe HTTP headers in
      the query are from [darkqusar][1]''s [gist][2] \n\n[1]: https://gist.github.com/darkquasar\n[2]:
      https://gist.github.com/darkquasar/84fb2cec6cc1668795bd97c02302d380\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":693,"createdAt":1587733593867,"queries":[{"query":"source:elb
      @network.client.ip:* @http.useragent:(\"burp\" OR \"burpcollaborator.net\" OR
      \"qualys\" OR \"nexpose\" OR \"OpenVAS\" OR \"Nikto\" OR \"Meterpreter\" OR
      \"IceWeasel\" OR \"DirB\" OR \"Comodo\" OR \"Tripwire\" OR \"Retina\" OR \"MBSA\"
      OR \"ImmuniWeb\" OR \"Netsparker\" OR \"Acunetix\" OR \"Intruder\" OR \"WinHttp.WinHttpRequest\"
      OR \"nmap\" OR \"CVE\" OR \"base64\" OR \"eval\" OR \"ftp\" OR \"script\" OR
      \"javascript\" OR \"alert\")","groupByFields":["@network.client.ip"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"d12-ozj-dak","isDefault":true,"name":"AWS ELB
      HTTP Requests from Security Scanner"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0001-initial-access","technique:T1190-exploit-public-facing-application","source:fastly","scope:fastly"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a web application is being scanned. This identifies attacker
      IP addresses who are not trying to hide their attempt to attack your system.
      More advanced hackers will use an inconspicuous user agent. \n\n### Strategy\nInspect
      the user agent in the HTTP headers to determine if an IP is scanning your application
      and generate an `INFO` signal. \n\n### Triage and Response\n1. Determine if
      this IP is making authenticated requests to the application.\n2. If the IP is
      making authenticated requests to the application:\n * Investigate the HTTP logs
      and determine if the user is attacking your application.\n\nThe HTTP headers
      in the query are from [darkqusar][1]''s [gist][2]. \n\n[1]: https://gist.github.com/darkquasar\n[2]:
      https://gist.github.com/darkquasar/84fb2cec6cc1668795bd97c02302d380\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":693,"createdAt":1587733603017,"queries":[{"query":"source:fastly
      @network.client.ip:* @http.useragent:(\"burp\" OR \"burpcollaborator.net\" OR
      \"qualys\" OR \"nexpose\" OR \"OpenVAS\" OR \"Nikto\" OR \"Meterpreter\" OR
      \"IceWeasel\" OR \"DirB\" OR \"Comodo\" OR \"Tripwire\" OR \"Retina\" OR \"MBSA\"
      OR \"ImmuniWeb\" OR \"Netsparker\" OR \"Acunetix\" OR \"Intruder\" OR \"WinHttp.WinHttpRequest\"
      OR \"nmap\" OR \"CVE\" OR \"base64\" OR \"eval\" OR \"ftp\" OR \"script\" OR
      \"javascript\" OR \"alert\")","groupByFields":["@network.client.ip"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"d0g-ind-woa","isDefault":true,"name":"Fastly
      HTTP Requests from Security Scanner"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0001-initial-access","technique:T1190-exploit-public-facing-application","source:nginx","scope:nginx"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a web application is being scanned. This will identify attacker
      IP addresses who are not trying to hide their attempt to attack your system.
      More advanced hackers will use an inconspicuous user agent. \n\n### Strategy\nInspect
      the user agent in the HTTP headers to determine if an IP is scanning your application
      and generate an `INFO` signal. \n\n### Triage and Response\n1. Determine if
      this IP is making authenticated requests to the application.\n2. If the IP is
      making authenticated requests to the application:\n * Investigate the HTTP logs
      and determine if the user is attacking your application.\n\nThe HTTP headers
      in the query are from [darkqusar][1]''s [gist][2] \n\n[1]: https://gist.github.com/darkquasar\n[2]:
      https://gist.github.com/darkquasar/84fb2cec6cc1668795bd97c02302d380\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":694,"createdAt":1587733603665,"queries":[{"query":"source:nginx
      @network.client.ip:* @http.useragent:(\"burp\" OR \"burpcollaborator.net\" OR
      \"qualys\" OR \"nexpose\" OR \"OpenVAS\" OR \"Nikto\" OR \"Meterpreter\" OR
      \"IceWeasel\" OR \"DirB\" OR \"Comodo\" OR \"Tripwire\" OR \"Retina\" OR \"MBSA\"
      OR \"ImmuniWeb\" OR \"Netsparker\" OR \"Acunetix\" OR \"Intruder\" OR \"WinHttp.WinHttpRequest\"
      OR \"nmap\" OR \"CVE\" OR \"base64\" OR \"eval\" OR \"ftp\" OR \"script\" OR
      \"javascript\" OR \"alert\")","groupByFields":["@network.client.ip"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":["@slack-k9-testing-channel","@bernard.le@datadoghq.com"],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"crj-bzn-ncc","isDefault":true,"name":"NGINX
      HTTP Requests from Security Scanner"},{"creationAuthorId":39006,"tags":[],"isEnabled":false,"hasExtendedTitle":false,"message":"Message","options":{"evaluationWindow":300,"maxSignalDuration":86400,"keepAlive":3600},"version":10,"createdAt":1588583149779,"queries":[{"query":"service:mcnulty-web","groupByFields":["@rid"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 50"}],"type":"threshold","id":"y5h-eqo-mby","isDefault":false,"name":"PBR
      test"},{"creationAuthorId":0,"tags":["security:attack","tactic:TA0001-initial-access","technique:T1190-exploit-public-facing-application","source:iis","scope:iis"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a web application is being scanned. This will identify attacker
      IP addresses who are not trying to hide their attempt to attack your system.
      More advanced hackers will use an inconspicuous user agent. \n\n### Strategy\nInspect
      the user agent in the HTTP headers to determine if an IP is scanning your application
      and generate an `INFO` signal. \n\n### Triage and Response\n1. Determine if
      this IP is making authenticated requests to the application.\n2. If the IP is
      making authenticated requests to the application:\n * Investigate the HTTP logs
      and determine if the user is attacking your application.\n\nThe HTTP headers
      in the query are from [darkqusar][1]''s [gist][2] \n\n[1]: https://gist.github.com/darkquasar\n[2]:
      https://gist.github.com/darkquasar/84fb2cec6cc1668795bd97c02302d380\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":693,"createdAt":1588695211431,"queries":[{"query":"source:iis
      @network.client.ip:* @http.useragent:(\"burp\" OR \"burpcollaborator.net\" OR
      \"qualys\" OR \"nexpose\" OR \"OpenVAS\" OR \"Nikto\" OR \"Meterpreter\" OR
      \"IceWeasel\" OR \"DirB\" OR \"Comodo\" OR \"Tripwire\" OR \"Retina\" OR \"MBSA\"
      OR \"ImmuniWeb\" OR \"Netsparker\" OR \"Acunetix\" OR \"Intruder\" OR \"WinHttp.WinHttpRequest\"
      OR \"nmap\" OR \"CVE\" OR \"base64\" OR \"eval\" OR \"ftp\" OR \"script\" OR
      \"javascript\" OR \"alert\")","groupByFields":["@network.client.ip"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"bep-iw5-tpl","isDefault":true,"name":"IIS HTTP
      Requests from Security Scanner"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588755458238,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"k2o-cjc-svp","isDefault":false,"name":"test-rule-datadog-api-client-java-1--2020-05-06T10:57:32.770533-b92abade-7518-49ca-8f4b-e1581b8bf7c9"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588755458472,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"biv-pht-ddo","isDefault":false,"name":"test-rule-datadog-api-client-java-2--2020-05-06T10:57:32.770533-b92abade-7518-49ca-8f4b-e1581b8bf7c9"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588755458743,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"ddo-big-usu","isDefault":false,"name":"test-rule-datadog-api-client-java-3--2020-05-06T10:57:32.770533-b92abade-7518-49ca-8f4b-e1581b8bf7c9"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588755458976,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"0z0-5p7-xti","isDefault":false,"name":"test-rule-datadog-api-client-java-4--2020-05-06T10:57:32.770533-b92abade-7518-49ca-8f4b-e1581b8bf7c9"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588765042123,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"ugp-5v2-lgd","isDefault":false,"name":"test-rule-datadog-api-client-java-0--2020-05-06T13:37:18.882819-a5af53d4-40de-4941-9f35-05e411503df0"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588765042608,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"ppd-ssn-klu","isDefault":false,"name":"test-rule-datadog-api-client-java-1--2020-05-06T13:37:18.882819-a5af53d4-40de-4941-9f35-05e411503df0"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588765042918,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"nrw-4v4-k5a","isDefault":false,"name":"test-rule-datadog-api-client-java-2--2020-05-06T13:37:18.882819-a5af53d4-40de-4941-9f35-05e411503df0"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588765043177,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"hdb-wlf-f1e","isDefault":false,"name":"test-rule-datadog-api-client-java-3--2020-05-06T13:37:18.882819-a5af53d4-40de-4941-9f35-05e411503df0"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588765043382,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"1ze-hfa-sot","isDefault":false,"name":"test-rule-datadog-api-client-java-4--2020-05-06T13:37:18.882819-a5af53d4-40de-4941-9f35-05e411503df0"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588765479639,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"zqg-ndp-mxf","isDefault":false,"name":"test-rule-datadog-api-client-java-0--2020-05-06T13:44:35.377319-51aced12-a747-46cb-af83-0c7a5d86a344"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588765480115,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"pzv-1fd-6um","isDefault":false,"name":"test-rule-datadog-api-client-java-1--2020-05-06T13:44:35.377319-51aced12-a747-46cb-af83-0c7a5d86a344"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588765480312,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"cq5-klk-ji5","isDefault":false,"name":"test-rule-datadog-api-client-java-2--2020-05-06T13:44:35.377319-51aced12-a747-46cb-af83-0c7a5d86a344"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588765480602,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"9h8-k9i-pdq","isDefault":false,"name":"test-rule-datadog-api-client-java-3--2020-05-06T13:44:35.377319-51aced12-a747-46cb-af83-0c7a5d86a344"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588765480827,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"ps0-j74-csl","isDefault":false,"name":"test-rule-datadog-api-client-java-4--2020-05-06T13:44:35.377319-51aced12-a747-46cb-af83-0c7a5d86a344"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588765973260,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"ejo-f6y-fyb","isDefault":false,"name":"test-rule-datadog-api-client-java-0--2020-05-06T13:52:48.8048-c77dcd58-3ab3-45c3-8705-d789526c6de6"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588765973653,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"asl-axm-b2o","isDefault":false,"name":"test-rule-datadog-api-client-java-1--2020-05-06T13:52:48.8048-c77dcd58-3ab3-45c3-8705-d789526c6de6"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588765973926,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"v2b-0ac-7t9","isDefault":false,"name":"test-rule-datadog-api-client-java-2--2020-05-06T13:52:48.8048-c77dcd58-3ab3-45c3-8705-d789526c6de6"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588765974213,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"sbc-wrk-imd","isDefault":false,"name":"test-rule-datadog-api-client-java-3--2020-05-06T13:52:48.8048-c77dcd58-3ab3-45c3-8705-d789526c6de6"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588765974445,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"lyn-4ma-ueb","isDefault":false,"name":"test-rule-datadog-api-client-java-4--2020-05-06T13:52:48.8048-c77dcd58-3ab3-45c3-8705-d789526c6de6"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588766051679,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"oj5-cc3-wu5","isDefault":false,"name":"test-rule-datadog-api-client-java-0--2020-05-06T13:54:07.720943-f714cf8a-86e4-4948-a528-89abfed40587"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588766052011,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"saz-gbu-mo6","isDefault":false,"name":"test-rule-datadog-api-client-java-1--2020-05-06T13:54:07.720943-f714cf8a-86e4-4948-a528-89abfed40587"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588766052210,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"rn3-sue-cnw","isDefault":false,"name":"test-rule-datadog-api-client-java-2--2020-05-06T13:54:07.720943-f714cf8a-86e4-4948-a528-89abfed40587"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588766052480,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"85p-g4z-gas","isDefault":false,"name":"test-rule-datadog-api-client-java-3--2020-05-06T13:54:07.720943-f714cf8a-86e4-4948-a528-89abfed40587"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588766052739,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"ykq-qwz-wlg","isDefault":false,"name":"test-rule-datadog-api-client-java-4--2020-05-06T13:54:07.720943-f714cf8a-86e4-4948-a528-89abfed40587"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588768281097,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"yzk-3cy-hsm","isDefault":false,"name":"test-rule-datadog-api-client-java-0--2020-05-06T14:31:17.387581-1fe700f1-3904-4545-93e2-dc6b191b6bbe"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588768281448,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"ahv-n6x-whh","isDefault":false,"name":"test-rule-datadog-api-client-java-1--2020-05-06T14:31:17.387581-1fe700f1-3904-4545-93e2-dc6b191b6bbe"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588768281676,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"ahq-wt5-amx","isDefault":false,"name":"test-rule-datadog-api-client-java-2--2020-05-06T14:31:17.387581-1fe700f1-3904-4545-93e2-dc6b191b6bbe"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588768282033,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"dsn-gya-7cs","isDefault":false,"name":"test-rule-datadog-api-client-java-3--2020-05-06T14:31:17.387581-1fe700f1-3904-4545-93e2-dc6b191b6bbe"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588768282318,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"fo5-vlj-bjm","isDefault":false,"name":"test-rule-datadog-api-client-java-4--2020-05-06T14:31:17.387581-1fe700f1-3904-4545-93e2-dc6b191b6bbe"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":false,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":2,"createdAt":1588774541733,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"k5a-zuy-uen","isDefault":false,"name":"test-rule-datadog-api-client-java-0--2020-05-06T16:15:38.835053-7c6fc53a-0d3f-4572-bedf-ad267e2c11c7"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588774542103,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"eca-f2f-u5r","isDefault":false,"name":"test-rule-datadog-api-client-java-1--2020-05-06T16:15:38.835053-7c6fc53a-0d3f-4572-bedf-ad267e2c11c7"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588774542314,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"yyo-mi3-pkx","isDefault":false,"name":"test-rule-datadog-api-client-java-2--2020-05-06T16:15:38.835053-7c6fc53a-0d3f-4572-bedf-ad267e2c11c7"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588774542526,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"sdj-ugc-sus","isDefault":false,"name":"test-rule-datadog-api-client-java-3--2020-05-06T16:15:38.835053-7c6fc53a-0d3f-4572-bedf-ad267e2c11c7"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588774542775,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"euy-mok-mjr","isDefault":false,"name":"test-rule-datadog-api-client-java-4--2020-05-06T16:15:38.835053-7c6fc53a-0d3f-4572-bedf-ad267e2c11c7"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588774614921,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"ias-pko-evq","isDefault":false,"name":"test-rule-datadog-api-client-java-1--2020-05-06T16:16:46.814589-3904c082-45fd-43b5-a99e-dab4d337b371"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588774615138,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"urm-g7d-fty","isDefault":false,"name":"test-rule-datadog-api-client-java-2--2020-05-06T16:16:46.814589-3904c082-45fd-43b5-a99e-dab4d337b371"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588774615337,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"9k0-1p7-g7b","isDefault":false,"name":"test-rule-datadog-api-client-java-3--2020-05-06T16:16:46.814589-3904c082-45fd-43b5-a99e-dab4d337b371"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588774615644,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"xzc-hqm-l3h","isDefault":false,"name":"test-rule-datadog-api-client-java-4--2020-05-06T16:16:46.814589-3904c082-45fd-43b5-a99e-dab4d337b371"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588777898109,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"dgs-mrt-jot","isDefault":false,"name":"test-rule-datadog-api-client-java-1--2020-05-06T17:11:33.023073-879a5344-91c2-42dd-9ce9-cc46f60b1aa8"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588777898371,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"3vi-p0s-f65","isDefault":false,"name":"test-rule-datadog-api-client-java-2--2020-05-06T17:11:33.023073-879a5344-91c2-42dd-9ce9-cc46f60b1aa8"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588777899013,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"dor-nvi-m5y","isDefault":false,"name":"test-rule-datadog-api-client-java-3--2020-05-06T17:11:33.023073-879a5344-91c2-42dd-9ce9-cc46f60b1aa8"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588777899208,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"bcj-7m8-kre","isDefault":false,"name":"test-rule-datadog-api-client-java-4--2020-05-06T17:11:33.023073-879a5344-91c2-42dd-9ce9-cc46f60b1aa8"},{"creationAuthorId":40250,"tags":["test-tag"],"isEnabled":false,"hasExtendedTitle":false,"message":"Matias
      test rule.","options":{"evaluationWindow":300,"maxSignalDuration":86400,"keepAlive":3600},"version":21,"createdAt":1588778638381,"queries":[{"query":"service:logs-rule-reducer","groupByFields":[],"name":"","distinctFields":[]},{"query":"service:logs-rule-mapper","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":["@matias.dwek@datadoghq.com"],"name":"Case
      1","condition":"a > 10 || b > 20"},{"status":"info","notifications":["@matias.dwek@datadoghq.com"],"name":"Case
      2","condition":"b > 30"},{"status":"info","notifications":["@matias.dwek@datadoghq.com"],"name":"Case
      3","condition":"a > 20"}],"type":"threshold","id":"5kg-qnr-aeq","isDefault":false,"name":"matias-test-rule"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588779274517,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"dml-0fs-tt0","isDefault":false,"name":"test-rule-datadog-api-client-java-1--2020-05-06T17:34:30.943456-c94bb336-f7cb-4a03-b3d4-ea31bb457b12"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588779274746,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"v1j-gxo-s3o","isDefault":false,"name":"test-rule-datadog-api-client-java-2--2020-05-06T17:34:30.943456-c94bb336-f7cb-4a03-b3d4-ea31bb457b12"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588779274941,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"hbd-hzy-nmt","isDefault":false,"name":"test-rule-datadog-api-client-java-3--2020-05-06T17:34:30.943456-c94bb336-f7cb-4a03-b3d4-ea31bb457b12"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-java"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588779275163,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"vlx-qim-lav","isDefault":false,"name":"test-rule-datadog-api-client-java-4--2020-05-06T17:34:30.943456-c94bb336-f7cb-4a03-b3d4-ea31bb457b12"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-go"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588868270142,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"din-wii-kqp","isDefault":false,"name":"test-rule-datadog-api-client-go-0-1588868269336841000"},{"creationAuthorId":2889,"tags":["datadog-api-client-test-go"],"isEnabled":true,"hasExtendedTitle":false,"message":"Rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1588868297230,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"ylo-0xu-m9b","isDefault":false,"name":"test-rule-datadog-api-client-go-0-1588868296375387000"},{"creationAuthorId":39006,"tags":[],"isEnabled":true,"hasExtendedTitle":false,"message":"a","options":{"evaluationWindow":60,"maxSignalDuration":60,"keepAlive":60},"version":1,"createdAt":1589209271444,"queries":[{"query":"source:kubelet","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 1000"}],"type":"threshold","id":"qbh-2pz-ot0","isDefault":false,"name":"PBR
      fat panes"},{"creationAuthorId":39006,"tags":[],"isEnabled":false,"hasExtendedTitle":false,"message":"a","options":{"evaluationWindow":0,"maxSignalDuration":0,"keepAlive":0},"version":4,"createdAt":1589277636951,"queries":[{"query":"source:kubelet
      pod error","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"bax-yrz-0di","isDefault":false,"name":"PBR -
      many signals"},{"creationAuthorId":40506,"tags":[],"isEnabled":true,"hasExtendedTitle":false,"message":"Test
      rule for in array search. With AWS log.\n","options":{"evaluationWindow":60,"maxSignalDuration":86400,"keepAlive":3600},"version":6,"createdAt":1589446528713,"queries":[{"query":"user:antoine_k9  @log.requestParameters.ipPermissions.items.ipRanges.items.cidrIp:\"0.0.0.0/0\"","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"In
      array: Got a match!","condition":"a>0"}],"type":"threshold","id":"iyo-trv-a5w","isDefault":false,"name":"[TEST]
      In array search first rule."},{"creationAuthorId":39119,"tags":[],"isEnabled":false,"hasExtendedTitle":true,"message":"Content","options":{"evaluationWindow":900,"maxSignalDuration":900,"keepAlive":900},"version":14,"createdAt":1589547345502,"queries":[{"query":"service:logs-rule-mapper","groupByFields":["status","host"],"name":"","distinctFields":[]},{"query":"service:logs-rule-reducer","groupByFields":["status","host"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":["@slack-k9-testing-channel"],"name":"mapper","condition":"a
      > 0"},{"status":"info","notifications":["@slack-k9-testing-channel"],"name":"reducer","condition":"b
      > 0"}],"type":"threshold","id":"fgc-gy5-y5p","isDefault":false,"name":"Test
      with group by values"},{"creationAuthorId":39119,"tags":[],"isEnabled":false,"hasExtendedTitle":true,"message":"Content","options":{"evaluationWindow":900,"maxSignalDuration":900,"keepAlive":900},"version":5,"createdAt":1589547629819,"queries":[{"query":"service:logs-rule-mapper","groupByFields":[],"name":"","distinctFields":[]},{"query":"service:logs-rule-reducer","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":["@slack-k9-testing-channel"],"name":"mapper","condition":"a
      > 0"},{"status":"info","notifications":["@slack-k9-testing-channel"],"name":"reducer","condition":"b
      > 0"}],"type":"threshold","id":"rsz-ufg-etr","isDefault":false,"name":"Test
      without group by values"},{"creationAuthorId":39006,"tags":[],"isEnabled":true,"hasExtendedTitle":false,"message":"test
      ","options":{"evaluationWindow":60,"maxSignalDuration":3600,"keepAlive":3600},"version":15,"createdAt":1589876688774,"queries":[{"query":"source:inventories
      @resource_direction:egress","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"
      a > 100"}],"type":"threshold","id":"jj8-tn9-jlp","isDefault":false,"name":"PBR
      - compliance test"},{"creationAuthorId":39119,"tags":[],"isEnabled":false,"hasExtendedTitle":true,"message":"TEST
      MAZ","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":19,"createdAt":1589882898708,"queries":[{"query":"FOO:BAR","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 3"}],"type":"threshold","id":"x2q-ub2-i5r","isDefault":false,"name":"Test
      MAZ"},{"creationAuthorId":4992,"tags":[],"isEnabled":false,"hasExtendedTitle":true,"message":"This
      rule is very important.","options":{"evaluationWindow":0,"maxSignalDuration":0,"keepAlive":0},"version":5,"createdAt":1589892372877,"queries":[{"query":"datacenter:us1.staging.dog","groupByFields":["host"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"wy9-4ng-c7z","isDefault":false,"name":"Serious
      rule"},{"creationAuthorId":4992,"tags":[],"isEnabled":false,"hasExtendedTitle":true,"message":"Maybe
      this rule will find hackers.","options":{"evaluationWindow":0,"maxSignalDuration":0,"keepAlive":0},"version":4,"createdAt":1589893132171,"queries":[{"query":"datacenter:us1.staging.dog","groupByFields":["pod_name"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"v48-cxc-fwq","isDefault":false,"name":"A better
      rule"},{"creationAuthorId":5410,"tags":["source:cloudtrail"],"isEnabled":true,"hasExtendedTitle":true,"message":"testing
      cloudtrail open to the world","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1589915983173,"queries":[{"query":"source:cloudtrail
      @requestParameters.ipPermissions.items.ipRanges.items.cidrIp:0.0.0.0\\/0","groupByFields":["@requestParameters.groupId"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"46j-jzk-hoa","isDefault":false,"name":"Security
      Group Open To the World"},{"creationAuthorId":0,"tags":["test:test"],"isEnabled":true,"hasExtendedTitle":true,"message":"moo","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":1,"createdAt":1589966425792,"queries":[{"query":"source:undefined","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"blop","condition":"a
      > 0"}],"type":"threshold","id":"dzq-ms4-dom","isDefault":true,"name":"test staged
      rule"},{"creationAuthorId":39468,"tags":["security:compliance","source:inventories"],"isEnabled":true,"hasExtendedTitle":false,"message":"Test","options":{"evaluationWindow":60,"maxSignalDuration":300,"keepAlive":300},"version":7,"createdAt":1590181326553,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule direction:ingress to_port:22","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":["@jose.castillo@datadoghq.com"],"name":"Fail","condition":"a
      > 1"}],"type":"threshold","id":"x4d-glb-08n","isDefault":false,"name":"TEST
      - JOSE - Trigger when ingress and port 22 - from tag fields"},{"creationAuthorId":39468,"tags":["security:compliance","aws","source:inventories"],"isEnabled":true,"hasExtendedTitle":true,"message":"TEST","options":{"evaluationWindow":60,"maxSignalDuration":60,"keepAlive":60},"version":5,"createdAt":1590181574487,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":["@jose.castillo@datadoghq.com"],"name":"Fail","condition":"a
      > 20"}],"type":"threshold","id":"4sk-qiq-neg","isDefault":false,"name":"TEST
      - JOSE - Capturing everything"},{"creationAuthorId":39468,"tags":["security:compliance","source:inventories"],"isEnabled":true,"hasExtendedTitle":false,"message":"Description:\nSecurity
      groups provide stateful filtering of ingress/egress network traffic to AWS resources.
      It is recommended that no security group allows unrestricted ingress access
      to port 22 .\n\nRationale:\nRemoving unfettered connectivity to remote console
      services, such as SSH, reduces a server''s exposure to risk.\n\nRemediation:\nPerform
      the following to implement the prescribed state:\n1. Login to the AWS Management
      Console at\nhttps://console.aws.amazon.com/vpc/home\n2. In the left pane, click
      Security Groups\n3. For each security group, perform the following:\n4. Select
      the security group\n5. Click the Inbound Rules tab\n6. Identify the rules to
      be removed\n7. Click the x in the Remove column\n8. Click Save\n\nCIS Controls:\n9.2
      Ensure Only Approved Ports, Protocols and Services Are Running\nEnsure that
      only network ports, protocols, and services listening on a system with validated
      business needs, are running on each system.","options":{"evaluationWindow":60,"maxSignalDuration":60,"keepAlive":60},"version":4,"createdAt":1590181901907,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule custom.resource_direction:ingress","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":["@jose.castillo@datadoghq.com"],"name":"Fail","condition":"a
      > 1"}],"type":"threshold","id":"17x-noa-dtd","isDefault":false,"name":"TEST
      - JOSE - Capturing fields under custom"},{"creationAuthorId":39468,"tags":["security:compliance","source:inventories"],"isEnabled":true,"hasExtendedTitle":false,"message":"Description:\nSecurity
      groups provide stateful filtering of ingress/egress network traffic to AWS resources.
      It is recommended that no security group allows unrestricted ingress access
      to port 22 .\n\nRationale:\nRemoving unfettered connectivity to remote console
      services, such as SSH, reduces a server''s exposure to risk.\n\nRemediation:\nPerform
      the following to implement the prescribed state:\n1. Login to the AWS Management
      Console at\nhttps://console.aws.amazon.com/vpc/home\n2. In the left pane, click
      Security Groups\n3. For each security group, perform the following:\n4. Select
      the security group\n5. Click the Inbound Rules tab\n6. Identify the rules to
      be removed\n7. Click the x in the Remove column\n8. Click Save\n\nCIS Controls:\n9.2
      Ensure Only Approved Ports, Protocols and Services Are Running\nEnsure that
      only network ports, protocols, and services listening on a system with validated
      business needs, are running on each system.","options":{"evaluationWindow":60,"maxSignalDuration":60,"keepAlive":60},"version":5,"createdAt":1590181967604,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":["@jose.castillo@datadoghq.com"],"name":"Fail","condition":"a
      > 1"}],"type":"threshold","id":"bnr-ykn-yao","isDefault":false,"name":"TEST
      - JOSE - Capturing fields top level"},{"creationAuthorId":39468,"tags":["security:compliance","source:inventories"],"isEnabled":true,"hasExtendedTitle":false,"message":"Description:\nSecurity
      groups provide stateful filtering of ingress/egress network traffic to AWS resources.
      It is recommended that no security group allows unrestricted ingress access
      to port 22 .\n\nRationale:\nRemoving unfettered connectivity to remote console
      services, such as SSH, reduces a server''s exposure to risk.\n\nRemediation:\nPerform
      the following to implement the prescribed state:\n1. Login to the AWS Management
      Console at\nhttps://console.aws.amazon.com/vpc/home\n2. In the left pane, click
      Security Groups\n3. For each security group, perform the following:\n4. Select
      the security group\n5. Click the Inbound Rules tab\n6. Identify the rules to
      be removed\n7. Click the x in the Remove column\n8. Click Save\n\nCIS Controls:\n9.2
      Ensure Only Approved Ports, Protocols and Services Are Running\nEnsure that
      only network ports, protocols, and services listening on a system with validated
      business needs, are running on each system.","options":{"evaluationWindow":60,"maxSignalDuration":60,"keepAlive":60},"version":4,"createdAt":1590182445624,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule direction:ingress","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":["@jose.castillo@datadoghq.com"],"name":"Fail","condition":"a
      > 1"}],"type":"threshold","id":"7u1-k6e-tzw","isDefault":false,"name":"TEST
      - JOSE - Capturing fields from tags"},{"creationAuthorId":39468,"tags":["security:compliance","source:inventories"],"isEnabled":true,"hasExtendedTitle":false,"message":"Test","options":{"evaluationWindow":60,"maxSignalDuration":60,"keepAlive":60},"version":4,"createdAt":1590431718859,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule @resource_direction:ingress @resource_to_port:22","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":["@jose.castillo@datadoghq.com"],"name":"Fail","condition":"a
      > 1"}],"type":"threshold","id":"e3x-r4d-5pa","isDefault":false,"name":"TEST
      - JOSE - Trigger when ingress and port 22 - resource prefix with @"},{"creationAuthorId":39468,"tags":["security:compliance","source:inventories"],"isEnabled":true,"hasExtendedTitle":false,"message":"Test","options":{"evaluationWindow":60,"maxSignalDuration":60,"keepAlive":60},"version":1,"createdAt":1590432245326,"queries":[{"query":"source:inventories
      @resource_type:aws_security_group_rule @resource_direction:ingress @resource_to_port:22","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":["@jose.castillo@datadoghq.com"],"name":"Fail","condition":"a
      > 1"}],"type":"threshold","id":"pfq-l0i-3ag","isDefault":false,"name":"TEST
      - JOSE - Trigger when ingress and port 22 - resource prefix and rtype attribute"},{"creationAuthorId":39468,"tags":["security:compliance","source:inventories"],"isEnabled":true,"hasExtendedTitle":false,"message":"Test","options":{"evaluationWindow":60,"maxSignalDuration":60,"keepAlive":60},"version":1,"createdAt":1590432417142,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:22","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":["@jose.castillo@datadoghq.com"],"name":"Fail","condition":"a
      > 1"}],"type":"threshold","id":"ef2-isa-ujn","isDefault":false,"name":"TEST
      - JOSE - Trigger when ingress and port 22 - resource prefix without @"},{"creationAuthorId":0,"tags":["security:compliance","control:blabla","framework:dsadsad"],"isEnabled":false,"hasExtendedTitle":true,"message":"##
      **Goal:**\nDetect when EBS encryption is disabled by default \n\n## **Strategy:**\nMonitor
      CloudTrail and detect when EBS encryption is disabled by default via the following
      API call:\n* [DisableEbsEncryptionByDefault](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DisableEbsEncryptionByDefault.html)\n\n##
      **Triage & Response:**\n1. Determine who the user was who made this API call.\n2.
      Contact the user and inform them of best practices to enable EBS encryption
      by default.\n3. Re-enable EBS encryption by default.\n\nMore details on Amazon
      EBS Encryption can be found [here](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html).","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":5,"createdAt":1590491153677,"queries":[{"query":"source:cloudtrail
      @evt.name:DisableEbsEncryptionByDefault","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 2"}],"type":"threshold","id":"qoq-l5r-bqc","isDefault":true,"name":"AWS
      EBS Default Encryption Disabled test 5"},{"creationAuthorId":39529,"tags":["security:compliance","framework:cis_aws","control:cis_aws-04","service:ec2","aws","source:inventories","level:1","rule:cis_aws-4.3"],"isEnabled":true,"hasExtendedTitle":false,"message":"XXX","options":{"evaluationWindow":300,"maxSignalDuration":1800,"keepAlive":900},"version":5,"createdAt":1590666751071,"queries":[{"query":"source:inventories  resource_type:aws_security_group_rule
      @resource_direction:(ingress OR egress)  @resource_security_group_name:default*","groupByFields":["@resource_group_id"],"name":"","distinctFields":[]},{"query":"source:inventories  resource_type:aws_security_group_rule  -@resource_direction:(ingress
      OR egress)   @resource_security_group_name:default*","groupByFields":["@resource_group_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"Fail","condition":"a>0"},{"status":"info","notifications":[],"name":"Pass","condition":"b>0"}],"type":"threshold","id":"ncq-3dt-sap","isDefault":false,"name":"[CIS
      AWS] 4.3 Ensure the default security group of every VPC restricts all traffic"},{"creationAuthorId":40247,"tags":["security:attack","tactic:TA0001-initial-access","technique:T1190-exploit-public-facing-application","source:nginx","scope:nginx"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when a web application is being scanned. This will identify attacker
      IP addresses who are not trying to hide their attempt to attack your system.
      More advanced hackers will use an inconspicuous user agent. \n\n### Strategy\nInspect
      the user agent in the HTTP headers to determine if an IP is scanning your application
      and generate an `INFO` signal. \n\n### Triage and Response\n1. Determine if
      this IP is making authenticated requests to the application.\n2. If the IP is
      making authenticated requests to the application:\n * Investigate the HTTP logs
      and determine if the user is attacking your application.\n\nThe HTTP headers
      in the query are from [darkqusar][1]''s [gist][2] \n\n[1]: https://gist.github.com/darkquasar\n[2]:
      https://gist.github.com/darkquasar/84fb2cec6cc1668795bd97c02302d380\n","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":1,"createdAt":1591703574272,"queries":[{"query":"source:nginx
      @network.client.ip:* @http.useragent:(\"burp\" OR \"burpcollaborator.net\" OR
      \"qualys\" OR \"nexpose\" OR \"OpenVAS\" OR \"Nikto\" OR \"Meterpreter\" OR
      \"IceWeasel\" OR \"DirB\" OR \"Comodo\" OR \"Tripwire\" OR \"Retina\" OR \"MBSA\"
      OR \"ImmuniWeb\" OR \"Netsparker\" OR \"Acunetix\" OR \"Intruder\" OR \"WinHttp.WinHttpRequest\"
      OR \"nmap\" OR \"CVE\" OR \"base64\" OR \"eval\" OR \"ftp\" OR \"script\" OR
      \"javascript\" OR \"alert\")","groupByFields":["@network.client.ip"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":["@slack-k9-testing-channel","@bernard.le@datadoghq.com"],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"zyh-njd-c6g","isDefault":false,"name":"Clone
      NGINX HTTP Requests from Security Scanner"},{"creationAuthorId":39006,"tags":[],"isEnabled":false,"hasExtendedTitle":true,"message":"Test
      very high cardinality","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":10,"createdAt":1591956331035,"queries":[{"query":"*","groupByFields":["message"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 1000000"}],"type":"threshold","id":"h6k-ihs-bxc","isDefault":false,"name":"PBR
      high card"},{"creationAuthorId":40250,"tags":[],"isEnabled":false,"hasExtendedTitle":true,"message":"this
      is a rule to test projections","options":{"evaluationWindow":600,"maxSignalDuration":86400,"keepAlive":3600},"version":12,"createdAt":1592223690200,"queries":[{"query":"source:matias-test  \"ABCYXC\"","groupByFields":["source"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"Case
      a","condition":"a > 15000"},{"status":"info","notifications":[],"name":"Case
      b","condition":"a > 5000"}],"type":"threshold","id":"ksf-cwt-lac","isDefault":false,"name":"matias-projections"},{"creationAuthorId":38857,"tags":["source:foobar"],"isEnabled":false,"hasExtendedTitle":true,"message":"Foobar","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1592254211174,"queries":[{"query":"status:foobar","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 500"}],"type":"threshold","id":"5ua-qgq-z8n","isDefault":false,"name":"Foobar"},{"creationAuthorId":7131,"tags":["source:synthetics"],"isEnabled":true,"hasExtendedTitle":true,"message":"test","options":{"evaluationWindow":600,"maxSignalDuration":86400,"keepAlive":3600},"version":2,"createdAt":1592401826260,"queries":[{"query":"service:(synthetics-check-runner
      OR synthetics-browser-check-runnner)   Request processed","groupByFields":["@org","@extraInfo.dnsResolvedAddress"],"name":"tests","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":[],"name":"Too
      many","condition":"tests > 10"}],"type":"threshold","id":"4pg-tus-wxb","isDefault":false,"name":"Synthetics
      DDOS"},{"creationAuthorId":40247,"tags":[],"isEnabled":true,"hasExtendedTitle":true,"message":"testy
      :) ","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":5,"createdAt":1592830041962,"queries":[{"query":"source:dogweb","groupByFields":[],"name":"a","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 3"}],"type":"threshold","id":"veq-mz0-xmx","isDefault":false,"name":"testy"},{"creationAuthorId":39119,"tags":["non_projected_tag","source:nginx"],"isEnabled":true,"hasExtendedTitle":true,"message":"Projection
      test MAZ","options":{"evaluationWindow":900,"maxSignalDuration":3600,"keepAlive":3600},"version":4,"createdAt":1593693036302,"queries":[{"query":"source:nginx","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":["@opsgenie","@webhook-marwen-test"],"name":"","condition":"a
      > 100"}],"type":"threshold","id":"ide-dra-add","isDefault":false,"name":"Projection
      test MAZ TITLE"},{"creationAuthorId":7346,"tags":[],"isEnabled":true,"hasExtendedTitle":true,"message":"Empty","options":{"evaluationWindow":60,"maxSignalDuration":300,"keepAlive":300},"version":9,"createdAt":1593804472953,"queries":[{"query":"service:k9_test_rule_based_view","groupByFields":["host","env"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":["@slack-k9-testing-channel"],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"vfi-5u8-29t","isDefault":false,"name":"Rule
      based view generated logs"},{"creationAuthorId":40250,"tags":[],"isEnabled":true,"hasExtendedTitle":true,"message":"copied
      from prod https://app.datadoghq.com/security/configuration/rules/edit/mhq-5g6-wpb","options":{"evaluationWindow":600,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594035055276,"queries":[{"query":"service:(synthetics-browser-check-runner
      OR synthetics-check-runner) \"request processed\"","groupByFields":["@org","@extraInfo.dnsResolvedAddress"],"name":"tests","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"critical","notifications":[],"name":"critical","condition":"tests
      > 15000"},{"status":"medium","notifications":[],"name":"medium","condition":"tests
      > 5000"}],"type":"threshold","id":"ag9-kc6-g5y","isDefault":false,"name":"[Projections]
      Too many Synthetics tests pointing to same IP"},{"creationAuthorId":40250,"tags":[],"isEnabled":true,"hasExtendedTitle":true,"message":"copied
      from prod https://app.datadoghq.com/security/configuration/rules/edit/ccc-a1a-633","options":{"evaluationWindow":300,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594035141336,"queries":[{"query":"service:mcnulty-web","groupByFields":["@rid"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 100"}],"type":"threshold","id":"soo-7mw-syd","isDefault":false,"name":"[Projections]
      high cardinality"},{"creationAuthorId":40250,"tags":[],"isEnabled":false,"hasExtendedTitle":true,"message":"testing
      stressing the reducer","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":4,"createdAt":1594122759321,"queries":[{"query":"*","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 15000"}],"type":"threshold","id":"h7l-rk7-mam","isDefault":false,"name":"matias-stress-test"},{"creationAuthorId":40247,"tags":["security:attack"],"isEnabled":false,"hasExtendedTitle":false,"message":"-
      [Rules Engine Error Logs](https://dd.datad0g.com/logs?saved_view=30657)\n- [Mapper
      Dashboard](https://dd.datad0g.com/dashboard/zyg-wt4-h3e)\n- [Reducer Dashboard](https://dd.datad0g.com/dashboard/qtu-r7r-jdc)","options":{"evaluationWindow":0,"maxSignalDuration":0,"keepAlive":0},"version":1,"createdAt":1594383541725,"queries":[{"query":"status:error","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@slack-k9-testing-channel"],"name":"rule-reducer","condition":"a
      > 0"}],"type":"threshold","id":"bxi-uxr-jsi","isDefault":false,"name":"The RULE
      ERROR"},{"creationAuthorId":40247,"tags":["security:attack"],"isEnabled":false,"hasExtendedTitle":false,"message":"-
      [Rules Engine Error Logs](https://dd.datad0g.com/logs?saved_view=30657)\n- [Mapper
      Dashboard](https://dd.datad0g.com/dashboard/zyg-wt4-h3e)\n- [Reducer Dashboard](https://dd.datad0g.com/dashboard/qtu-r7r-jdc)","options":{"evaluationWindow":0,"maxSignalDuration":0,"keepAlive":0},"version":1,"createdAt":1594384030056,"queries":[{"query":"status:error","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@slack-k9-testing-channel"],"name":"rule-reducer","condition":"a
      > 0"}],"type":"threshold","id":"nzf-tax-s1k","isDefault":false,"name":"The RULE
      ERROR 2"},{"creationAuthorId":7346,"tags":[],"isEnabled":true,"hasExtendedTitle":true,"message":"toto","options":{"evaluationWindow":60,"maxSignalDuration":60,"keepAlive":60},"version":7,"createdAt":1594384814048,"queries":[{"query":"*","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"hmf-in2-icf","isDefault":false,"name":"Test
      compliance track"},{"creationAuthorId":7346,"tags":[],"isEnabled":true,"hasExtendedTitle":true,"message":"Can
      catch either source:inventory or anything else","options":{"evaluationWindow":60,"maxSignalDuration":60,"keepAlive":60},"version":10,"createdAt":1594385157443,"queries":[{"query":"source:inventories","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"glg-gih-opw","isDefault":false,"name":"Test
      no track specified"},{"creationAuthorId":7346,"tags":[],"isEnabled":true,"hasExtendedTitle":true,"message":"toto","options":{"evaluationWindow":0,"maxSignalDuration":0,"keepAlive":0},"version":2,"createdAt":1594390232661,"queries":[{"query":"*","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"p6j-eff-wz0","isDefault":false,"name":"Test
      trace only track"},{"creationAuthorId":41031,"tags":["source:inventories"],"isEnabled":false,"hasExtendedTitle":true,"message":"Ensure
      that your AWS EC2 default security groups restrict all inbound public traffic
      in order to enforce AWS users (EC2 administrators, resource managers, etc) to
      create custom security groups that exercise the rule of least privilege instead
      of using the default security groups.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":4,"createdAt":1594394312328,"queries":[{"query":"source:inventories  resource_type:aws_security_group_rule    -@rule_description:*","groupByFields":["@resource_group_id"],"name":"","distinctFields":[]},{"query":"source:inventories  resource_type:aws_security_group_rule     @rule_description:*","groupByFields":["@resource_group_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"low","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a
      > 0"},{"status":"info","notifications":[],"name":"Pass","condition":"b > 0"}],"type":"threshold","id":"tiz-nhg-ede","isDefault":false,"name":"[PCI
      AWS] Ensure Security Group Rules have Human-Readable Descriptions"},{"creationAuthorId":41031,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for inbound rules that allow unrestricted access (i.e.
      0.0.0.0/0 or ::/0) to TCP and UDP port 53 and restrict access to only those
      IP addresses that require it in order to implement the principle of least privilege
      and reduce the possibility of a breach. TCP/UDP port 53 is used by the Domain
      Name Service during DNS resolution (DNS lookup), when the requests are sent
      from DNS clients to DNS servers or between DNS servers.\n\nThis rule can help
      you with the following compliance standards:\nPayment Card Industry Data Security
      Standard (PCI DSS)\nAPRA\nMAS\nNational Institute of Standards and Technology
      (NIST)\n\nThis rule can help you work with the AWS Well-Architected Framework\n\n##
      Remediation:\n### 1. First, Run revoke-security-group-ingress command (OSX/Linux/UNIX)
      to remove the inbound rule(s) that allow unrestricted access through TCP/UDP
      port 53, from the selected EC2 security group (the command does not return an
      output):\n\na. Remove the inbound rule that opens the TCP port 53:\n```\naws
      ec2 revoke-security-group-ingress\n\t--region us-east-1\n\t--group-name DNSServerSecurityGroup\n\t--protocol
      tcp\n\t--port 53\n\t--cidr 0.0.0.0/0\n```\n\nb. Remove the inbound rule that
      opens the UDP port 53:\n```\naws ec2 revoke-security-group-ingress\n\t--region
      us-east-1\n\t--group-name DNSServerSecurityGroup\n\t--protocol udp\n\t--port
      53\n\t--cidr 0.0.0.0/0\n```\n\n### 2. Run authorize-security-group-ingress command
      (OSX/Linux/UNIX) to add the inbound rules removed at the previous step with
      a different set of parameters in order to restrict DNS access to specific entities.
      To add custom inbound/ingress rules to the selected security group, use one
      of the following options (the command does not produce an output):\n\na. Add
      an inbound rule that allows DNS access to the specific static IP/Elastic IP
      address of the permitted host via port 53:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name DNSServerSecurityGroup\n\t--protocol tcp\n\t--port
      53\n\t--cidr 54.164.53.204/32\n```\n\nb. Add an inbound rule that allows DNS
      access to the IP address range of the permitted hosts via port 53:\n```\naws
      ec2 authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name DNSServerSecurityGroup\n\t--protocol
      tcp\n\t--port 53\n\t--cidr 54.164.53.204/24\n```\n\nc. Add an inbound rule that
      allows DNS access to another EC2 security group in the same AWS region via port
      53:\n```\naws ec2 authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name
      DNSServerSecurityGroup\n\t--protocol tcp\n\t--port 53\n\t--source-group MyWebAppSecurityGroup\n```\n\nd.
      Change the --protocol parameter value to udp and repeat steps a \u2013 c to
      add the required UDP inbound rule(s) removed at step no. 1.\n### 3. Repeat step
      no. 1 and 2 to update other EC2 security groups that allow unrestricted DNS
      access using AWS CLI.\n\n04Repeat steps no. 1 - 3 to implement the entire process
      for other AWS regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594395469698,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:53","groupByFields":["@resource_id"],"name":"","distinctFields":[]},{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:ALL","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0  ||
      b>0"}],"type":"threshold","id":"pcv-15g-0ne","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Inbound DNS Access"},{"creationAuthorId":41031,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for inbound rules that allow unrestricted access (i.e.
      0.0.0.0/0 or ::/0) to TCP port 9200 and restrict access to only those IP addresses
      that require it in order to implement the principle of least privilege and reduce
      the possibility of a breach. TCP port 9200 is used by the Elasticsearch: https://en.wikipedia.org/wiki/Elasticsearch\n\nThis
      rule can help you with the following compliance standards:\n\nPayment Card Industry
      Data Security Standard (PCI DSS)\nAPRA\nMAS\nNational Institute of Standards
      and Technology (NIST)\nThis rule can help you work with the AWS Well-Architected
      Framework\n\n## Remediation:\n### 1. First, run revoke-security-group-ingress
      command (OSX/Linux/UNIX) to remove the inbound rule(s) that allow unrestricted
      access through TCP port 9200, from the selected EC2 security group (the command
      does not return an output):\n```\naws ec2 revoke-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MyElasticsearchDBSecurityGroup\n\t--protocol tcp\n\t--port
      9200\n\t--cidr 0.0.0.0/0\n```\n### 2. Run authorize-security-group-ingress command
      (OSX/Linux/UNIX) to add the inbound rules removed at the previous step with
      a different set of parameters in order to restrict Elasticsearch access to specific
      entities. To add custom inbound/ingress rules to the selected security group,
      use one of the following options (the command does not produce an output):\nAdd
      an inbound rule that allows Elasticsearch access to the specific static IP/Elastic
      IP address of the permitted host via port 9200:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MyElasticsearchDBSecurityGroup\n\t--protocol tcp\n\t--port
      9200\n\t--cidr 54.164.53.221/32\n```\nAdd an inbound rule that allows Elasticsearch
      access to the IP address range of the permitted hosts via port 9200:\n```\naws
      ec2 authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name MyElasticsearchDBSecurityGroup\n\t--protocol
      tcp\n\t--port 9200\n\t--cidr 54.164.53.221/24\n```\nAdd an inbound rule that
      allows Elasticsearch access to another EC2 security group in the same AWS region
      via port 9200:\n```\naws ec2 authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name
      MyElasticsearchDBSecurityGroup\n\t--protocol tcp\n\t--port 9200\n\t--source-group
      MyWebAppSecurityGroup\n```\n### 3. Repeat step no. 1 and 2 to update other EC2
      security groups that allow unrestricted Elasticsearch access using AWS CLI.\n\n###
      4. Repeat steps no. 1 - 3 to implement the entire process for other AWS regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594395879884,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:9200","groupByFields":["@resource_id"],"name":"","distinctFields":[]},{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:ALL","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0  ||
      b>0"}],"type":"threshold","id":"ng8-hmm-x5f","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Inbound Elasticsearch Access"},{"creationAuthorId":41031,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for inbound rules that allow unrestricted access (i.e.
      0.0.0.0/0 or ::/0) to TCP ports 20 and 21 and restrict access to only those
      IP addresses that require it in order to implement the principle of least privilege
      and reduce the possibility of a breach. TCP ports 20 and 21 are used for data
      transfer and communication by the File Transfer Protocol (FTP) client-server
      applications: https://goo.gl/bBwI7t.\n\nThis rule can help you with the following
      compliance standards:\n\nPayment Card Industry Data Security Standard (PCI DSS)\nAPRA\nMAS\nNational
      Institute of Standards and Technology (NIST)\nThis rule can help you work with
      the AWS Well-Architected Framework\n\n## Remediation:\n### 1. First, run revoke-security-group-ingress
      command (OSX/Linux/UNIX) to remove the inbound rule(s) that allow unrestricted
      access through TCP ports 20 and 21, from the selected EC2 security group (the
      command does not return an output):\n\nRemove the inbound rule that opens the
      TCP port 20:\n```\naws ec2 revoke-security-group-ingress\n\t--region us-east-1\n\t--group-name
      MyWebEC2SecurityGroup\n\t--protocol tcp\n\t--port 20\n\t--cidr 0.0.0.0/0\n```\nRemove
      the inbound rule that opens the TCP port 21:\n```\naws ec2 revoke-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MyWebEC2SecurityGroup\n\t--protocol tcp\n\t--port
      21\n\t--cidr 0.0.0.0/0\n```\n### 2. Run authorize-security-group-ingress command
      (OSX/Linux/UNIX) to add the inbound rules removed at the previous step with
      a different set of parameters in order to restrict FTP access to specific entities.
      To add custom inbound/ingress rules to the selected security group, use one
      of the following options (the command does not produce an output):\n\nAdd an
      inbound rule that allows FTP access to the specific static IP/Elastic IP address
      of the permitted host via port 20:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MyWebEC2SecurityGroup\n\t--protocol tcp\n\t--port
      20\n\t--cidr 54.164.53.214/32\n```\nAdd an inbound rule that allows FTP access
      to the IP address range of the permitted hosts via port 20:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MyWebEC2SecurityGroup\n\t--protocol tcp\n\t--port
      20\n\t--cidr 54.164.53.214/24\n```\nAdd an inbound rule that allows FTP access
      to another EC2 security group in the same AWS region via port 20:\n```\naws
      ec2 authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name MyWebEC2SecurityGroup\n\t--protocol
      tcp\n\t--port 20\n\t--source-group MyWebAppSecurityGroup\n```\nChange the --port
      parameter value to 21 and repeat steps a \u2013 c to add the required inbound
      rule(s) removed at step no. 1.\n### 3. Repeat step no. 1 and 2 to update other
      EC2 security groups that allow unrestricted FTP access using AWS CLI.\n\n###
      4. Repeat steps no. 1 - 3 to implement the entire process for other AWS regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594396108960,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress  resource_to_port:20","groupByFields":["@resource_id"],"name":"","distinctFields":[]},{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:ALL","groupByFields":["@resource_id"],"name":"","distinctFields":[]},{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:21","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0  ||
      b>0 || c>0"}],"type":"threshold","id":"smk-ihn-hgo","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Inbound FTP Access"},{"creationAuthorId":41031,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for inbound rules that allow unrestricted access (i.e.
      0.0.0.0/0) to TCP port 443 and restrict access to only those IP addresses that
      require it in order to implement the principle of least privilege and reduce
      the possibility of a breach.\n\nThis rule can help you with the following compliance
      standards:\n\nPayment Card Industry Data Security Standard (PCI DSS)\nAPRA\nMAS\nNational
      Institute of Standards and Technology (NIST)\nThis rule can help you work with
      the AWS Well-Architected Framework\n\n## Remediation:\n### 1.Run describe-security-groups
      command (OSX/Linux/UNIX) using the necessary filters to expose the security
      groups that have ingress rules that allow HTTPS traffic (TCP port 443) from
      all addresses (0.0.0.0/0):\n```\naws ec2 describe-security-groups\n\t--region
      us-east-1\n\t--filters Name=ip-permission.from-port,Values=443 Name=ip-permission.to-port,Values=443
      Name=ip-permission.cidr,Values=''0.0.0.0/0''\n\t--query ''SecurityGroups[*].{Name:GroupName}''\n```\n###
      2. The command output should return an array with the requested information.
      If the command does not return any output, there are no EC2 security groups
      that allow unrestricted HTTPS access, otherwise it should return the name of
      the security group(s) that match filter criteria, as shown in the following
      example:\n```\n[\n    {\n        \"Name\": \"MyHTTPSDBSecurityGroup\"\n    }\n]\n```\n###
      3. Repeat step no. 1 and 2 to perform the audit process for other AWS regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594396266284,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:443","groupByFields":["@resource_id"],"name":"","distinctFields":[]},{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:ALL","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0  ||
      b>0"}],"type":"threshold","id":"4vg-sgj-wnt","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Inbound HTTPS Access"},{"creationAuthorId":41031,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for inbound rules that allow unrestricted access (i.e.
      0.0.0.0/0 or ::/0) to any hosts using ICMP and restrict access to only those
      IP addresses that require it in order to implement the principle of least privilege
      and reduce the possibility of a breach. Internet Control Message Protocol (ICMP)
      is an error-reporting protocol that is typically used to troubleshoot TCP/IP
      networks by generating error messages for any issues with delivering IP packets.
      Even if ICMP is not a transport protocol, it can be used to exploit network
      vulnerabilities.\n\nThis rule can help you with the following compliance standards:\n\nPayment
      Card Industry Data Security Standard (PCI DSS)\nAPRA\nMAS\nNational Institute
      of Standards and Technology (NIST)\nThis rule can help you work with the AWS
      Well-Architected Framework\n\n## Remediation:\n### 1. First, run revoke-security-group-ingress
      command (OSX/Linux/UNIX) to remove the inbound rule(s) that allow unrestricted
      ICMP access, from the selected EC2 security group. The following command example
      removes an inbound rule that allows the ICMP message \"Destination Unreachable\":
      Fragmentation Needed and Don''t Fragment was Set\" (Type 3, Code 4 - check for
      other ICMP types at http://goo.gl/YLSxxZ). (the command does not return an output):\n```\naws
      ec2 revoke-security-group-ingress\n\t--region us-east-1\n\t--group-name UbuntuServerSecurityGroup\n\t--ip-permissions
      ''[{\"IpProtocol\": \"icmp\", \"FromPort\": 3, \"ToPort\": 4, \"IpRanges\":
      [{\"CidrIp\": \"0.0.0.0/0\"}]}]''\n```\n### 2. Run authorize-security-group-ingress
      command (OSX/Linux/UNIX) to add the inbound rules removed at the previous step
      with a different set of parameters in order to restrict Internet Control Message
      Protocol (ICMP) access to specific entities. To add custom inbound/ingress rules
      to the selected security group, use one of the following options (the command
      does not produce an output):\n\nAdd an inbound rule that allows ICMP access
      to the specific static IP/Elastic IP address of the permitted host using ICMP
      Type 3, Code 4:\n```\naws ec2 authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name
      UbuntuServerSecurityGroup\n\t--ip-permissions ''[{\"IpProtocol\": \"icmp\",
      \"FromPort\": 3, \"ToPort\": 4, \"IpRanges\": [{\"CidrIp\": \"54.164.53.205/32\"}]}]''\n```\nAdd
      an inbound rule that allows ICMP access to the IP address range of the permitted
      hosts using ICMP Type 3, Code 4:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name UbuntuServerSecurityGroup\n\t--ip-permissions ''[{\"IpProtocol\":
      \"icmp\", \"FromPort\": 3, \"ToPort\": 4, \"IpRanges\": [{\"CidrIp\": \"54.164.53.205/24\"}]}]''\n```\nChange
      the FromPort (ICMP Type) and ToPort (ICMP Code) attributes values based on your
      requirements (check for the necessary ICMP types and their codes at http://goo.gl/YLSxxZ),
      then repeat steps a. and b. to add the required inbound rule(s) removed at step
      no. 1.\n### 3. Repeat step no. 1 and 2 to update other EC2 security groups that
      allow unrestricted ICMP access using AWS CLI.\n\n### 4. Repeat steps no. 1 -
      3 to implement the entire process for other AWS regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594396582286,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:ALL
      @resource_protocol:icmp","groupByFields":["@resource_id"],"name":"","distinctFields":[]},{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:ALL
      @resource_protocol:all","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0  ||
      b>0"}],"type":"threshold","id":"9cq-6q3-unb","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Inbound ICMP Access"},{"creationAuthorId":41031,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for inbound rules that allow unrestricted access (i.e.
      0.0.0.0/0 or ::/0) to TCP port 27017 and restrict access to only those IP addresses
      that require it in order to implement the principle of least privilege and reduce
      the possibility of a breach. TCP port 27017 is used by the MongoDB Database
      which is free and open-source cross-platform document-oriented NoSQL database\n\nThis
      rule can help you with the following compliance standards:\n\nPayment Card Industry
      Data Security Standard (PCI DSS)\nAPRA\nMAS\nNational Institute of Standards
      and Technology (NIST)\nThis rule can help you work with the AWS Well-Architected
      Framework\n\n## Remediation:\n### 1. First, run revoke-security-group-ingress
      command (OSX/Linux/UNIX) to remove the inbound rule(s) that allow unrestricted
      access through TCP port 27017, from the selected EC2 security group (the command
      does not return an output):\n```\naws ec2 revoke-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MyMongoDBDBSecurityGroup\n\t--protocol tcp\n\t--port
      27017\n\t--cidr 0.0.0.0/0\n```\n### 2. Run authorize-security-group-ingress
      command (OSX/Linux/UNIX) to add the inbound rules removed at the previous step
      with a different set of parameters in order to restrict MongoDB Database access
      to specific entities. To add custom inbound/ingress rules to the selected security
      group, use one of the following options (the command does not produce an output):\nAdd
      an inbound rule that allows MongoDB Database access to the specific static IP/Elastic
      IP address of the permitted host via port 27017:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MyMongoDBDBSecurityGroup\n\t--protocol tcp\n\t--port
      27017\n\t--cidr 54.164.53.221/32\n```\nAdd an inbound rule that allows MongoDB
      Database access to the IP address range of the permitted hosts via port 27017:\n```\naws
      ec2 authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name MyMongoDBDBSecurityGroup\n\t--protocol
      tcp\n\t--port 27017\n\t--cidr 54.164.53.221/24\n```\nAdd an inbound rule that
      allows MongoDB Database access to another EC2 security group in the same AWS
      region via port 27017:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MyMongoDBDBSecurityGroup\n\t--protocol tcp\n\t--port
      27017\n\t--source-group MyWebAppSecurityGroup\n```\n### 3. Repeat step no. 1
      and 2 to update other EC2 security groups that allow unrestricted MongoDB Database
      access using AWS CLI.\n\n### 4. Repeat steps no. 1 - 3 to implement the entire
      process for other AWS regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594408419410,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:27017","groupByFields":["@resource_id"],"name":"","distinctFields":[]},{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:ALL","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0  ||
      b>0"}],"type":"threshold","id":"3aa-4b0-tiu","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Inbound MongoDB Access"},{"creationAuthorId":41031,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for inbound rules that allow unrestricted access (i.e.
      0.0.0.0/0 or ::/0) to TCP port 1433 and restrict access to only those IP addresses
      that require it in order to implement the principle of least privilege and reduce
      the possibility of a breach. TCP port 1433 is used by the Microsoft SQL Server
      which is a relational database management system developed by Microsoft.\n\nThis
      rule can help you with the following compliance standards:\n\nPayment Card Industry
      Data Security Standard (PCI DSS)\nAPRA\nMAS\nNational Institute of Standards
      and Technology (NIST)\nThis rule can help you work with the AWS Well-Architected
      Framework\n\n## Remediation:\n### 1. First, run revoke-security-group-ingress
      command (OSX/Linux/UNIX) to remove the inbound rule(s) that allow unrestricted
      access through TCP port 1433, from the selected EC2 security group (the command
      does not return an output):\n```\naws ec2 revoke-security-group-ingress\n  --region
      us-east-1\n  --group-name MyMSServerSecurityGroup\n  --protocol tcp \n  --port
      1433 \n  --cidr 0.0.0.0/0\n```\n### 2. Run authorize-security-group-ingress
      command (OSX/Linux/UNIX) to add the inbound rules removed at the previous step
      with a different set of parameters in order to restrict MSSQL access to specific
      entities. To add custom inbound/ingress rules to the selected security group,
      use one of the following options (the command does not produce an output):\n\nAdd
      an inbound rule that allows MSSQL access to the specific static IP/Elastic IP
      address of the permitted host via port 1433:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MyMSServerSecurityGroup\n\t--protocol tcp\n\t--port
      1433\n\t--cidr 54.164.53.209/32\n```\nAdd an inbound rule that allows MSSQL
      access to the IP address range of the permitted hosts via port 1433:\n```\naws
      ec2 authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name MyMSServerSecurityGroup\n\t--protocol
      tcp\n\t--port 1433\n\t--cidr 54.164.53.209/24\n```\nAdd an inbound rule that
      allows MSSQL access to another EC2 security group in the same AWS region via
      port 1433:\n```\naws ec2 authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name
      MySQLServerSecurityGroup\n\t--protocol tcp\n\t--port 1433\n\t--source-group
      MyMSAppSecurityGroup\n```\n### 3. Repeat step no. 1 and 2 to update other EC2
      security groups that allow unrestricted MSSQL access using AWS CLI.\n\n### 4.
      Repeat steps no. 1 - 3 to implement the entire process for other AWS regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594409562653,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:1433","groupByFields":["@resource_id"],"name":"","distinctFields":[]},{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:ALL","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0  ||
      b>0"}],"type":"threshold","id":"qvt-xx2-hcq","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Inbound MSSQL Access"},{"creationAuthorId":41031,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for inbound rules that allow unrestricted access (i.e.
      0.0.0.0/0 or ::/0) to TCP port 3306 and restrict access to only those IP addresses
      that require it in order to implement the principle of least privilege and reduce
      the possibility of a breach. TCP port 3306 is used by the MySQL Server which
      is an open-source relational database management system (RDBMS) server.\n\nThis
      rule can help you with the following compliance standards:\n\nPayment Card Industry
      Data Security Standard (PCI DSS)\nAPRA\nMAS\nNational Institute of Standards
      and Technology (NIST)\nThis rule can help you work with the AWS Well-Architected
      Framework\n\n## Remediation:\n### 1. First, run revoke-security-group-ingress
      command (OSX/Linux/UNIX) to remove the inbound rule(s) that allow unrestricted
      access through TCP port 3306, from the selected EC2 security group (the command
      does not return an output):\n```\naws ec2 revoke-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MySQLServerSecurityGroup\n\t--protocol tcp\n\t--port
      3306\n\t--cidr 0.0.0.0/0\n```\n### 2. Run authorize-security-group-ingress command
      (OSX/Linux/UNIX) to add the inbound rules removed at the previous step with
      a different set of parameters in order to restrict MySQL access to specific
      entities. To add custom inbound/ingress rules to the selected security group,
      use one of the following options (the command does not produce an output):\n\nAdd
      an inbound rule that allows MySQL access to the specific static IP/Elastic IP
      address of the permitted host via port 3306:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MySQLServerSecurityGroup\n\t--protocol tcp\n\t--port
      3306\n\t--cidr 54.164.53.205/32\n```\nAdd an inbound rule that allows MySQL
      access to the IP address range of the permitted hosts via port 3306:\n```\naws
      ec2 authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name MySQLServerSecurityGroup\n\t--protocol
      tcp\n\t--port 3306\n\t--cidr 54.164.53.205/24\n```\nAdd an inbound rule that
      allows MySQL access to another EC2 security group in the same AWS region via
      port 3306:\n```\naws ec2 authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name
      MySQLServerSecurityGroup\n\t--protocol tcp\n\t--port 3306 \n\t--source-group
      MyWebAppSecurityGroup\n```\n### 3. Repeat step no. 1 and 2 to update other EC2
      security groups that allow unrestricted MySQL access using AWS CLI.\n\n### 4.
      Repeat steps no. 1 - 3 to implement the entire process for other AWS regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594409659050,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:3306","groupByFields":["@resource_id"],"name":"","distinctFields":[]},{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:ALL","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0  ||
      b>0"}],"type":"threshold","id":"xzt-wwa-f8e","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Inbound MySQL Access"},{"creationAuthorId":41031,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for inbound rules that allow unrestricted access (0.0.0.0/0
      or ::/0) to TCP port 139 and UDP ports 137 and 138 and restrict access to only
      those IP addresses that require it in order to implement the principle of least
      privilege and reduce the possibility of a breach. These ports are used for NetBIOS
      name resolution (i.e. mapping a NetBIOS name to an IP address) by services such
      as File and Printer Sharing service running on Microsoft Windows Server OS.\n\nThis
      rule can help you with the following compliance standards:\n\nPayment Card Industry
      Data Security Standard (PCI DSS)\nAPRA\nMAS\nNational Institute of Standards
      and Technology (NIST)\nThis rule can help you work with the AWS Well-Architected
      Framework\n\n## Remediation:\n### 1. First, run revoke-security-group-ingress
      command (OSX/Linux/UNIX) to remove the inbound rule(s) that allow unrestricted
      access through TCP port 139 and UDP ports 137 and 138, from the selected EC2
      security group (the command does not return an output):\n\nRemove the inbound
      rule that opens the TCP port 139:\n```\naws ec2 revoke-security-group-ingress\n\t--region
      us-east-1\n\t--group-name WindowsADSecurityGroup\n\t--protocol tcp\n\t--port
      139\n\t--cidr 0.0.0.0/0\n```\nRemove the inbound rule that opens the UDP port
      137:\n```\naws ec2 revoke-security-group-ingress\n\t--region us-east-1\n\t--group-name
      WindowsADSecurityGroup\n\t--protocol udp\n\t--port 137\n\t--cidr 0.0.0.0/0\n```\nRemove
      the inbound rule that opens the UDP port 138:\n```\naws ec2 revoke-security-group-ingress\n\t--region
      us-east-1\n\t--group-name WindowsADSecurityGroup\n\t--protocol udp\n\t--port
      138\n\t--cidr 0.0.0.0/0\n```\n### 2. Run authorize-security-group-ingress command
      (OSX/Linux/UNIX) to add the inbound rules removed at the previous step with
      a different set of parameters in order to restrict NetBIOS access to specific
      entities. To add custom inbound/ingress rules to the selected security group,
      use one of the following options (the command does not produce an output):\n\nAdd
      an inbound rule that allows NetBIOS access to the specific static IP/Elastic
      IP address of the permitted host via port 139:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name WindowsADSecurityGroup\n\t--protocol tcp\n\t--port
      139\n\t--cidr 54.164.53.250/32\n```\nAdd an inbound rule that allows NetBIOS
      access to the IP address range of the permitted hosts via port 139:\n```\naws
      ec2 authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name WindowsADSecurityGroup\n\t--protocol
      tcp\n\t--port 139\n\t--cidr 54.164.53.250/24\n```\nAdd an inbound rule that
      allows NetBIOS access to another EC2 security group in the same AWS region via
      port 139:\n```\naws ec2 authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name
      WindowsADSecurityGroup\n\t--protocol tcp\n\t--port 139\n\t--source-group MyMSAppSecurityGroup\n```\nChange
      the --protocol parameter value to udp and --port value to 137 and 138 respectively
      then repeat steps a \u2013 c to add the required UDP inbound rule(s) removed
      at step no. 1.\n### 3. Repeat step no. 1 and 2 to update other EC2 security
      groups that allow unrestricted NetBIOS access using AWS CLI.\n\n### 4. Repeat
      steps no. 1 - 3 to implement the entire process for other AWS regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594410158280,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress  resource_to_port:139
      @resource_protocol:tcp","groupByFields":["@resource_id"],"name":"","distinctFields":[]},{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress  @resource_protocol:udp
      (@resource_to_port:137 OR @resource_to_port:138)","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0  ||
      b>0"}],"type":"threshold","id":"zhj-eol-pks","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Inbound NetBIOS Access"},{"creationAuthorId":41031,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for inbound rules that allow unrestricted access (i.e.
      0.0.0.0/0 or ::/0) to TCP port 1521 and restrict access to only those IP addresses
      that require it in order to implement the principle of least privilege and reduce
      the possibility of a breach. TCP port 1521 is used by the Oracle Database Server
      which is an object-relational database management system (RDBMS) server developed
      by Oracle Corporation: https://en.wikipedia.org/wiki/Oracle_Database\n\nThis
      rule can help you with the following compliance standards:\n\nPayment Card Industry
      Data Security Standard (PCI DSS)\nAPRA\nMAS\nNational Institute of Standards
      and Technology (NIST)\nThis rule can help you work with the AWS Well-Architected
      Framework\n\n## Remediation:\n### 1. First, run revoke-security-group-ingress
      command (OSX/Linux/UNIX) to remove the inbound rule(s) that allow unrestricted
      access through TCP port 1521, from the selected EC2 security group (the command
      does not return an output):\n```\naws ec2 revoke-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MyOracleDBSecurityGroup\n\t--protocol tcp\n\t--port
      1521\n\t--cidr 0.0.0.0/0\n```\n### 2. Run authorize-security-group-ingress command
      (OSX/Linux/UNIX) to add the inbound rules removed at the previous step with
      a different set of parameters in order to restrict Oracle Database access to
      specific entities. To add custom inbound/ingress rules to the selected security
      group, use one of the following options (the command does not produce an output):\nAdd
      an inbound rule that allows Oracle Database access to the specific static IP/Elastic
      IP address of the permitted host via port 1521:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MyOracleDBSecurityGroup\n\t--protocol tcp\n\t--port
      1521\n\t--cidr 54.164.53.221/32\n```\nAdd an inbound rule that allows Oracle
      Database access to the IP address range of the permitted hosts via port 1521:\n```\naws
      ec2 authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name MyOracleDBSecurityGroup\n\t--protocol
      tcp\n\t--port 1521\n\t--cidr 54.164.53.221/24\n```\nAdd an inbound rule that
      allows Oracle Database access to another EC2 security group in the same AWS
      region via port 1521:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MyOracleDBSecurityGroup\n\t--protocol tcp\n\t--port
      1521\n\t--source-group MyWebAppSecurityGroup\n```\n### 3. Repeat step no. 1
      and 2 to update other EC2 security groups that allow unrestricted Oracle Database
      access using AWS CLI.\n\n### 4. Repeat steps no. 1 - 3 to implement the entire
      process for other AWS regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594410337138,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:1521
      (@resource_protocol:tcp OR @resource_protocol:all)","groupByFields":["@resource_id"],"name":"","distinctFields":[]},{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:ALL
      (@resource_protocol:tcp OR @resource_protocol:all)","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0  ||
      b>0"}],"type":"threshold","id":"epx-yu7-s3s","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Inbound Oracle Access"},{"creationAuthorId":41031,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws","control:pci_aws-01","subcontrol:pci_aws-1.1.4a"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for outbound rules that allow unrestricted access (i.e.
      0.0.0.0/0 or ::/0) to any TCP/UDP ports and restrict access to only those IP
      addresses that require it in order to implement the principle of least privilege
      and reduce the possibility of a breach.\n\nThis rule can help you with the following
      compliance standards:\n\nPayment Card Industry Data Security Standard (PCI DSS)\nHealth
      Insurance Portability and Accountability Act (HIPAA)\nAPRA\nMAS\nNational Institute
      of Standards and Technology (NIST)\nThis rule can help you work with the AWS
      Well-Architected Framework\n\n## Remediation\n\n### 1. First, run revoke-security-group-egress
      command (OSX/Linux/UNIX) to remove the outbound rule(s) that allow unrestricted
      access (0.0.0.0/0) from the selected EC2 security group. Set the --protocol
      parameter value to tcp or udp based on your needs (the command does not return
      an output):\n```\naws ec2 revoke-security-group-egress\n\t--region us-east-1\n\t--group-id
      sg-5008682b\n\t--ip-permissions ''[{\"IpProtocol\": \"tcp\", \"FromPort\": 443,
      \"ToPort\": 443, \"IpRanges\": [{\"CidrIp\": \"0.0.0.0/0\"}]}]''\n```\n### 2.
      Run authorize-security-group-egress command (OSX/Linux/UNIX) to add the egress
      rules removed at the previous step with a different set of parameters in order
      to restrict outbound access to specific destinations. To add custom outbound/egress
      rules to the selected security group, use one of the following options (the
      command does not produce an output):\n\nAdd an outbound rule that allows access
      only to the IP address range of the permitted hosts:\n```\naws ec2 authorize-security-group-egress\n--region
      us-east-1\n--group-id sg-5008682b\n--ip-permissions ''[{\"IpProtocol\": \"tcp\",
      \"FromPort\": 443, \"ToPort\": 443, \"IpRanges\": [{\"CidrIp\": \"56.160.52.238/24\"}]}]''\n```\nAdd
      an outbound rule that allows access only to another EC2 security group in the
      same AWS region:\n```\naws ec2 authorize-security-group-egress\n\t--region us-east-1\n\t--group-id
      sg-5008682b\n\t--ip-permissions ''[{\"IpProtocol\": \"tcp\", \"FromPort\": 443,
      \"ToPort\": 443, \"UserIdGroupPairs\": [{\"GroupId\": \"sg-960167ed\"}]}]''\n```\n###
      3. Change the IpProtocol, FromPort/ToPort and/or CidrIp/UserIdGroupPairs parameters
      value based on your access requirements and repeat step no. 1 and 2 to update
      any other EC2 security groups that allow unrestricted outbound access, using
      AWS CLI.\n\n### 4. Repeat steps no. 1 - 3 to implement the entire process for
      other AWS regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594410774132,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:egress resource_to_port:ALL
      (ip_range:\"0.0.0.0/0\" OR ip_range:\"::/0\")","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0"}],"type":"threshold","id":"yem-bvg-pfi","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Outbound Access on All Ports"},{"creationAuthorId":41031,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for inbound rules that allow unrestricted access (i.e.
      0.0.0.0/0 or ::/0) to TCP port 5432 and restrict access to only those IP addresses
      that require it in order to implement the principle of least privilege and reduce
      the possibility of a breach. TCP port 5432 is used by the PostgreSQL Database
      Server which is an object-relational database management system (RDBMS) server
      developed by PostgreSQL Global Development Group: https://goo.gl/PNbEY.\n\nThis
      rule can help you with the following compliance standards:\n\nPayment Card Industry
      Data Security Standard (PCI DSS)\nAPRA\nMAS\nNational Institute of Standards
      and Technology (NIST)\nThis rule can help you work with the AWS Well-Architected
      Framework\n\n## Remediation:\n### 1. First, run revoke-security-group-ingress
      command (OSX/Linux/UNIX) to remove the inbound rule(s) that allow unrestricted
      access through TCP port 5432, from the selected EC2 security group (the command
      does not return an output):\n```\naws ec2 revoke-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MyPostgresSecurityGroup\n\t--protocol tcp\n\t--port
      5432\n\t--cidr 0.0.0.0/0\n```\n### 2. Run authorize-security-group-ingress command
      (OSX/Linux/UNIX) to add the inbound rules removed at the previous step with
      a different set of parameters in order to restrict PostgreSQL Database access
      to specific entities. To add custom inbound/ingress rules to the selected security
      group, use one of the following options (the command does not produce an output):\n\nAdd
      an inbound rule that allows PostgreSQL Database access to the specific static
      IP/Elastic IP address of the permitted host via port 5432:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MyPostgresSecurityGroup\n\t--protocol tcp\n\t--port
      5432\n\t--cidr 54.164.53.232/32\n```\nAdd an inbound rule that allows PostgreSQL
      Database access to the IP address range of the permitted hosts via port 5432:\n```\naws
      ec2 authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name MyPostgresSecurityGroup\n\t--protocol
      tcp\n\t--port 5432\n\t--cidr 54.164.53.232/24\n```\nAdd an inbound rule that
      allows PostgreSQL Database access to another EC2 security group in the same
      AWS region via port 5432:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MyWebEC2SecurityGroup\n\t--protocol tcp\n\t--port
      5432\n\t--source-group MyWebAppSecurityGroup\n```\n### 3. Repeat step no. 1
      and 2 to update other EC2 security groups that allow unrestricted PostgreSQL
      Database access using AWS CLI.\n\n### 4. Repeat steps no. 1 - 3 to implement
      the entire process for other AWS regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594411199485,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:5432
      (ip_range:\"0.0.0.0/0\" OR ip_range:\"::/0\") (@resource_protocol:tcp OR @resource_protocol:ALL)","groupByFields":["@resource_id"],"name":"","distinctFields":[]},{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress resource_to_port:ALL","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0  ||
      b>0"}],"type":"threshold","id":"fbv-rdd-5gr","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Inbound PostgreSQL Access"},{"creationAuthorId":41031,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for inbound rules that allow unrestricted access (i.e.
      0.0.0.0/0 or ::/0) to TCP port 3389 and restrict access to only those IP addresses
      that require it in order to implement the principle of least privilege and reduce
      the possibility of a breach. TCP port 3389 is used for secure remote GUI login
      to Microsoft servers by connecting an RDP (Remote Desktop Protocol) client application
      with an RDP server: https://en.wikipedia.org/wiki/Remote_Desktop_Protocol.\n\nThis
      rule can help you with the following compliance standards:\n\nThe Center of
      Internet Security AWS Foundations Benchmark\nPayment Card Industry Data Security
      Standard (PCI DSS)\nAPRA\nMAS\nNational Institute of Standards and Technology
      (NIST)\nThis rule can help you work with the AWS Well-Architected Framework\n\n##
      Remediation:\n### 1. First, run revoke-security-group-ingress command (OSX/Linux/UNIX)
      to remove the inbound rule(s) that allow unrestricted access through TCP port
      3389, from the selected EC2 security group (the command does not return an output):\n```\naws
      ec2 revoke-security-group-ingress\n\t--region us-east-1\n\t--group-name MyMSAppServerSecurityGroup\n\t--protocol
      tcp\n\t--port 3389\n\t--cidr 0.0.0.0/0\n```\n### 2. Run authorize-security-group-ingress
      command (OSX/Linux/UNIX) to add the inbound rules removed at the previous step
      with a different set of parameters in order to restrict RDP access to specific
      entities. To add custom inbound/ingress rules to the selected security group,
      use one of the following options (the command does not produce an output):\n\nAdd
      an inbound rule that allows RDP access to the specific static IP/Elastic IP
      address of the permitted host via port 3389:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MyMSAppServerSecurityGroup\n\t--protocol tcp\n\t--port
      3389\n\t--cidr 54.164.53.105/32\n```\nAdd an inbound rule that allows RDP access
      to the IP address range of the permitted hosts via port 3389:\n```\naws ec2
      authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name MyMSAppServerSecurityGroup\n\t--protocol
      tcp\n\t--port 3389\n\t--cidr 54.164.53.105/24\n```\nAdd an inbound rule that
      allows RDP access to another EC2 security group in the same AWS region via port
      3389:\n```\naws ec2 authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name
      MyMSAppServerSecurityGroup\n\t--protocol tcp\n\t--port 3389\n\t--source-group
      MyWebAppSecurityGroup\n```\n### 3. Repeat step no. 1 and 2 to update other EC2
      security groups that allow unrestricted RDP access using AWS CLI.\n\n### 4.
      Repeat steps no. 1 - 3 to implement the entire process for other AWS regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594412059697,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress  resource_to_port:3389
      (@resource_protocol:tcp OR @resource_protocol:all)","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0"}],"type":"threshold","id":"0gp-iwl-etj","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Inbound RDP Access"},{"creationAuthorId":41031,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for inbound rules that allow unrestricted access (i.e.
      0.0.0.0/0 or ::/0) to TCP port 135 and restrict access to only those IP addresses
      that require it in order to implement the principle of least privilege and reduce
      the possibility of a breach. Remote Procedure Call (RPC) port 135 is used for
      client/server communication by Microsoft Message Queuing (MSMQ): https://goo.gl/GycDGi
      as well as other Microsoft Windows/Windows Server software.\n\nThis rule can
      help you with the following compliance standards:\n\nPayment Card Industry Data
      Security Standard (PCI DSS)\nAPRA\nMAS\nNational Institute of Standards and
      Technology (NIST)\nThis rule can help you work with the AWS Well-Architected
      Framework\n\n## Remediation:\n### 1. First, run revoke-security-group-ingress
      command (OSX/Linux/UNIX) to remove the inbound rule(s) that allow unrestricted
      access through TCP port 135, from the selected EC2 security group (the command
      does not return an output):\n```\naws ec2 revoke-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MSServerSecurityGroup\n\t--protocol tcp\n\t--port
      135\n\t--cidr 0.0.0.0/0\n```\n### 2. Run authorize-security-group-ingress command
      (OSX/Linux/UNIX) to add the inbound rules removed at the previous step with
      a different set of parameters in order to restrict Remote Procedure Call (RPC)
      access to specific entities. To add custom inbound/ingress rules to the selected
      security group, use one of the following options (the command does not produce
      an output):\nAdd an inbound rule that allows RPC access to the specific static
      IP/Elastic IP address of the permitted host via port 135:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MSServerSecurityGroup\n\t--protocol tcp\n\t--port
      135\n\t--cidr 54.164.53.205/32\n```\nAdd an inbound rule that allows RPC access
      to the IP address range of the permitted hosts via port 135:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MSServerSecurityGroup\n\t--protocol tcp\n\t--port
      135\n\t--cidr 54.164.53.205/24\n```\nAdd an inbound rule that allows RPC access
      to another EC2 security group in the same AWS region via port 135:\n```\naws
      ec2 authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name MSServerSecurityGroup\n\t--protocol
      tcp\n\t--port 135\n\t--source-group MyWebAppSecurityGroup\n```\n### 3. Repeat
      step no. 1 and 2 to update other EC2 security groups that allow unrestricted
      RPC access using AWS CLI.\n\n### 4. Repeat steps no. 1 - 3 to implement the
      entire process for other AWS regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594412582139,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress  resource_to_port:135
      (@resource_protocol:tcp OR @resource_protocol:all)","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0"}],"type":"threshold","id":"doz-zu8-hfo","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Inbound RPC Access"},{"creationAuthorId":41031,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for inbound rules that allow unrestricted access (i.e.
      0.0.0.0/0 or ::/0) to TCP port 25 and restrict access to only those IP addresses
      that require it in order to implement the principle of least privilege and reduce
      the possibility of a breach. TCP port 25 is used by SMTP (Simple Mail Transfer
      Protocol) servers for electronic mail (email) transmission: https://goo.gl/bnjFP.\n\nThis
      rule can help you with the following compliance standards:\n\nPayment Card Industry
      Data Security Standard (PCI DSS)\nAPRA\nMAS\nNational Institute of Standards
      and Technology (NIST)\nThis rule can help you work with the AWS Well-Architected
      Framework\n\n## Remediation:\n### 1. First, run revoke-security-group-ingress
      command (OSX/Linux/UNIX) to remove the inbound rule(s) that allow unrestricted
      access through TCP port 25, from the selected EC2 security group (the command
      does not return an output):\n```\naws ec2 revoke-security-group-ingress\n\t--region
      us-east-1\n\t--group-name SMTPServerSecurityGroup\n\t--protocol tcp\n\t--port
      25\n\t--cidr 0.0.0.0/0\n```\n### 2. Run authorize-security-group-ingress command
      (OSX/Linux/UNIX) to add the inbound rules removed at the previous step with
      a different set of parameters in order to restrict SMTP access to specific entities.
      To add custom inbound/ingress rules to the selected security group, use one
      of the following options (the command does not produce an output):\n\nAdd an
      inbound rule that allows SMTP access to the specific static IP/Elastic IP address
      of the permitted host via port 25:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name SMTPServerSecurityGroup\n\t--protocol tcp\n\t--port
      25\n\t--cidr 54.164.53.56/32\n```\nAdd an inbound rule that allows SMTP access
      to the IP address range of the permitted hosts via port 25:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name SMTPServerSecurityGroup\n\t--protocol tcp\n\t--port
      25\n\t--cidr 54.164.53.56/24\n```\nAdd an inbound rule that allows SMTP access
      to another EC2 security group in the same AWS region via port 25:\n```\naws
      ec2 authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name SMTPServerSecurityGroup\n\t--protocol
      tcp\n\t--port 25\n\t--source-group MyWebAppSecurityGroup\n```\n### 3. Repeat
      step no. 1 and 2 to update other EC2 security groups that allow unrestricted
      SMTP access using AWS CLI.\n\n### 4. Repeat steps no. 1 - 3 to implement the
      entire process for other AWS regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594412872552,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress  resource_to_port:25
      (@resource_protocol:tcp OR @resource_protocol:all) (resource_ip_range:\"0.0.0.0/0\"
      OR resource_ip_range:\"::/0\")","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0"}],"type":"threshold","id":"sez-bnj-qow","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Inbound SMTP Access"},{"creationAuthorId":41031,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Check
      your EC2 security groups for inbound rules that allow unrestricted access (i.e.
      0.0.0.0/0 or ::/0) to TCP port 23 and restrict access to only those IP addresses
      that require it in order to implement the principle of least privilege and reduce
      the possibility of a breach. TCP port 23 is used by the Telnet server application
      (telnetd). Telnet is usually used to check whether a client is able to make
      TCP/IP connections to a particular service: https://goo.gl/r4tbwi\n\nThis rule
      can help you with the following compliance standards:\n\nPayment Card Industry
      Data Security Standard (PCI DSS)\nAPRA\nMAS\nNational Institute of Standards
      and Technology (NIST)\nThis rule can help you work with the AWS Well-Architected
      Framework\n\n## Remediation:\n### 1. First, run revoke-security-group-ingress
      command (OSX/Linux/UNIX) to remove the inbound rule(s) that allow unrestricted
      access through TCP port 23, from the selected EC2 security group (the command
      does not return an output):\n```\naws ec2 revoke-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MyWebEC2SecurityGroup\n\t--protocol tcp\n\t--port
      23\n\t--cidr 0.0.0.0/0\n```\n### 2. Run authorize-security-group-ingress command
      (OSX/Linux/UNIX) to add the inbound rules removed at the previous step with
      a different set of parameters in order to restrict Telnet access to specific
      entities. To add custom inbound/ingress rules to the selected security group,
      use one of the following options (the command does not produce an output):\n\nAdd
      an inbound rule that allows Telnet access to the specific static IP/Elastic
      IP address of the permitted host via port 23:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MyWebEC2SecurityGroup\n\t--protocol tcp\n\t--port
      23\n\t--cidr 54.164.53.109/32\n```\nAdd an inbound rule that allows Telnet access
      to the IP address range of the permitted hosts via port 23:\n```\naws ec2 authorize-security-group-ingress\n\t--region
      us-east-1\n\t--group-name MyWebEC2SecurityGroup\n\t--protocol tcp\n\t--port
      23\n\t--cidr 54.164.53.109/24\n```\nAdd an inbound rule that allows Telnet access
      to another EC2 security group in the same AWS region via port 23:\n```\naws
      ec2 authorize-security-group-ingress\n\t--region us-east-1\n\t--group-name MyWebEC2SecurityGroup\n\t--protocol
      tcp\n\t--port 23\n\t--source-group MyWebAppSecurityGroup\n```\n### 3. Repeat
      step no. 1 and 2 to update other EC2 security groups that allow unrestricted
      Telnet access using AWS CLI.\n\n### 4. Repeat steps no. 1 - 3 to implement the
      entire process for other AWS regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594412984025,"queries":[{"query":"source:inventories
      resource_type:aws_security_group_rule resource_direction:ingress  resource_to_port:23
      (@resource_protocol:tcp OR @resource_protocol:all) (resource_ip_range:\"0.0.0.0/0\"
      OR resource_ip_range:\"::/0\")","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0"}],"type":"threshold","id":"pvb-u6j-0dj","isDefault":false,"name":"[PCI
      AWS] Security Group With Unrestricted Inbound Telnet Access"},{"creationAuthorId":41031,"tags":["security:compliance","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Ensure
      that your ElastiCache clusters are provisioned within the AWS EC2-VPC platform
      instead of EC2-Classic platform (outdated from 2013-12-04) for better flexibility
      and control over the cache clusters security, availability, traffic routing
      and more\n\nThis rule can help you with the following compliance standards:\n\nPayment
      Card Industry Data Security Standard (PCI DSS)\nAPRA\nMAS\nNational Institute
      of Standards and Technology (NIST)\nThis rule can help you work with the AWS
      Well-Architected Framework\n\n## Remediation:\n\n### 1. First, run create-vpc
      command (OSX/Linux/UNIX) to create the new Virtual Private Cloud (VPC) where
      the ElastiCache cluster will be re-created. The following command example creates
      a shared tenancy VPC with the CIDR block 10.0.0.0/16:\n```\naws ec2 create-vpc\n    --region
      us-east-1\n    --cidr-block 10.0.0.0/16\n```\n### 2. The command output should
      return the new VPC metadata (including the VPC ID):\n```\n\n{\n    \"Vpc\":
      {\n        \"VpcId\": \"vpc-ca27e381\",\n        \"InstanceTenancy\": \"default\",\n        \"State\":
      \"pending\",\n        \"DhcpOptionsId\": \"dopt-e5d918f5\",\n        \"CidrBlock\":
      \"10.0.0.0/16\",\n        \"IsDefault\": false\n    }\n}\n```\n### 3. Run create-internet-gateway
      command (OSX/Linux/UNIX) to create an AWS Internet Gateway for use with the
      newly created VPC (required):\n```\naws ec2 create-internet-gateway\n    --region
      us-east-1\n04The command output should return the Internet Gateway metadata
      (including its ID):\n\n{\n    \"InternetGateway\": {\n        \"Tags\": [],\n        \"InternetGatewayId\":
      \"igw-506a0b24\",\n        \"Attachments\": []\n    }\n}\n```\n### 5. Run attach-internet-gateway
      command (OSX/Linux/UNIX) to attach the new Internet Gateway to your VPC created
      at step no. 3 (the command does not produce an output):\n```\naws ec2 attach-internet-gateway\n    --region
      us-east-1\n    --internet-gateway-id igw-506a0b24\n    --vpc-id vpc-ca27e381\n```\n###
      6. Now run create-subnet command (OSX/Linux/UNIX) to set up a subnet for the
      existing VPC. The cache cluster will be launched within this subnet (required):\n```\naws
      ec2 create-subnet\n    --region us-east-1\n    --vpc-id vpc-ca27e381\n    --cidr-block
      10.0.1.0/24\n```\n### 7. The command output should return the subnet metadata
      (including the subnet ID):\n```\n{\n    \"Subnet\": {\n        \"VpcId\": \"vpc-ca27e381\",\n        \"CidrBlock\":
      \"10.0.1.0/24\",\n        \"State\": \"pending\",\n        \"AvailabilityZone\":
      \"us-east-1a\",\n        \"SubnetId\": \"subnet-da296f89\",\n        \"AvailableIpAddressCount\":
      251\n    }\n}\n```\n### 8. Run create-route-table command (OSX/Linux/UNIX) to
      create a route table for your new VPC (required):\n```\naws ec2 create-route-table\n    --region
      us-east-1\n    --vpc-id vpc-ca27e381\n```\n### 9. The command output should
      return the VPC route table metadata (including its ID - highlighted):\n```\n{\n    \"RouteTable\":
      {\n        \"Associations\": [],\n        \"RouteTableId\": \"rtb-50611442\",\n        \"VpcId\":
      \"vpc-ca27e381\",\n        \"PropagatingVgws\": [],\n        \"Tags\": [],\n        \"Routes\":
      [\n            {\n                \"GatewayId\": \"local\",\n                \"DestinationCidrBlock\":
      \"10.0.0.0/16\",\n                \"State\": \"active\",\n                \"Origin\":
      \"CreateRouteTable\"\n            }\n        ]\n    }\n}\n```\n### 10. Run associate-route-table
      command (OSX/Linux/UNIX) to associate the VPC subnet created at step no. 6 with
      the new route table (required):\n```\naws ec2 associate-route-table\n  --region
      us-east-1\n  --route-table-id rtb-50611442\n  --subnet-id subnet-da296f89\n```\n###
      11. The command output should return the VPC route table association ID:\n```\n{\n    \"AssociationId\":
      \"rtbassoc-a3f461e1\"\n}\n```\n### 12. Run create-route command (OSX/Linux/UNIX)
      to add a new route within the VPC route table installed earlier (required):\n```\naws
      ec2 create-route\n  --region us-east-1\n  --route-table-id rtb-50611442\n  --destination-cidr-block
      0.0.0.0/0\n  --gateway-id igw-506a0b24\n```\n### 13. The command output should
      return the status of request (true for success, an error message if the request
      fails):\n```\n{\n    \"Return\": true\n}\n```\n### 14. Now that your VPC is
      ready, you need to create the necessary security group for the new cluster.
      To set up the VPC security group, perform the following:\n\nRun create-security-group
      command (OSX/Linux/UNIX) to create a security group within the VPC created at
      step no. 1. The following command example creates a security group called ElastiCacheSecurityGroup
      inside the VPC identified with the ID vpc-ca27e381, within the US East AWS region:\n```\naws
      ec2 create-security-group\n  --region us-east-1\n  --group-name ElastiCacheSecurityGroup\n  --description
      \"Redis Cache Cluster Security Group\"\n  --vpc-id vpc-ca27e381\n```\nThe command
      output should return the new security group ID:\n```\n{\n    \"GroupId\": \"sg-f29492e0\"\n}\n```\nRun
      authorize-security-group-ingress command (OSX/Linux/UNIX) to add one or more
      inbound rules to the security group created at the previous step (no command
      output is returned):\n```\naws ec2 authorize-security-group-ingress\n  --region
      us-east-1\n  --group-id sg-f29492e0\n  --protocol tcp\n  --port 6379\n  --cidr
      53.165.46.104/32\n```\n### 15. Now gather the configuration details from the
      existing EC2-Classic ElastiCache cluster, details required for the next step
      (i.e. cache cluster relaunch). Run describe-cache-clusters command (OSX/Linux/UNIX)
      using the ID of the cluster that you want to re-create (see Audit section part
      II to identify the right resource) to describe the selected cluster configuration
      details:\n```\naws elasticache describe-cache-clusters\n  --region us-east-1\n  --cache-cluster-id
      webcachecluster1\n```\n### 16. The command output should return the EC2-Classic
      cache cluster configuration metadata:\n```\n{\n    \"CacheClusters\": [\n        {\n            \"Engine\":
      \"redis\",\n            \"CacheClusterId\": \"webcachecluster1\",\n            \"NumCacheNodes\":
      2,\n            \"CacheClusterCreateTime\": \"2013-01-30T09:25:26.712Z\",\n            \"AutoMinorVersionUpgrade\":
      true,\n            \"CacheClusterStatus\": \"available\",\n            \"PreferredAvailabilityZone\":
      \"us-east-1a\",\n\n            ...\n\n            \"CachePort\": 6379,\n            \"CacheSubnetGroupName\":
      \"\",\n            \"EngineVersion\": \"2.6.13\",\n            \"PendingModifiedValues\":
      {},\n            \"PreferredMaintenanceWindow\": \"sat:03:00-sat:04:00\",\n            \"CacheNodeType\":
      \"cache.m3.medium\"\n        }\n    ]\n}\n```\n### 17. Re-create your EC2-Classic
      cache cluster within the AWS VPC deployed at step no. 1 with create-cache-cluster
      command (OSX/Linux/UNIX), using the existing ElastiCache cluster configuration
      attributes returned at the previous step:\n```\naws elasticache create-cache-cluster\n  --region
      us-east-1\n  --cache-cluster-id vpccachecluster\n  --az-mode single-az\n  --preferred-availability-zone
      \"us-east-1a\"\n  --num-cache-nodes 2\n  --cache-node-type cache.m3.medium\n  --engine
      redis\n  --engine-version \"2.6.13\"\n  --security-group-ids \"sg-f29492e0\"\n  --port
      6379\n  --auto-minor-version-upgrade\n```\n### 18. The command output should
      return the newly created EC2-VPC cache cluster metadata:\n```\n{\n    \"CacheCluster\":
      {\n        \"Engine\": \"redis\",\n        \"CacheParameterGroup\": {\n            \"CacheNodeIdsToReboot\":
      [],\n            \"CacheParameterGroupName\": \"default.redis2.6\",\n            \"ParameterApplyStatus\":
      \"in-sync\"\n        },\n        \"CacheClusterId\": \"vpccachecluster\",\n        \"CacheSecurityGroups\":
      [],\n        \"NumCacheNodes\": 2,\n        \"AutoMinorVersionUpgrade\": true,\n        \"CacheClusterStatus\":
      \"creating\",\n        \"PreferredAvailabilityZone\": \"us-east-1a\",\n\n        ...\n\n        \"SecurityGroups\":
      [\n            {\n                \"Status\": \"active\",\n                \"SecurityGroupId\":
      \"sg-f29492e0\"\n            }\n        ],\n        \"CacheSubnetGroupName\":
      \"default\",\n        \"EngineVersion\": \"2.6.13\",\n        \"PendingModifiedValues\":
      {},\n        \"PreferredMaintenanceWindow\": \"tue:03:30-tue:04:30\",\n        \"CacheNodeType\":
      \"cache.m3.medium\"\n    }\n}\n```\n### 19. Once the EC2-Classic cluster endpoint
      have been replaced with the EC2-VPC one (e.g. webcachecluster1.rybucx.ng.0002.use1.cache.amazonaws.com),
      it is safe to shut down and delete the old cache cluster to stop incurring charges
      for the resource. To remove the EC2-Classic ElastiCache cluster from your AWS
      account, run delete-cache-cluster command (OSX/Linux/UNIX):\n```\naws elasticache
      delete-cache-cluster\n  --region us-east-1\n  --cache-cluster-id webcachecluster1\n  --final-snapshot-identifier
      webcachecluster1-final-snapshot\n```\n### 20. The command output should return
      the old cache cluster metadata (including the resource current status, i.e.
      \"deleting\"):\n```\n{\n    \"CacheClusters\": [\n        {\n            \"Engine\":
      \"redis\",\n            \"CacheClusterId\": \"webcachecluster1\",\n            \"NumCacheNodes\":
      2,\n            \"CacheClusterCreateTime\": \"2013-01-30T09:25:26.712Z\",\n            \"AutoMinorVersionUpgrade\":
      true,\n            \"CacheClusterStatus\": \"deleting\",\n\n            ...\n\n            \"CachePort\":
      6379,\n            \"CacheSubnetGroupName\": \"\",\n            \"EngineVersion\":
      \"2.6.13\",\n            \"PendingModifiedValues\": {},\n            \"PreferredMaintenanceWindow\":
      \"sat:03:00-sat:04:00\",\n            \"CacheNodeType\": \"cache.m3.medium\"\n        }\n    ]\n}\n```","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594745219740,"queries":[{"query":"source:inventories
      resource_type:aws_elasticache   resource_cache_subnet_group_name:\"\"","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0"}],"type":"threshold","id":"0wj-qzc-wjp","isDefault":false,"name":"[PCI
      AWS] ElastiCache Cluster In VPC"},{"creationAuthorId":41031,"tags":["security:compliance","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Ensure
      Version Upgrade is enabled for Redshift clusters to automatically receive upgrades
      during the maintenance window.\n\nThis rule can help you with the following
      compliance standards:\n\nPayment Card Industry Data Security Standard (PCI DSS)\nAPRA\nMAS\nNational
      Institute of Standards and Technology (NIST)\n\n## Remediation:\n### 1. Run
      modify-cluster command (OSX/Linux/UNIX) using the name of the cluster that you
      want to update as identifier (see Audit section part II, step no. 2) to enable
      AWS Redshift engine version upgrades for the selected cluster:\n```\naws redshift
      modify-cluster\n\t--region us-east-1\n\t--cluster-identifier cc-cluster\n\t--allow-version-upgrade\n```\n\n\n\n\t\t\t\n###
      2. If successful, the command output should return the Redshift cluster new
      configuration metadata:\n```\n{\n    \"Cluster\": {\n        \"PubliclyAccessible\":
      true,\n        \"NumberOfNodes\": 1,\n        \"PendingModifiedValues\": {},\n        \"VpcId\":
      \"vpc-2eb53422\",\n        \"ClusterVersion\": \"1.0\",\n        \"AutomatedSnapshotRetentionPeriod\":
      1,\n        \"ClusterParameterGroups\": [\n\t   ...\n        \"AllowVersionUpgrade\":
      true,\n\t   ...\n        \"ClusterSubnetGroupName\": \"default\",\n        \"ClusterSecurityGroups\":
      [],\n        \"ClusterIdentifier\": \"cc-cluster\",\n        \"AvailabilityZone\":
      \"us-east-1a\",\n        \"NodeType\": \"ds1.xlarge\",\n        \"ClusterStatus\":
      \"available\"\n    }\n}\n```\n### 3. Repeat step no. 1 and 2 for other Redshift
      clusters with engine version upgrades disabled, available in the current region.\n\n###
      4. Change the AWS region by updating the --region command parameter value and
      repeat steps no. 1 - 3 for other regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594745643324,"queries":[{"query":"source:inventories
      resource_type:aws_redshift resource_allow_version_upgrade:false","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0"}],"type":"threshold","id":"ztm-a1s-bu5","isDefault":false,"name":"[PCI
      AWS] Redshift Cluster Allow Version Upgrade"},{"creationAuthorId":41031,"tags":["security:compliance","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Ensure
      that your AWS Redshift database clusters are using custom master user names
      instead of the default master user name (i.e. \"awsuser\") in order to add an
      additional layer of defense against non-targeted attacks.\nChanging the default
      master user name for Redshift database clusters represents a basic security
      measure, therefore it will improve the overall security, however, this measure
      does not fully protect against attackers that can guess or obtain the database
      user names using social engineering techniques. To implement advanced Redshift
      database security, you should restrict the root account only to privileged users,
      use strong and complex passwords and grant permissions to trusted users only
      at the database level.\n\nThis rule can help you with the following compliance
      standards:\n\nPayment Card Industry Data Security Standard (PCI DSS)\nAPRA\nMAS\nThis
      rule can help you work with the AWS Well-Architected Framework\n\n## Remediation:\n###
      1. Run describe-clusters command (OSX/Linux/UNIX) to describe the configuration
      metadata for the AWS Redshift cluster that you want to relaunch (see Audit section
      part II to identify the right resource):\n```\naws redshift describe-clusters\n\t--region
      us-east-1\n\t--cluster-identifier cc-prod-db-cluster\n```\n### 2. The command
      output should return the requested configuration information which will be useful
      later when the new cluster will be created:\n```\n{\n    \"Clusters\": [\n        {\n            \"PubliclyAccessible\":
      true,\n            \"MasterUsername\": \"awsuser\",\n            \"VpcSecurityGroups\":
      [\n                {\n                    \"Status\": \"active\",\n                    \"VpcSecurityGroupId\":
      \"sg-541e2e7b\"\n                }\n            ],\n            \"ClusterPublicKey\":
      \"ssh-rsa AAZZB3NzaC ... \",\n            \"NumberOfNodes\": 1,\n            \"PendingModifiedValues\":
      {},\n            \"VpcId\": \"vpc-d731653f\",\n            \"ClusterVersion\":
      \"1.0\",\n            \"Tags\": [],\n            \"AutomatedSnapshotRetentionPeriod\":
      1,\n            \"ClusterParameterGroups\": [\n                {\n                    \"ParameterGroupName\":
      \"default.redshift-1.0\",\n                    \"ParameterApplyStatus\": \"in-sync\"\n                }\n            ],\n            \"DBName\":
      \"awsclusterdb\",\n            \"PreferredMaintenanceWindow\": \"fri:03:00-fri:03:30\",\n            \"Endpoint\":
      {\n                \"Port\": 5439,\n                \"Address\": \"cc-prod-db-cluster.dyupsgvyjhfo...\"\n            },\n            \"IamRoles\":
      [],\n            \"AllowVersionUpgrade\": true,\n            \"ClusterCreateTime\":
      \"2017-01-12T17:44:12.654Z\",\n            \"ClusterSubnetGroupName\": \"default\",\n            \"ClusterSecurityGroups\":
      [],\n            \"ClusterIdentifier\": \"cc-prod-db-cluster\",\n            \"ClusterNodes\":
      [\n                {\n                    \"NodeRole\": \"SHARED\",\n                    \"PrivateIPAddress\":
      \"172.43.121.2\",\n                    \"PublicIPAddress\": \"52.201.107.154\"\n                }\n            ],\n            \"AvailabilityZone\":
      \"us-east-1a\",\n            \"NodeType\": \"ds2.xlarge\",\n            \"Encrypted\":
      false,\n            \"ClusterRevisionNumber\": \"1106\",\n            \"ClusterStatus\":
      \"available\"\n        }\n    ]\n}\n```\n### 3. Run create-cluster command (OSX/Linux/UNIX)
      using the existing database cluster configuration details returned at the previous
      step to launch a new Amazon Redshift cluster with a different (non-default)
      master user name:\n```\naws redshift create-cluster\n\t--region us-east-1\n\t--cluster-identifier
      cc-prod-db-new-cluster\n\t--cluster-type single-node\n\t--node-type ds2.xlarge\n\t--db-name
      awsclusterdb\n\t--master-username awsmasterusr\n\t--master-user-password Pr0Dclusterpwd0\n\t--vpc-security-group-ids
      sg-541e2e7b\n\t--availability-zone us-east-1a\n\t--port 5439\n\t--cluster-subnet-group-name
      default\n\t--cluster-parameter-group-name default.redshift-1.0\n\t--publicly-accessible\n\t--allow-version-upgrade\n```\n###
      4. The command output should return the new Redshift cluster configuration metadata:\n```\n{\n    \"Cluster\":
      {\n        \"PubliclyAccessible\": true,\n        \"MasterUsername\": \"awsmasterusr\",\n        \"DBName\":
      \"awsclusterdb\",\n        \"PreferredMaintenanceWindow\": \"fri:06:00-fri:06:30\",\n        \"IamRoles\":
      [],\n        \"AllowVersionUpgrade\": true,\n\n\t   ...\n\n        \"ClusterSubnetGroupName\":
      \"default\",\n        \"ClusterSecurityGroups\": [],\n        \"ClusterIdentifier\":
      \"cc-prod-db-new-cluster\",\n        \"AvailabilityZone\": \"us-east-1a\",\n        \"NodeType\":
      \"ds2.xlarge\",\n        \"Encrypted\": false,\n        \"ClusterStatus\": \"creating\"\n    }\n}\n```\n###
      5. Run again describe-clusters command (OSX/Linux/UNIX) using custom query filters
      to expose the new Redshift database cluster endpoint:\n```\naws redshift describe-clusters\n\t--region
      us-east-1\n\t--cluster-identifier cc-prod-db-new-cluster\n\t--query ''Clusters[*].Endpoint.Address''\n```\n###
      6. The command output should return the new database cluster endpoint URL:\n```\n[\n   \"cc-prod-db-new-cluster.dyupsgvyjhfo.us-east-1.redshift.amazonaws.com\"\n]\n```\n###
      7. Unload your data from the old Redshift cluster and reload it into the newly
      created database cluster using the Amazon Redshift Unload/Copy utility. With
      this utility tool you can unload (export) your data from the source cluster
      to an AWS S3 bucket, then import it into your destination (new) cluster and
      clean up the S3 bucket used. All the necessary instructions to install, configure
      and use the Amazon Redshift Unload/Copy tool can be found at this URL.\n\n###
      8. As soon as the data migration process is completed and all the data is loaded
      into the new Redshift cluster, you can update your application configuration
      to refer to the new cluster endpoint, returned at step no. 6 (e.g. cc-prod-db-new-cluster.dyupsgvyjhfo.us-east-1.redshift.amazonaws.com).\n\n###
      9. Once the Redshift cluster endpoint is changed within your application configuration,
      run delete-cluster command (OSX/Linux/UNIX) to remove the source (old) cluster
      from your AWS account:\n```\naws redshift delete-cluster\n\t--region us-east-1\n\t--cluster-identifier
      cc-prod-db-cluster\n\t--final-cluster-snapshot-identifier cc-prod-db-cluster-final-snapshot\n```\n###
      10. The command output should return the metadata of the Redshift cluster selected
      for deletion:\n```\n{\n    \"Cluster\": {\n        \"PubliclyAccessible\": true,\n        \"MasterUsername\":
      \"awsmasterusr\",\n        \"PendingModifiedValues\": {},\n        \"VpcId\":
      \"vpc-d731653f\",\n        \"ClusterVersion\": \"1.0\",\n        \"AutomatedSnapshotRetentionPeriod\":
      1,\n\n\t   ...\n\n        \"ClusterSubnetGroupName\": \"default\",\n        \"ClusterSecurityGroups\":
      [],\n        \"ClusterIdentifier\": \"cc-prod-db-cluster\",\n        \"AvailabilityZone\":
      \"us-east-1a\",\n        \"NodeType\": \"ds2.xlarge\",\n        \"Encrypted\":
      false,\n        \"ClusterStatus\": \"final-snapshot\"\n    }\n}\n```\n### 11.
      Repeat steps no. 1 - 10 to relaunch other Redshift database clusters available
      within the current region, with a non-default master user name.\n\n### 12. Change
      the AWS region by updating the --region command parameter value and repeat steps
      no. 1 - 11 for other regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594746009409,"queries":[{"query":"source:inventories
      resource_type:aws_redshift resource_master_username:awsuser","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"low","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0"}],"type":"threshold","id":"dc3-jp4-m3j","isDefault":false,"name":"[PCI
      AWS] Redshift Cluster Default Master Username"},{"creationAuthorId":41031,"tags":["security:compliance","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Ensure
      that your AWS Redshift database clusters are not using their default endpoint
      port (i.e. 5439) in order to promote port obfuscation as an additional layer
      of defense against non-targeted attacks.\nChanging the default port number for
      Redshift database clusters represents a basic security measure and does not
      completely secure the clusters from port scanning and network attacks. To implement
      advanced Redshift database security, you should look into security measures
      such as restricting public access, controlling clusters access through security
      groups and Network Access Control Lists (NACLs) and encrypting the client connections
      to the database clusters using SSL.\n\nThis rule can help you with the following
      compliance standards:\n\nPayment Card Industry Data Security Standard (PCI DSS)\nAPRA\nNational
      Institute of Standards and Technology (NIST)\nThis rule can help you work with
      the AWS Well-Architected Framework\n\n## Remediation:\n### 1. Run describe-clusters
      command (OSX/Linux/UNIX) to describe the configuration information for the Amazon
      Redshift cluster that you want to reconfigure (see Audit section part II to
      identify the right cluster):\n```\naws redshift describe-clusters\n\t--region
      us-east-1\n\t--cluster-identifier cc-redshift-cluster\n```\n### 2. The command
      output should return the requested configuration information which will be useful
      later when the new Redshift cluster will be launched:\n```\n{\n    \"Clusters\":
      [\n        {\n            \"PubliclyAccessible\": true,\n            \"MasterUsername\":
      \"ccclusterusr\",\n            \"VpcSecurityGroups\": [\n                {\n                    \"Status\":
      \"active\",\n                    \"VpcSecurityGroupId\": \"sg-541e2e7b\"\n                }\n            ],\n            \"ClusterPublicKey\":
      \"ssh-rsa AAAAB3NzaC ... \",\n            \"NumberOfNodes\": 1,\n            \"PendingModifiedValues\":
      {},\n            \"VpcId\": \"vpc-d731653f\",\n            \"ClusterVersion\":
      \"1.0\",\n            \"Tags\": [],\n            \"AutomatedSnapshotRetentionPeriod\":
      1,\n            \"ClusterParameterGroups\": [\n                {\n                    \"ParameterGroupName\":
      \"default.redshift-1.0\",\n                    \"ParameterApplyStatus\": \"in-sync\"\n                }\n            ],\n            \"DBName\":
      \"ccclusterdb\",\n            \"PreferredMaintenanceWindow\": \"fri:03:00-fri:03:30\",\n            \"Endpoint\":
      {\n                \"Port\": 5439,\n                \"Address\": \"cc-redshift-cluster.cmfpsgvyjhfo
      ... \"\n            },\n            \"IamRoles\": [],\n            \"AllowVersionUpgrade\":
      true,\n            \"ClusterCreateTime\": \"2017-01-12T17:44:12.654Z\",\n            \"ClusterSubnetGroupName\":
      \"default\",\n            \"ClusterSecurityGroups\": [],\n            \"ClusterIdentifier\":
      \"cc-redshift-cluster\",\n            \"ClusterNodes\": [\n                {\n                    \"NodeRole\":
      \"SHARED\",\n                    \"PrivateIPAddress\": \"172.31.43.56\",\n                    \"PublicIPAddress\":
      \"52.3.14.122\"\n                }\n            ],\n            \"AvailabilityZone\":
      \"us-east-1a\",\n            \"NodeType\": \"ds2.xlarge\",\n            \"Encrypted\":
      false,\n            \"ClusterRevisionNumber\": \"1106\",\n            \"ClusterStatus\":
      \"available\"\n        }\n    ]\n}\n```\n### 3. Run create-cluster-snapshot
      command (OSX/Linux/UNIX) to create a manual snapshot of the existing Redshift
      database cluster:\n```\naws redshift create-cluster-snapshot\n\t--region us-east-1\n\t--cluster-identifier
      cc-redshift-cluster\n\t--snapshot-identifier cc-redshift-cluster-v2-snapshot\n```\n###
      4. The command output should return the Redshift snapshot configuration metadata:\n```\n{\n    \"Snapshot\":
      {\n        \"EstimatedSecondsToCompletion\": -1,\n        \"OwnerAccount\":
      \"123456789012\",\n        \"CurrentBackupRateInMegaBytesPerSecond\": 0.0,\n        \"ActualIncrementalBackupSizeInMegaBytes\":
      -1.0,\n        \"NumberOfNodes\": 1,\n        \"Status\": \"creating\",\n        \"VpcId\":
      \"vpc-d731653f\",\n        \"ClusterVersion\": \"1.0\",\n        \"MasterUsername\":
      \"ccclusterusr\",\n        \"TotalBackupSizeInMegaBytes\": -1.0,\n        \"DBName\":
      \"ccclusterdb\",\n        \"BackupProgressInMegaBytes\": 0.0,\n        \"ClusterCreateTime\":
      \"2017-01-12T17:44:12.654Z\",\n        \"EncryptedWithHSM\": false,\n        \"ClusterIdentifier\":
      \"cc-cluster\",\n        \"SnapshotCreateTime\": \"2017-08-18T18:15:49.041Z\",\n        \"AvailabilityZone\":
      \"us-east-1a\",\n        \"NodeType\": \"ds2.xlarge\",\n        \"Encrypted\":
      false,\n        \"ElapsedTimeInSeconds\": 0,\n        \"SnapshotType\": \"manual\",\n        \"Port\":
      5439,\n        \"SnapshotIdentifier\": \"cc-redshift-cluster-v2-snapshot\"\n    }\n}\n```\n###
      5. Run restore-from-cluster-snapshot command (OSX/Linux/UNIX) to create a new
      Amazon Redshift cluster from the snapshot created at step no. 3, using the configuration
      information returned at step no. 2 and a different number (e.g. 5640) for the
      database endpoint port (the chosen port number must be between 1115 and 65535):\n```\naws
      redshift restore-from-cluster-snapshot\n\t--region us-east-1\n\t--cluster-identifier
      cc-redshift-cluster-v2\n\t--snapshot-identifier cc-redshift-cluster-v2-snapshot\n\t--node-type
      ds2.xlarge\n\t--vpc-security-group-ids sg-541e2e7b\n\t--cluster-subnet-group-name
      default\n\t--availability-zone us-east-1a\n\t--cluster-parameter-group-name
      default.redshift-1.0\n\t--publicly-accessible\n\t--port 5640\n```\n### 6. The
      command output should return the metadata of the new Redshift cluster:\n```\n{\n    \"Cluster\":
      {\n        \"IamRoles\": [],\n        \"ClusterVersion\": \"1.0\",\n        \"NumberOfNodes\":
      1,\n        \"VpcId\": \"vpc-d731653f\",\n        \"NodeType\": \"ds2.xlarge\",\n\n\t   ...\n\n        \"ClusterStatus\":
      \"creating\",\n        \"ClusterIdentifier\": \"cc-redshift-cluster-v2\",\n        \"DBName\":
      \"ccclusterdb\",\n        \"PreferredMaintenanceWindow\": \"fri:03:00-fri:03:30\",\n        \"PendingModifiedValues\":
      {}\n    }\n}\n```\n### 7. Run describe-clusters command (OSX/Linux/UNIX) using
      the appropriate query filters to expose the new Redshift database cluster endpoint:\n```\naws
      redshift describe-clusters\n\t--region us-east-1\n\t--cluster-identifier cc-redshift-cluster-v2\n\t--query
      ''Clusters[*].Endpoint.Address''\n```\n### 8. The command output should return
      the requested endpoint URL:\n```\n[\n   \"cc-redshift-cluster-v2.dyupsgvyjhfo.us-east-1.redshift.amazonaws.com\"\n]\n```\n###
      9. As soon as the build process is complete, update your application configuration
      to point to the AWS Redshift database cluster endpoint address returned at step
      no. 8.\n\n### 10. Once the Redshift cluster endpoint is changed within your
      application configuration, you can execute delete-cluster command (OSX/Linux/UNIX)
      to remove the source cluster from your AWS account:\n```\naws redshift delete-cluster\n\t--region
      us-east-1\n\t--cluster-identifier cc-redshift-cluster\n\t--final-cluster-snapshot-identifier
      cc-redshift-cluster-final-snapshot\n```\n### 11. The command output should return
      the metadata of the Redshift cluster selected for deletion:\n```\n{\n    \"Cluster\":
      {\n        \"PubliclyAccessible\": true,\n        \"MasterUsername\": \"ccclusteruser\",\n        \"PendingModifiedValues\":
      {},\n        \"VpcId\": \"vpc-d731653f \",\n        \"ClusterVersion\": \"1.0\",\n        \"AutomatedSnapshotRetentionPeriod\":
      1,\n\n\t   ...\n\n        \"ClusterSubnetGroupName\": \"default\",\n        \"ClusterSecurityGroups\":
      [],\n        \"ClusterIdentifier\": \"cc-redshift-cluster\",\n        \"AvailabilityZone\":
      \"us-east-1a\",\n        \"NodeType\": \"ds2.xlarge\",\n        \"Encrypted\":
      false,\n        \"ClusterStatus\": \"final-snapshot\"\n    }\n}\n```\n### 12.
      Repeat steps no. 1 \u2013 11 to change the database endpoint port for other
      AWS Redshift clusters available in the current region.\n\n### 13. Change the
      AWS region by updating the --region command parameter value and repeat steps
      no. 1 - 12 to perform the entire process for other regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594746201205,"queries":[{"query":"source:inventories
      resource_type:aws_redshift resource_endpoint_port:5439","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"low","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0"}],"type":"threshold","id":"xno-osh-a8y","isDefault":false,"name":"[PCI
      AWS] Redshift Cluster Default Cluster Port"},{"creationAuthorId":41031,"tags":["security:compliance","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Ensure
      that your Redshift clusters are provisioned within the AWS EC2-VPC platform
      instead of EC2-Classic platform (outdated) for better flexibility and control
      over clusters security, traffic routing, availability and more.\n\nThis rule
      can help you with the following compliance standards:\n\nPayment Card Industry
      Data Security Standard (PCI DSS)\nHealth Insurance Portability and Accountability
      Act (HIPAA)\nAPRA\nMAS\nNational Institute of Standards and Technology (NIST)\nThis
      rule can help you work with the AWS Well-Architected Framework\n\n## Remediation:\n###
      1. Run describe-clusters command (OSX/Linux/UNIX) to describe the configuration
      metadata available for the selected EC2-Classic Redshift cluster:\n```\naws
      redshift describe-clusters\n\t--region us-east-1\n\t--cluster-identifier cc-cluster\n```\n###
      2. The command output should return the requested configuration metadata which
      will be useful later when the cluster will be recreated:\n```\n{\n    \"Clusters\":
      [\n        {\n            \"PubliclyAccessible\": true,\n            \"NumberOfNodes\":
      1,\n            \"MasterUsername\": \"ccclusteruser\",\n            \"DBName\":
      \"ccclusterdb\",\n            \"ClusterVersion\": \"1.0\",\n            \"Tags\":
      [],\n\n            ...\n\n            \"AutomatedSnapshotRetentionPeriod\":
      1,\n            \"NodeType\": \"dc1.large\",\n            \"Encrypted\": false,\n            \"ClusterRevisionNumber\":
      \"1022\",\n            \"ClusterStatus\": \"available\"\n        }\n    ]\n}\n```\n###
      3. Run create-cluster command (OSX/Linux/UNIX) using the existing (EC2-Classic)
      cluster configuration details returned at the previous step to launch a new
      Amazon Redshift cluster within a Virtual Private Cloud available in your AWS
      account:\n```\naws redshift create-cluster\n\t--region us-east-1\n\t--cluster-identifier
      cc-vpc-cluster\n\t--cluster-type single-node\n\t--node-type dc1.large\n\t--db-name
      ccclusterdb\n\t--master-username ccclusteruser\n\t--master-user-password DATAclusterpwd5\n\t--vpc-security-group-ids
      sg-45dca012\n\t--availability-zone us-east-1a\n\t--port 5439\n\t--cluster-subnet-group-name
      default\n\t--cluster-parameter-group-name default.redshift-1.0\n\t--publicly-accessible\n\t--allow-version-upgrade\n```\n#
      4. The command output should return the new cluster configuration metadata:\n```\n{\n    \"Cluster\":
      {\n        \"PubliclyAccessible\": true,\n        \"MasterUsername\": \"ccclusteruser\",\n        \"VpcSecurityGroups\":
      [\n            {\n                \"Status\": \"active\",\n                \"VpcSecurityGroupId\":
      \"sg-45dca012\"\n            }\n        ],\n        \"NumberOfNodes\": 1,\n        \"PendingModifiedValues\":
      {\n            \"MasterUserPassword\": \"****\"\n        },\n        \"VpcId\":
      \"vpc-2fb56548\",\n        \"ClusterVersion\": \"1.0\",\n        \"Tags\": [],\n        \"AutomatedSnapshotRetentionPeriod\":
      1,\n        \"ClusterParameterGroups\": [\n            {\n                \"ParameterGroupName\":
      \"default.redshift-1.0\",\n                \"ParameterApplyStatus\": \"in-sync\"\n            }\n        ],\n        \"DBName\":
      \"ccclusterdb\",\n        \"PreferredMaintenanceWindow\": \"fri:06:00-fri:06:30\",\n        \"IamRoles\":
      [],\n        \"AllowVersionUpgrade\": true,\n        \"ClusterSubnetGroupName\":
      \"default\",\n        \"ClusterSecurityGroups\": [],\n        \"ClusterIdentifier\":
      \"cc-vpc-cluster\",\n        \"AvailabilityZone\": \"us-east-1a\",\n        \"NodeType\":
      \"dc1.large\",\n        \"Encrypted\": false,\n        \"ClusterStatus\": \"creating\"\n    }\n}\n```\n###
      5. Run again describe-clusters command (OSX/Linux/UNIX) using the appropriate
      query filters to expose the new Redshift cluster endpoint:\n```\naws redshift
      describe-clusters\n\t--region us-east-1\n\t--cluster-identifier cc-vpc-cluster\n\t--query
      ''Clusters[*].Endpoint.Address''\n```\n### 6. The command output should return
      the new cluster endpoint URL:\n```\n[\n    \"cc-vpc-cluster.cmfpsgvyjhfo.us-east-1.redshift.amazonaws.com\"\n]\n```\n###
      7. Unload your data from the EC2-Classic Redshift cluster and reload it into
      the newly created cluster using the Amazon Redshift Unload/Copy utility. With
      this utility tool you can unload (export) your data from the unencrypted cluster
      (source) to an AWS S3 bucket, then import it into your new cluster (destination)
      and clean up the S3 bucket used. The necessary instructions to install, configure
      and use the Amazon Redshift Unload/Copy tool can be found on this page.\n\n###
      8. As soon as the migration process is completed and all the data is loaded
      into your new Redshift cluster, you can update your application configuration
      to refer to the new cluster endpoint address returned at step no. 6.\n\n###
      9. Once the Redshift cluster endpoint is changed within your application configuration,
      run delete-cluster command (OSX/Linux/UNIX) to remove the EC2-Classic cluster
      from your AWS account:\n```\naws redshift delete-cluster\n\t--region us-east-1\n\t--cluster-identifier
      cc-cluster\n\t--final-cluster-snapshot-identifier cc-ec2classic-cluster-finalsnapshot\n```\n###
      10. The command output should return the metadata of the cluster selected for
      deletion:\n```\n{\n    \"Cluster\": {\n        \"PubliclyAccessible\": true,\n        \"MasterUsername\":
      \"ccclusteruser\",\n        \"DBName\": \"ccclusterdb\",\n        \"NumberOfNodes\":
      1,\n        \"PendingModifiedValues\": {},\n        \"Tags\": [],\n\n        ...\n\n        \"AutomatedSnapshotRetentionPeriod\":
      1,\n        \"ClusterIdentifier\": \"cc-cluster\",\n        \"AvailabilityZone\":
      \"us-east-1a\",\n        \"NodeType\": \"dc1.large\",\n        \"Encrypted\":
      false,\n        \"ClusterStatus\": \"final-snapshot\"\n    }\n}\n```\n### 11.
      Repeat steps no. 1 - 10 to migrate other Redshift clusters launched with the
      EC2-Classic platform to a Virtual Private Cloud within the current region.\n\n###
      12. Change the AWS region by updating the --region command parameter value and
      repeat steps no. 1 - 11 for other regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594746521588,"queries":[{"query":"source:inventories
      resource_type:aws_redshift resource_vpc_id:\"\"","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"medium","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0"}],"type":"threshold","id":"yyt-l98-nub","isDefault":false,"name":"[PCI
      AWS] Redshift Cluster In VPC"},{"creationAuthorId":41031,"tags":["security:compliance","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Ensure
      Redshift clusters are not publicly accessible to minimise security risks.\n\nThis
      rule can help you with the following compliance standards:\n\nPayment Card Industry
      Data Security Standard (PCI DSS)\nHealth Insurance Portability and Accountability
      Act (HIPAA)\nGeneral Data Protection Regulation (GDPR)\nAPRA\nMAS\nNational
      Institute of Standards and Technology (NIST)\nThis rule can help you work with
      the AWS Well-Architected Framework\n\n## Remediation:\n### 1. Run modify-cluster
      command (OSX/Linux/UNIX) using the name of the cluster that you want to modify
      as identifier (see Audit section part II, step no. 2) to disable public access
      to the selected Amazon Redshift cluster:\n```\naws redshift modify-cluster\n\t--region
      us-east-1\n\t--cluster-identifier cc-cluster\n\t--no-publicly-accessible\n```\n###
      2. The command output should return the Redshift cluster new configuration metadata:\n```\n{\n    \"Cluster\":
      {\n        \"PubliclyAccessible\": false,\n        \"MasterUsername\": \"cloudconformity\",\n        \"ClusterVersion\":
      \"1.0\",\n        \"Tags\": [],\n        \"AutomatedSnapshotRetentionPeriod\":
      1,\n        ...\n        \"AllowVersionUpgrade\": true,\n        \"ClusterIdentifier\":
      \"cc-cluster\",\n        \"AvailabilityZone\": \"us-east-1a\",\n        \"NodeType\":
      \"dc1.large\",\n        \"Encrypted\": false,\n        \"ClusterStatus\": \"available\"\n    }\n}\n```\n###
      3. Repeat step no. 1 and 2 for other Redshift clusters that are publicly accessible,
      available in the current region.\n\n### 4. Change the AWS region by updating
      the --region command parameter value and repeat steps no. 1 - 3 for other regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594746651992,"queries":[{"query":"source:inventories
      resource_type:aws_redshift resource_publicly_accessible:true","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0"}],"type":"threshold","id":"wpf-fa0-zal","isDefault":false,"name":"[PCI
      AWS] Redshift Cluster Publicly Accessible"},{"creationAuthorId":41031,"tags":["security:compliance","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Ensure
      that there are no Amazon IAM users with administrator permissions (i.e. privileged
      users) available in your AWS account in order to adhere to IAM security best
      practices and implement the principle of least privilege (the practice of providing
      every user the minimal amount of access required to perform its tasks). A privileged
      IAM user is an IAM identity that has full access to AWS services and resources
      through the AdministratorAccess IAM managed policy. Cloud Conformity strongly
      recommends that the IAM administration and permission management within your
      AWS account should be divided between two well-defined roles: IAM Master and
      IAM Manager. The IAM Master and IAM Manager role policies must replace the AdministratorAccess
      policy attached to privileged IAM user in order to create and configure other
      IAM users and roles with limited permissions that follow the same principle
      of least privilege.\n\nThis rule can help you with the following compliance
      standards:\n\nPayment Card Industry Data Security Standard (PCI DSS)\nAPRA\nMAS\nNational
      Institute of Standards and Technology (NIST)\nThis rule can help you work with
      the AWS Well-Architected Framework\n\n## Remediation:\n### 1. Run detach-user-policy
      command (OSX/Linux/UNIX) using the name of the IAM user that you want to reconfigure
      as identifier (see Audit section part II to identify the right IAM resource)
      to remove the AdministratorAccess managed access policy that provides administrator-level
      permissions to the selected AWS IAM user. The following command examples will
      detach the managed policy identified by the ARN \"arn:aws:iam::aws:policy/AdministratorAccess\"
      from an IAM user named \"cc-aws-administrator\" (the command does not produce
      an output):\n```\naws iam detach-user-policy\n\t--user-name cc-aws-administrator\n\t--policy-arn
      arn:aws:iam::aws:policy/AdministratorAccess\n```\n### 2. Follow this conformity
      rule to implement proper IAM administration and permission management with IAM
      Master and IAM Manager roles.\n\n### 3. Once the IAM Master and IAM Manager
      access policies have been created and attached to the necessary IAM groups,
      run add-user-to-group command (OSX/Linux/UNIX) to add the privileged user to
      the IAM-Masters group created at the previous step. The following command example
      adds an IAM user named \"cc-aws-administrator\" to an IAM group identified by
      the name \"IAM-Masters\" (the command does not return an output):\n```\naws
      iam add-user-to-group\n\t--user-name cc-aws-administrator\n\t--group-name \"IAM-Masters\"\n```\nIf
      successful, the privileged IAM user will inherit the AWS IAM Master role access
      policy.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594753128726,"queries":[{"query":"source:inventories
      resource_type:aws_iam_user_attached_policy resource_policy_name:AdministratorAccess","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0"}],"type":"threshold","id":"yhk-apq-v1k","isDefault":false,"name":"[PCI
      AWS] AWS IAM Users with Admin Privileges"},{"creationAuthorId":41031,"tags":["security:compliance","service:ec2","aws","source:inventories","framework:pci_aws"],"isEnabled":true,"hasExtendedTitle":false,"message":"Ensure
      that your Amazon RDS databases instances are not using their default endpoint
      ports (i.e. MySQL/Aurora port 3306, SQL Server port 1433, PostgreSQL port 5432,
      etc) in order to promote port obfuscation as an additional layer of defense
      against non-targeted attacks.\n\nThis rule can help you with the following compliance
      standards:\n\nPayment Card Industry Data Security Standard (PCI DSS)\nAPRA\nNational
      Institute of Standards and Technology (NIST)\nThis rule can help you work with
      the AWS Well-Architected Framework\n\n## Remediation:\n### 1. First, run create-db-snapshot
      command (OSX/Linux/UNIX) to take an instance snapshot (backup):\n```\naws rds
      create-db-snapshot\n    --region us-east-1\n    --db-instance-identifier mysql-prod-db\n    --db-snapshot-identifier
      mysql-prod-db-snapshot\n```\n### 2. The command output should return the database
      instance snapshot metadata:\n```\n{\n    \"DBSnapshot\": {\n        \"Engine\":
      \"mysql\",\n        \"Status\": \"creating\",\n        \"AvailabilityZone\":
      \"us-east-1a\",\n        \"PercentProgress\": 0,\n        \"MasterUsername\":
      \"mySQLuser03\",\n        \"Encrypted\": false,\n        \"LicenseModel\": \"general-public-license\",\n        \"StorageType\":
      \"gp2\",\n        \"VpcId\": \"vpc-cb75654a\",\n        \"DBSnapshotIdentifier\":
      \"mysql-prod-db-snapshot\",\n        \"InstanceCreateTime\": \"2015-01-20T18:25:07.280Z\",\n        \"OptionGroupName\":
      \"default:mysql-5-6\",\n        \"AllocatedStorage\": 150,\n        \"EngineVersion\":
      \"5.6.27\",\n        \"SnapshotType\": \"manual\",\n        \"Port\": 3306,\n        \"DBInstanceIdentifier\":
      \"mysql-prod-db\"\n    }\n}\n```\n### 3. Run modify-db-instance command (OSX/Linux/UNIX)
      to modify the selected RDS instance configuration in order to change the default
      port number to a custom one. The valid port numbers that can be used are between
      1150 and 65535 for MySQL/MariaDB/Aurora/PostgreSQL/Oracle and between 1150 and
      65535 except for 1434, 3389, 47001, 49152, and 49152-49156 for the SQL Server.
      (!) IMPORTANT: the following example is using the Apply Immediately option to
      apply the change asynchronously and trigger an immediate outage. In order to
      avoid any downtime in production, skip adding the --apply-immediately command
      parameter and the RDS service will apply the port number change during the next
      maintenance window. The following command example replace the MySQL default
      port number (3306) with a non-default one, i.e. 3691:\n```\naws rds modify-db-instance\n    --region
      us-east-1\n    --db-instance-identifier mysql-prod-db\n    --db-port-number
      3691\n    --apply-immediately\n```\n### 4. The command output should reveal
      the configuration metadata for the modified RDS database instance:\n```\n{\n    \"DBInstance\":
      {\n        \"PubliclyAccessible\": true,\n        \"MasterUsername\": \"mySQLuser03\",\n        \"MonitoringInterval\":
      0,\n        \"LicenseModel\": \"general-public-license\",\n        \"VpcSecurityGroups\":
      [\n            {\n                \"Status\": \"active\",\n                \"VpcSecurityGroupId\":
      \"sg-bcd8a1c1\"\n            }\n        ],\n        \"InstanceCreateTime\":
      \"2017-01-06T16:20:54.081Z\",\n        \"CopyTagsToSnapshot\": false,\n\n        ...\n\n        \"DBInstanceStatus\":
      \"available\",\n        \"EngineVersion\": \"5.6.27\",\n        \"AvailabilityZone\":
      \"us-east-1a\",\n        \"DomainMemberships\": [],\n        \"StorageType\":
      \"gp2\",\n        \"DbiResourceId\": \"db-BXQWHEI54YFTFUODG32WYLOWDB\",\n        \"CACertificateIdentifier\":
      \"rds-ca-2015\",\n        \"StorageEncrypted\": false,\n        \"DBInstanceClass\":
      \"db.m3.medium\",\n        \"DbInstancePort\": 0,\n        \"DBInstanceIdentifier\":
      \"mysql-prod-db\"\n    }\n}\n```\n### 5. Once the database instance configuration
      is successfully updated (it may take few minutes to apply the changes), you
      can change the endpoint port number at your application level to match the non-default
      one set at step no. 2.\n\n### 6. Repeat steps no. 1 \u2013 5 for each RDS database
      instance that runs on the default port number, available in the current region.\n\n###
      7. Change the AWS region by updating the --region command parameter value and
      repeat steps no. 1 - 6 to perform the entire process for other regions.","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594755046788,"queries":[{"query":"source:inventories
      resource_type:aws_rds (resource_endpoint_port:3306 OR resource_endpoint_port:1433
      OR resource_endpoint_port:5432 OR resource_endpoint_port:1521)","groupByFields":["@resource_id"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"low","notifications":["@nick.davis@datadoghq.com"],"name":"Fail","condition":"a>0"}],"type":"threshold","id":"grm-0xr-fjk","isDefault":false,"name":"[PCI
      AWS] RDS Default Port"},{"creationAuthorId":40247,"tags":[],"isEnabled":true,"hasExtendedTitle":true,"message":"moez","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1594979249669,"queries":[{"query":"service:dogweb","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 40"}],"type":"threshold","id":"qui-2rg-rce","isDefault":false,"name":"test
      moezmoez"},{"creationAuthorId":40285,"tags":[],"isEnabled":false,"hasExtendedTitle":true,"message":"test
      configuration rule","options":{"evaluationWindow":7200,"maxSignalDuration":86400,"keepAlive":7200},"version":5,"createdAt":1595411986647,"queries":[{"query":"@resource_type:aws_network_acl_association","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"esv-5iu-va6","isDefault":false,"name":"test
      configuration rule"},{"creationAuthorId":40250,"tags":[],"isEnabled":true,"hasExtendedTitle":true,"message":"aa","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":1,"createdAt":1595515858538,"queries":[{"query":"source:kubernetes
      service:kube-apiserver-audit @k8s_user.username:\"system:anonymous\" @http.status_code:[200
      TO 299] -@http.url_details.path:\"/healthz\"","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"","condition":"a
      > 0"}],"type":"threshold","id":"gmu-tee-yh8","isDefault":false,"name":"[Kubernetes]
      Anonymous Request Allowed"},{"creationAuthorId":7194,"tags":["datadog-api-client-test-go"],"isEnabled":false,"hasExtendedTitle":false,"message":"rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1595581176119,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"wva-emy-ucy","isDefault":false,"name":"go-TestSecMonRulesCRUD-local-1595581175-0"},{"creationAuthorId":7194,"tags":["datadog-api-client-test-go"],"isEnabled":false,"hasExtendedTitle":false,"message":"rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1595581176350,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"ops-rol-bmn","isDefault":false,"name":"go-TestSecMonRulesCRUD-local-1595581175-1"},{"creationAuthorId":7194,"tags":["datadog-api-client-test-go"],"isEnabled":false,"hasExtendedTitle":false,"message":"rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1595581176519,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"6lt-fvq-qaw","isDefault":false,"name":"go-TestSecMonRulesCRUD-local-1595581175-2"},{"creationAuthorId":7194,"tags":["datadog-api-client-test-go"],"isEnabled":false,"hasExtendedTitle":false,"message":"rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1595581176689,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"qw8-rph-tqi","isDefault":false,"name":"go-TestSecMonRulesCRUD-local-1595581175-3"},{"creationAuthorId":7194,"tags":["datadog-api-client-test-go"],"isEnabled":false,"hasExtendedTitle":false,"message":"rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":1,"createdAt":1595581176878,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"px2-lnb-fwf","isDefault":false,"name":"go-TestSecMonRulesCRUD-local-1595581175-4"}]}'
    headers:
      Cache-Control:
      - no-cache
      Connection:
      - keep-alive
      Content-Disposition:
      - inline
      Content-Type:
      - application/json;charset=utf-8
      Date:
      - Fri, 24 Jul 2020 08:59:37 GMT
      Pragma:
      - no-cache
      Set-Cookie:
      - AWSALB=6YlX1Ba/yOvbrvUCRQMzP8OacmwN6InhXsKFw7s+6B3NnejgF7Z1nJyt7yCSvhOQa2b7KeehqtJ6ynmIdrid0DY6FWuOaoAUJKMPZrwiv4p7YpPO6kbUls3fNQ7H;
        Expires=Fri, 31 Jul 2020 08:59:37 GMT; Path=/
      - AWSALBCORS=6YlX1Ba/yOvbrvUCRQMzP8OacmwN6InhXsKFw7s+6B3NnejgF7Z1nJyt7yCSvhOQa2b7KeehqtJ6ynmIdrid0DY6FWuOaoAUJKMPZrwiv4p7YpPO6kbUls3fNQ7H;
        Expires=Fri, 31 Jul 2020 08:59:37 GMT; Path=/; SameSite=None; Secure
      - DD-PSHARD=0; Max-Age=604800; Path=/; expires=Fri, 31-Jul-2020 08:59:37 GMT;
        secure; HttpOnly
      Strict-Transport-Security:
      - max-age=15724800;
      Vary:
      - Accept-Encoding
      X-Content-Type-Options:
      - nosniff
      X-Dd-Version:
      - "35.2781836"
      X-Frame-Options:
      - SAMEORIGIN
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      Accept:
      - application/json
      Dd-Operation-Id:
      - ListSecurityMonitoringRules
      User-Agent:
      - datadog-api-client-go/1.0.0-beta.7+dev (go go1.14.1; os darwin; arch amd64)
      X-Datadog-Parent-Id:
      - "6798155500569491795"
      X-Datadog-Sampling-Priority:
      - "1"
      X-Datadog-Trace-Id:
      - "8825420659722329676"
    url: https://api.datadoghq.com/api/v2/security_monitoring/rules?page%5Bnumber%5D=0&page%5Bsize%5D=2
    method: GET
  response:
    body: '{"meta":{"page":{"total_filtered_count":232,"total_count":232}},"data":[{"creationAuthorId":5410,"tags":[],"isEnabled":false,"hasExtendedTitle":true,"message":"test","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":7,"createdAt":1574203869376,"queries":[{"query":"test","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":["@sllllllllack-security-analytics-alerts-low"],"name":"","condition":"a>1"}],"type":"threshold","id":"59c-44e-2ec","isDefault":true,"name":"test"},{"creationAuthorId":0,"tags":["security:compliance","framework:cis","control:cis-3.5","source:cloudtrail","scope:cloudtrail"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an attacker is trying to evade defenses by disabling or modifying
      CloudTrail.\n\n### Strategy\nThis rule lets you monitor these CloudTrail API
      calls to detect if an attacker is modifying or disabling CloudTrail:\n\n* [DeleteTrail][1]\n*
      [UpdateTrail][2]\n* [StopLogging][3]\n\n### Triage & Response\n1. Determine
      which user in your organization owns the API key that made this API call.\n2.
      Contact the user to see if they intended to make this API call.\n3. If the user
      did not make the API call:\n * Rotate the credentials.\n * Investigate if the
      same credentials made other unauthorized API calls.\n\n[1]: https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_DeleteTrail.html\n[2]:
      https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_UpdateTrail.html\n[3]:
      https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_StopLogging.html","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":701,"createdAt":1585058906229,"queries":[{"query":"source:cloudtrail
      @evt.name:(DeleteTrail OR UpdateTrail OR StopLogging OR CreateTrail OR StartLogging)","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"4c9-ccc-12d","isDefault":true,"name":"AWS
      CloudTrail Configuration Modified"}]}'
    headers:
      Cache-Control:
      - no-cache
      Connection:
      - keep-alive
      Content-Disposition:
      - inline
      Content-Type:
      - application/json;charset=utf-8
      Date:
      - Fri, 24 Jul 2020 08:59:37 GMT
      Pragma:
      - no-cache
      Set-Cookie:
      - AWSALB=t5Sx1Bj3H+lj91iS/WhFD9ht9rpbY44JS+Ofam3bErjj3VwI2p93uXFe6aTEFTwrqSP/6px2HfImAcwFgFYl64nRkC7ahNtXsh0JBFIIM6YTcqzY+FLIB+MLh67o;
        Expires=Fri, 31 Jul 2020 08:59:37 GMT; Path=/
      - AWSALBCORS=t5Sx1Bj3H+lj91iS/WhFD9ht9rpbY44JS+Ofam3bErjj3VwI2p93uXFe6aTEFTwrqSP/6px2HfImAcwFgFYl64nRkC7ahNtXsh0JBFIIM6YTcqzY+FLIB+MLh67o;
        Expires=Fri, 31 Jul 2020 08:59:37 GMT; Path=/; SameSite=None; Secure
      - DD-PSHARD=0; Max-Age=604800; Path=/; expires=Fri, 31-Jul-2020 08:59:37 GMT;
        secure; HttpOnly
      Strict-Transport-Security:
      - max-age=15724800;
      Vary:
      - Accept-Encoding
      X-Content-Type-Options:
      - nosniff
      X-Dd-Version:
      - "35.2781836"
      X-Frame-Options:
      - SAMEORIGIN
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      Accept:
      - application/json
      Dd-Operation-Id:
      - ListSecurityMonitoringRules
      User-Agent:
      - datadog-api-client-go/1.0.0-beta.7+dev (go go1.14.1; os darwin; arch amd64)
      X-Datadog-Parent-Id:
      - "4777575206002828514"
      X-Datadog-Sampling-Priority:
      - "1"
      X-Datadog-Trace-Id:
      - "8825420659722329676"
    url: https://api.datadoghq.com/api/v2/security_monitoring/rules?page%5Bnumber%5D=0&page%5Bsize%5D=2
    method: GET
  response:
    body: '{"meta":{"page":{"total_filtered_count":232,"total_count":232}},"data":[{"creationAuthorId":5410,"tags":[],"isEnabled":false,"hasExtendedTitle":true,"message":"test","options":{"evaluationWindow":900,"maxSignalDuration":86400,"keepAlive":3600},"version":7,"createdAt":1574203869376,"queries":[{"query":"test","groupByFields":[],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":["@sllllllllack-security-analytics-alerts-low"],"name":"","condition":"a>1"}],"type":"threshold","id":"59c-44e-2ec","isDefault":true,"name":"test"},{"creationAuthorId":0,"tags":["security:compliance","framework:cis","control:cis-3.5","source:cloudtrail","scope:cloudtrail"],"isEnabled":true,"hasExtendedTitle":true,"message":"###
      Goal\nDetect when an attacker is trying to evade defenses by disabling or modifying
      CloudTrail.\n\n### Strategy\nThis rule lets you monitor these CloudTrail API
      calls to detect if an attacker is modifying or disabling CloudTrail:\n\n* [DeleteTrail][1]\n*
      [UpdateTrail][2]\n* [StopLogging][3]\n\n### Triage & Response\n1. Determine
      which user in your organization owns the API key that made this API call.\n2.
      Contact the user to see if they intended to make this API call.\n3. If the user
      did not make the API call:\n * Rotate the credentials.\n * Investigate if the
      same credentials made other unauthorized API calls.\n\n[1]: https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_DeleteTrail.html\n[2]:
      https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_UpdateTrail.html\n[3]:
      https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_StopLogging.html","options":{"evaluationWindow":300,"maxSignalDuration":3600,"keepAlive":3600},"version":701,"createdAt":1585058906229,"queries":[{"query":"source:cloudtrail
      @evt.name:(DeleteTrail OR UpdateTrail OR StopLogging OR CreateTrail OR StartLogging)","groupByFields":["@userIdentity.arn"],"name":"","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"high","notifications":[],"name":"
      ","condition":"a > 0"}],"type":"threshold","id":"4c9-ccc-12d","isDefault":true,"name":"AWS
      CloudTrail Configuration Modified"}]}'
    headers:
      Cache-Control:
      - no-cache
      Connection:
      - keep-alive
      Content-Disposition:
      - inline
      Content-Type:
      - application/json;charset=utf-8
      Date:
      - Fri, 24 Jul 2020 08:59:38 GMT
      Pragma:
      - no-cache
      Set-Cookie:
      - AWSALB=WC6aoIhzPNT/8Ng/tF2GhG6jWNST3FG7a2VGwxDPIUnlznDZmcm//2RGDtbczZx+apFHWc4exBTJ4EIcCHNNg/0UhMzIXr+Kjfl1xCuD+DIzXfYsrJM5HcU/mlag;
        Expires=Fri, 31 Jul 2020 08:59:37 GMT; Path=/
      - AWSALBCORS=WC6aoIhzPNT/8Ng/tF2GhG6jWNST3FG7a2VGwxDPIUnlznDZmcm//2RGDtbczZx+apFHWc4exBTJ4EIcCHNNg/0UhMzIXr+Kjfl1xCuD+DIzXfYsrJM5HcU/mlag;
        Expires=Fri, 31 Jul 2020 08:59:37 GMT; Path=/; SameSite=None; Secure
      - DD-PSHARD=0; Max-Age=604800; Path=/; expires=Fri, 31-Jul-2020 08:59:37 GMT;
        secure; HttpOnly
      Strict-Transport-Security:
      - max-age=15724800;
      Vary:
      - Accept-Encoding
      X-Content-Type-Options:
      - nosniff
      X-Dd-Version:
      - "35.2781816"
      X-Frame-Options:
      - SAMEORIGIN
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: |
      {"cases":[{"condition":"nevermatch \u003e 1000","name":"rule-case","notifications":[],"status":"info"}],"enabled":false,"message":"rule message","name":"go-TestSecMonRulesCRUD-local-1595581175-0","options":{"evaluationWindow":300,"keepAlive":300,"maxSignalDuration":300},"queries":[{"distinctFields":[],"groupByFields":[],"name":"nevermatch","query":"thiswillnevernevermatch"}],"tags":["datadog-api-client-test-go"]}
    form: {}
    headers:
      Accept:
      - application/json
      Content-Type:
      - application/json
      Dd-Operation-Id:
      - UpdateSecurityMonitoringRule
      User-Agent:
      - datadog-api-client-go/1.0.0-beta.7+dev (go go1.14.1; os darwin; arch amd64)
      X-Datadog-Parent-Id:
      - "8160398704338154587"
      X-Datadog-Sampling-Priority:
      - "1"
      X-Datadog-Trace-Id:
      - "8825420659722329676"
    url: https://api.datadoghq.com/api/v2/security_monitoring/rules/wva-emy-ucy
    method: PUT
  response:
    body: '{"creationAuthorId":7194,"tags":["datadog-api-client-test-go"],"isEnabled":false,"hasExtendedTitle":false,"message":"rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":2,"createdAt":1595581176119,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"wva-emy-ucy","isDefault":false,"name":"go-TestSecMonRulesCRUD-local-1595581175-0"}'
    headers:
      Cache-Control:
      - no-cache
      Connection:
      - keep-alive
      Content-Disposition:
      - inline
      Content-Type:
      - application/json;charset=utf-8
      Date:
      - Fri, 24 Jul 2020 08:59:38 GMT
      Pragma:
      - no-cache
      Set-Cookie:
      - AWSALB=v+hu8VBTyXrnlkjk6+47WNyq3GAD+p/jbtnvC3qkH18Hd/AFtzVvH0ylxRSWivj9gYaXiZokmYYgtWbh7d6T/UGDY7mlcJwu4H8EG8CdWkUOq2YUOegTKQ9qnmXa;
        Expires=Fri, 31 Jul 2020 08:59:38 GMT; Path=/
      - AWSALBCORS=v+hu8VBTyXrnlkjk6+47WNyq3GAD+p/jbtnvC3qkH18Hd/AFtzVvH0ylxRSWivj9gYaXiZokmYYgtWbh7d6T/UGDY7mlcJwu4H8EG8CdWkUOq2YUOegTKQ9qnmXa;
        Expires=Fri, 31 Jul 2020 08:59:38 GMT; Path=/; SameSite=None; Secure
      - DD-PSHARD=0; Max-Age=604800; Path=/; expires=Fri, 31-Jul-2020 08:59:38 GMT;
        secure; HttpOnly
      Strict-Transport-Security:
      - max-age=15724800;
      Vary:
      - Accept-Encoding
      X-Content-Type-Options:
      - nosniff
      X-Dd-Version:
      - "35.2781816"
      X-Frame-Options:
      - SAMEORIGIN
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      Accept:
      - application/json
      Dd-Operation-Id:
      - GetSecurityMonitoringRule
      User-Agent:
      - datadog-api-client-go/1.0.0-beta.7+dev (go go1.14.1; os darwin; arch amd64)
      X-Datadog-Parent-Id:
      - "8009524472898294664"
      X-Datadog-Sampling-Priority:
      - "1"
      X-Datadog-Trace-Id:
      - "8825420659722329676"
    url: https://api.datadoghq.com/api/v2/security_monitoring/rules/wva-emy-ucy
    method: GET
  response:
    body: '{"creationAuthorId":7194,"tags":["datadog-api-client-test-go"],"isEnabled":false,"hasExtendedTitle":false,"message":"rule
      message","options":{"evaluationWindow":300,"maxSignalDuration":300,"keepAlive":300},"version":2,"createdAt":1595581176119,"queries":[{"query":"thiswillnevernevermatch","groupByFields":[],"name":"nevermatch","distinctFields":[]}],"isDeleted":false,"cases":[{"status":"info","notifications":[],"name":"rule-case","condition":"nevermatch
      > 1000"}],"type":"threshold","id":"wva-emy-ucy","isDefault":false,"name":"go-TestSecMonRulesCRUD-local-1595581175-0"}'
    headers:
      Cache-Control:
      - no-cache
      Connection:
      - keep-alive
      Content-Disposition:
      - inline
      Content-Type:
      - application/json;charset=utf-8
      Date:
      - Fri, 24 Jul 2020 08:59:38 GMT
      Pragma:
      - no-cache
      Set-Cookie:
      - AWSALB=HaQjxPdFm34Ht8N1ADLc/bepkaVq2xU+GmvDU365nDMoFPGjJ1h9aPMnQRvf705YlvFlh+TZeUgxxE8VX+dPQgpmATTQOO5CJyTr9j/qtShkNXUKdG8S7CdOsTWA;
        Expires=Fri, 31 Jul 2020 08:59:38 GMT; Path=/
      - AWSALBCORS=HaQjxPdFm34Ht8N1ADLc/bepkaVq2xU+GmvDU365nDMoFPGjJ1h9aPMnQRvf705YlvFlh+TZeUgxxE8VX+dPQgpmATTQOO5CJyTr9j/qtShkNXUKdG8S7CdOsTWA;
        Expires=Fri, 31 Jul 2020 08:59:38 GMT; Path=/; SameSite=None; Secure
      - DD-PSHARD=0; Max-Age=604800; Path=/; expires=Fri, 31-Jul-2020 08:59:38 GMT;
        secure; HttpOnly
      Strict-Transport-Security:
      - max-age=15724800;
      Vary:
      - Accept-Encoding
      X-Content-Type-Options:
      - nosniff
      X-Dd-Version:
      - "35.2781816"
      X-Frame-Options:
      - SAMEORIGIN
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      Accept:
      - application/json
      Dd-Operation-Id:
      - DeleteSecurityMonitoringRule
      User-Agent:
      - datadog-api-client-go/1.0.0-beta.7+dev (go go1.14.1; os darwin; arch amd64)
      X-Datadog-Parent-Id:
      - "2882590573081322437"
      X-Datadog-Sampling-Priority:
      - "1"
      X-Datadog-Trace-Id:
      - "8825420659722329676"
    url: https://api.datadoghq.com/api/v2/security_monitoring/rules/wva-emy-ucy
    method: DELETE
  response:
    body: ""
    headers:
      Cache-Control:
      - no-cache
      Connection:
      - keep-alive
      Content-Disposition:
      - inline
      Content-Length:
      - "2"
      Date:
      - Fri, 24 Jul 2020 08:59:38 GMT
      Pragma:
      - no-cache
      Set-Cookie:
      - AWSALB=Lkc/9X4SqRLN/C/Tkax8h/DVUkVIjKhHEuMXiDrgpZVR+9bLl2jf/1KSVdKN9e39d+dt7Ez9LPCmEEdKGz6XhETcGQdLHPzOiJVFrnj8lYGfzQPI9r8uBHlp+oFi;
        Expires=Fri, 31 Jul 2020 08:59:38 GMT; Path=/
      - AWSALBCORS=Lkc/9X4SqRLN/C/Tkax8h/DVUkVIjKhHEuMXiDrgpZVR+9bLl2jf/1KSVdKN9e39d+dt7Ez9LPCmEEdKGz6XhETcGQdLHPzOiJVFrnj8lYGfzQPI9r8uBHlp+oFi;
        Expires=Fri, 31 Jul 2020 08:59:38 GMT; Path=/; SameSite=None; Secure
      - DD-PSHARD=0; Max-Age=604800; Path=/; expires=Fri, 31-Jul-2020 08:59:38 GMT;
        secure; HttpOnly
      Strict-Transport-Security:
      - max-age=15724800;
      X-Content-Type-Options:
      - nosniff
      X-Dd-Version:
      - "35.2781816"
      X-Frame-Options:
      - SAMEORIGIN
    status: 204 No Content
    code: 204
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      Accept:
      - application/json
      Dd-Operation-Id:
      - GetSecurityMonitoringRule
      User-Agent:
      - datadog-api-client-go/1.0.0-beta.7+dev (go go1.14.1; os darwin; arch amd64)
      X-Datadog-Parent-Id:
      - "608510101407463293"
      X-Datadog-Sampling-Priority:
      - "1"
      X-Datadog-Trace-Id:
      - "8825420659722329676"
    url: https://api.datadoghq.com/api/v2/security_monitoring/rules/wva-emy-ucy
    method: GET
  response:
    body: '{"errors":["Threat detection rule not found: wva-emy-ucy"]}'
    headers:
      Cache-Control:
      - no-cache
      Connection:
      - keep-alive
      Content-Type:
      - application/json
      Date:
      - Fri, 24 Jul 2020 08:59:38 GMT
      Pragma:
      - no-cache
      Set-Cookie:
      - AWSALB=ySJSdnwu51OogQuUwh99fU65p7jMUW9jXqvxE/i9ZgXNtmDTQTUlxHWgaERMeZ6CBlHrx3uuqn237L8MIwqugR3JyT2bH6ZtkhavatfMXpZxGS6jY2twU6i0DWqW;
        Expires=Fri, 31 Jul 2020 08:59:38 GMT; Path=/
      - AWSALBCORS=ySJSdnwu51OogQuUwh99fU65p7jMUW9jXqvxE/i9ZgXNtmDTQTUlxHWgaERMeZ6CBlHrx3uuqn237L8MIwqugR3JyT2bH6ZtkhavatfMXpZxGS6jY2twU6i0DWqW;
        Expires=Fri, 31 Jul 2020 08:59:38 GMT; Path=/; SameSite=None; Secure
      Strict-Transport-Security:
      - max-age=15724800;
      Vary:
      - Accept-Encoding
      X-Content-Type-Options:
      - nosniff
      X-Dd-Version:
      - "35.2781836"
      X-Frame-Options:
      - SAMEORIGIN
    status: 404 Not Found
    code: 404
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      Accept:
      - application/json
      Dd-Operation-Id:
      - DeleteSecurityMonitoringRule
      User-Agent:
      - datadog-api-client-go/1.0.0-beta.7+dev (go go1.14.1; os darwin; arch amd64)
      X-Datadog-Parent-Id:
      - "3899527215261013215"
      X-Datadog-Sampling-Priority:
      - "1"
      X-Datadog-Trace-Id:
      - "8825420659722329676"
    url: https://api.datadoghq.com/api/v2/security_monitoring/rules/px2-lnb-fwf
    method: DELETE
  response:
    body: ""
    headers:
      Cache-Control:
      - no-cache
      Connection:
      - keep-alive
      Content-Disposition:
      - inline
      Content-Length:
      - "2"
      Date:
      - Fri, 24 Jul 2020 08:59:38 GMT
      Pragma:
      - no-cache
      Set-Cookie:
      - AWSALB=OShPHH44ft641OZ0u3D//DGzy27rjNP0u3ltT1SwIJ0ET6ZkODrNyg3cBJ5ssUxXqp+8Y6agKY6JSkOpzhZkhc8+ydqrwAegqkAFikjwWxbHa8ZE1fMOfGOKRc2+;
        Expires=Fri, 31 Jul 2020 08:59:38 GMT; Path=/
      - AWSALBCORS=OShPHH44ft641OZ0u3D//DGzy27rjNP0u3ltT1SwIJ0ET6ZkODrNyg3cBJ5ssUxXqp+8Y6agKY6JSkOpzhZkhc8+ydqrwAegqkAFikjwWxbHa8ZE1fMOfGOKRc2+;
        Expires=Fri, 31 Jul 2020 08:59:38 GMT; Path=/; SameSite=None; Secure
      - DD-PSHARD=0; Max-Age=604800; Path=/; expires=Fri, 31-Jul-2020 08:59:38 GMT;
        secure; HttpOnly
      Strict-Transport-Security:
      - max-age=15724800;
      X-Content-Type-Options:
      - nosniff
      X-Dd-Version:
      - "35.2781836"
      X-Frame-Options:
      - SAMEORIGIN
    status: 204 No Content
    code: 204
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      Accept:
      - application/json
      Dd-Operation-Id:
      - DeleteSecurityMonitoringRule
      User-Agent:
      - datadog-api-client-go/1.0.0-beta.7+dev (go go1.14.1; os darwin; arch amd64)
      X-Datadog-Parent-Id:
      - "8780630146800268574"
      X-Datadog-Sampling-Priority:
      - "1"
      X-Datadog-Trace-Id:
      - "8825420659722329676"
    url: https://api.datadoghq.com/api/v2/security_monitoring/rules/qw8-rph-tqi
    method: DELETE
  response:
    body: ""
    headers:
      Cache-Control:
      - no-cache
      Connection:
      - keep-alive
      Content-Disposition:
      - inline
      Content-Length:
      - "2"
      Date:
      - Fri, 24 Jul 2020 08:59:39 GMT
      Pragma:
      - no-cache
      Set-Cookie:
      - AWSALB=OhgD9LOIwqY0CFltwv8syGWnsgoeSlrSGoPXljIcVwr8sQgyOntFkIdrvbS9neg34wyNp2+eNOXkb7kaEJfo7n/YQAbb0HRWPnKAN2DjCxh5TciNofg90woICUSN;
        Expires=Fri, 31 Jul 2020 08:59:39 GMT; Path=/
      - AWSALBCORS=OhgD9LOIwqY0CFltwv8syGWnsgoeSlrSGoPXljIcVwr8sQgyOntFkIdrvbS9neg34wyNp2+eNOXkb7kaEJfo7n/YQAbb0HRWPnKAN2DjCxh5TciNofg90woICUSN;
        Expires=Fri, 31 Jul 2020 08:59:39 GMT; Path=/; SameSite=None; Secure
      - DD-PSHARD=0; Max-Age=604800; Path=/; expires=Fri, 31-Jul-2020 08:59:39 GMT;
        secure; HttpOnly
      Strict-Transport-Security:
      - max-age=15724800;
      X-Content-Type-Options:
      - nosniff
      X-Dd-Version:
      - "35.2781836"
      X-Frame-Options:
      - SAMEORIGIN
    status: 204 No Content
    code: 204
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      Accept:
      - application/json
      Dd-Operation-Id:
      - DeleteSecurityMonitoringRule
      User-Agent:
      - datadog-api-client-go/1.0.0-beta.7+dev (go go1.14.1; os darwin; arch amd64)
      X-Datadog-Parent-Id:
      - "8848135479045595227"
      X-Datadog-Sampling-Priority:
      - "1"
      X-Datadog-Trace-Id:
      - "8825420659722329676"
    url: https://api.datadoghq.com/api/v2/security_monitoring/rules/6lt-fvq-qaw
    method: DELETE
  response:
    body: ""
    headers:
      Cache-Control:
      - no-cache
      Connection:
      - keep-alive
      Content-Disposition:
      - inline
      Content-Length:
      - "2"
      Date:
      - Fri, 24 Jul 2020 08:59:39 GMT
      Pragma:
      - no-cache
      Set-Cookie:
      - AWSALB=Grnl8Gnn9lahwEq8PcC+GAM9e0Gwbgbar25zBDRSmPodLPVrma0krhd4g9VJmGVktgjJZ9kn86NxHx6yuOHg+a34mhhqBWSHTXfYnrUJjyIkwJB1veffMfkm8GC4;
        Expires=Fri, 31 Jul 2020 08:59:39 GMT; Path=/
      - AWSALBCORS=Grnl8Gnn9lahwEq8PcC+GAM9e0Gwbgbar25zBDRSmPodLPVrma0krhd4g9VJmGVktgjJZ9kn86NxHx6yuOHg+a34mhhqBWSHTXfYnrUJjyIkwJB1veffMfkm8GC4;
        Expires=Fri, 31 Jul 2020 08:59:39 GMT; Path=/; SameSite=None; Secure
      - DD-PSHARD=0; Max-Age=604800; Path=/; expires=Fri, 31-Jul-2020 08:59:39 GMT;
        secure; HttpOnly
      Strict-Transport-Security:
      - max-age=15724800;
      X-Content-Type-Options:
      - nosniff
      X-Dd-Version:
      - "35.2781816"
      X-Frame-Options:
      - SAMEORIGIN
    status: 204 No Content
    code: 204
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      Accept:
      - application/json
      Dd-Operation-Id:
      - DeleteSecurityMonitoringRule
      User-Agent:
      - datadog-api-client-go/1.0.0-beta.7+dev (go go1.14.1; os darwin; arch amd64)
      X-Datadog-Parent-Id:
      - "1426889761585264469"
      X-Datadog-Sampling-Priority:
      - "1"
      X-Datadog-Trace-Id:
      - "8825420659722329676"
    url: https://api.datadoghq.com/api/v2/security_monitoring/rules/ops-rol-bmn
    method: DELETE
  response:
    body: ""
    headers:
      Cache-Control:
      - no-cache
      Connection:
      - keep-alive
      Content-Disposition:
      - inline
      Content-Length:
      - "2"
      Date:
      - Fri, 24 Jul 2020 08:59:39 GMT
      Pragma:
      - no-cache
      Set-Cookie:
      - AWSALB=VIHAwnxbdS2gh5YArGnYBDWWD8g9vxsnKqnn+/I1gyO0I9b9aMFkRnZAc3/dXfwD/8JhAcDA7EyjcD4kzDNaRb1Xn9x/MSkFhsgHKXFFsrRihZ0WjTcy1r+jLe+9;
        Expires=Fri, 31 Jul 2020 08:59:39 GMT; Path=/
      - AWSALBCORS=VIHAwnxbdS2gh5YArGnYBDWWD8g9vxsnKqnn+/I1gyO0I9b9aMFkRnZAc3/dXfwD/8JhAcDA7EyjcD4kzDNaRb1Xn9x/MSkFhsgHKXFFsrRihZ0WjTcy1r+jLe+9;
        Expires=Fri, 31 Jul 2020 08:59:39 GMT; Path=/; SameSite=None; Secure
      - DD-PSHARD=0; Max-Age=604800; Path=/; expires=Fri, 31-Jul-2020 08:59:39 GMT;
        secure; HttpOnly
      Strict-Transport-Security:
      - max-age=15724800;
      X-Content-Type-Options:
      - nosniff
      X-Dd-Version:
      - "35.2781816"
      X-Frame-Options:
      - SAMEORIGIN
    status: 204 No Content
    code: 204
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      Accept:
      - application/json
      Dd-Operation-Id:
      - DeleteSecurityMonitoringRule
      User-Agent:
      - datadog-api-client-go/1.0.0-beta.7+dev (go go1.14.1; os darwin; arch amd64)
      X-Datadog-Parent-Id:
      - "1471051621169497532"
      X-Datadog-Sampling-Priority:
      - "1"
      X-Datadog-Trace-Id:
      - "8825420659722329676"
    url: https://api.datadoghq.com/api/v2/security_monitoring/rules/wva-emy-ucy
    method: DELETE
  response:
    body: '{"errors":["Threat detection rule not found: wva-emy-ucy"]}'
    headers:
      Cache-Control:
      - no-cache
      Connection:
      - keep-alive
      Content-Type:
      - application/json
      Date:
      - Fri, 24 Jul 2020 08:59:39 GMT
      Pragma:
      - no-cache
      Set-Cookie:
      - AWSALB=pfev0GloWLB/pK1Z0cGKbcUB9UhjMCkij5vyzI0jKOZXFaefBskm5vFuHnIxQ5yUOCEp3IOrSlHU3nZavhaEba111yQsV0B5a1lxRaVF9BOCbqjyP0ob9aIVp0LN;
        Expires=Fri, 31 Jul 2020 08:59:39 GMT; Path=/
      - AWSALBCORS=pfev0GloWLB/pK1Z0cGKbcUB9UhjMCkij5vyzI0jKOZXFaefBskm5vFuHnIxQ5yUOCEp3IOrSlHU3nZavhaEba111yQsV0B5a1lxRaVF9BOCbqjyP0ob9aIVp0LN;
        Expires=Fri, 31 Jul 2020 08:59:39 GMT; Path=/; SameSite=None; Secure
      Strict-Transport-Security:
      - max-age=15724800;
      Vary:
      - Accept-Encoding
      X-Content-Type-Options:
      - nosniff
      X-Dd-Version:
      - "35.2781816"
      X-Frame-Options:
      - SAMEORIGIN
    status: 404 Not Found
    code: 404
    duration: ""
