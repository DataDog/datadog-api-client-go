interactions:
- request:
    body: |
      {"data":{"attributes":{"enabled":true,"name":"Test-Get_the_list_of_signal_based_rules_returns_The_list_of_notification_rules_response-1737628561","selectors":{"query":"env:test","rule_types":["signal_correlation"],"severities":["critical"],"trigger_source":"security_signals"},"targets":["@email@email.com"]},"type":"notification_rules"}}
    form: {}
    headers:
      Accept:
      - application/json
      Content-Type:
      - application/json
    id: 0
    method: POST
    url: https://api.datadoghq.com/api/v2/security/signals/notification_rules
  response:
    body: '{"data":{"id":"wt5-y8s-3fa","type":"notification_rules","attributes":{"created_at":1737628561456,"created_by":{"name":"CI
      Account","handle":"9919ec9b-ebc7-49ee-8dc8-03626e717cca"},"enabled":true,"modified_at":1737628561456,"modified_by":{"name":"CI
      Account","handle":"9919ec9b-ebc7-49ee-8dc8-03626e717cca"},"name":"Test-Get_the_list_of_signal_based_rules_returns_The_list_of_notification_rules_response-1737628561","selectors":{"severities":["critical"],"rule_types":["signal_correlation"],"query":"env:test","trigger_source":"security_signals"},"targets":["@email@email.com"],"time_aggregation":0,"version":1}}}'
    code: 201
    duration: 0ms
    headers:
      Content-Type:
      - application/vnd.api+json
    status: 201 Created
- request:
    body: ''
    form: {}
    headers:
      Accept:
      - application/json
    id: 1
    method: GET
    url: https://api.datadoghq.com/api/v2/security/signals/notification_rules
  response:
    body: '{"data":[{"id":"hwk-zqh-vg4","type":"notification_rules","attributes":{"created_at":1699905830776,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-List_notification_profiles_returns_OK_response-1699905830","selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"query":"","trigger_source":"security_signals"},"targets":["test"],"time_aggregation":0,"version":2}},{"id":"fsm-4am-ozw","type":"notification_rules","attributes":{"created_at":1699905832107,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-Update_a_notification_profile_returns_OK_response-1699905832","selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"query":"","trigger_source":"security_signals"},"targets":["test"],"time_aggregation":0,"version":2}},{"id":"px4-xrb-b9v","type":"notification_rules","attributes":{"created_at":1699905992485,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-Create_a_notification_profile_returns_OK_response-1699905992","selectors":{"severities":["high"],"rule_types":["application_security","log_detection"],"query":"(env:\"prod\"
      OR @env:\"prod\") AND (test:\"123\" OR @test:\"123\")","trigger_source":"security_signals"},"targets":["@slack-test"],"time_aggregation":0,"version":2}},{"id":"ukt-yim-ouw","type":"notification_rules","attributes":{"created_at":1699905996937,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-Get_notification_profile_by_ID_returns_OK_response-1699905996","selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"query":"","trigger_source":"security_signals"},"targets":["test"],"time_aggregation":0,"version":2}},{"id":"tpj-yqn-fcw","type":"notification_rules","attributes":{"created_at":1699905997240,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-List_notification_profiles_returns_OK_response-1699905997","selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"query":"","trigger_source":"security_signals"},"targets":["test"],"time_aggregation":0,"version":2}},{"id":"tv9-9dw-fbd","type":"notification_rules","attributes":{"created_at":1699905998529,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-Update_a_notification_profile_returns_OK_response-1699905998","selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"query":"","trigger_source":"security_signals"},"targets":["test"],"time_aggregation":0,"version":2}},{"id":"pdt-i8z-vcs","type":"notification_rules","attributes":{"created_at":1699906082093,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-Create_a_notification_profile_returns_OK_response-1699906081","selectors":{"severities":["high"],"rule_types":["application_security","log_detection"],"query":"(env:\"prod\"
      OR @env:\"prod\") AND (test:\"123\" OR @test:\"123\")","trigger_source":"security_signals"},"targets":["@slack-test"],"time_aggregation":0,"version":2}},{"id":"tlb-cvk-wup","type":"notification_rules","attributes":{"created_at":1699906087769,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-Get_notification_profile_by_ID_returns_OK_response-1699906087","selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"query":"","trigger_source":"security_signals"},"targets":["test"],"time_aggregation":0,"version":2}},{"id":"sqp-oih-tp8","type":"notification_rules","attributes":{"created_at":1699906088050,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-List_notification_profiles_returns_OK_response-1699906087","selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"query":"","trigger_source":"security_signals"},"targets":["test"],"time_aggregation":0,"version":2}},{"id":"zll-nff-pbx","type":"notification_rules","attributes":{"created_at":1699906089134,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-Update_a_notification_profile_returns_OK_response-1699906089","selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"query":"","trigger_source":"security_signals"},"targets":["test"],"time_aggregation":0,"version":2}},{"id":"4u9-ooz-fwf","type":"notification_rules","attributes":{"created_at":1699906572841,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-Create_a_notification_profile_returns_OK_response-1699906572","selectors":{"severities":["high"],"rule_types":["application_security","log_detection"],"query":"(env:\"prod\"
      OR @env:\"prod\") AND (test:\"123\" OR @test:\"123\")","trigger_source":"security_signals"},"targets":["@slack-test"],"time_aggregation":0,"version":2}},{"id":"lny-xec-2r7","type":"notification_rules","attributes":{"created_at":1699906577427,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-Get_notification_profile_by_ID_returns_OK_response-1699906577","selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"query":"","trigger_source":"security_signals"},"targets":["test"],"time_aggregation":0,"version":2}},{"id":"qfa-6nt-wn2","type":"notification_rules","attributes":{"created_at":1699906577706,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-List_notification_profiles_returns_OK_response-1699906577","selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"query":"","trigger_source":"security_signals"},"targets":["test"],"time_aggregation":0,"version":2}},{"id":"zcr-tja-rut","type":"notification_rules","attributes":{"created_at":1699906578815,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-Update_a_notification_profile_returns_OK_response-1699906578","selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"query":"","trigger_source":"security_signals"},"targets":["test"],"time_aggregation":0,"version":3}},{"id":"rca-ogs-ckx","type":"notification_rules","attributes":{"created_at":1699906789206,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-Create_a_notification_profile_returns_OK_response-1699906789","selectors":{"severities":["high"],"rule_types":["application_security","log_detection"],"query":"(env:\"prod\"
      OR @env:\"prod\") AND (test:\"123\" OR @test:\"123\")","trigger_source":"security_signals"},"targets":["@slack-test"],"time_aggregation":0,"version":2}},{"id":"dis-abp-grp","type":"notification_rules","attributes":{"created_at":1699906793874,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-Get_notification_profile_by_ID_returns_OK_response-1699906793","selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"query":"","trigger_source":"security_signals"},"targets":["test"],"time_aggregation":0,"version":2}},{"id":"n5i-avj-8br","type":"notification_rules","attributes":{"created_at":1699906794201,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-List_notification_profiles_returns_OK_response-1699906794","selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"query":"","trigger_source":"security_signals"},"targets":["test"],"time_aggregation":0,"version":2}},{"id":"wct-cix-3ay","type":"notification_rules","attributes":{"created_at":1699906795311,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":false,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-Update_a_notification_profile_returns_OK_response-1699906795","selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"query":"","trigger_source":"security_signals"},"targets":["test2"],"time_aggregation":0,"version":3}},{"id":"pyf-t6u-dxp","type":"notification_rules","attributes":{"created_at":1699907487559,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-Create_a_notification_profile_returns_OK_response-1699907487","selectors":{"severities":["high"],"rule_types":["application_security","log_detection"],"query":"(env:\"prod\"
      OR @env:\"prod\") AND (test:\"123\" OR @test:\"123\")","trigger_source":"security_signals"},"targets":["@slack-test"],"time_aggregation":0,"version":2}},{"id":"vwj-uew-mas","type":"notification_rules","attributes":{"created_at":1699907492243,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-Get_notification_profile_by_ID_returns_OK_response-1699907492","selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"query":"","trigger_source":"security_signals"},"targets":["test"],"time_aggregation":0,"version":2}},{"id":"a1y-ysu-rvw","type":"notification_rules","attributes":{"created_at":1699907492600,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-List_notification_profiles_returns_OK_response-1699907492","selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"query":"","trigger_source":"security_signals"},"targets":["test"],"time_aggregation":0,"version":2}},{"id":"kq1-edx-tkt","type":"notification_rules","attributes":{"created_at":1699907493778,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":false,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-Update_a_notification_profile_returns_OK_response-1699907493","selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"query":"","trigger_source":"security_signals"},"targets":["test2"],"time_aggregation":0,"version":3}},{"id":"4i4-raj-t0a","type":"notification_rules","attributes":{"created_at":1699908569876,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-Create_a_notification_profile_returns_OK_response-1699908569","selectors":{"severities":["high"],"rule_types":["application_security","log_detection"],"query":"(env:\"prod\"
      OR @env:\"prod\") AND (test:\"123\" OR @test:\"123\")","trigger_source":"security_signals"},"targets":["@slack-test"],"time_aggregation":0,"version":2}},{"id":"ncy-2zl-jge","type":"notification_rules","attributes":{"created_at":1699908575238,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-Get_notification_profile_by_ID_returns_OK_response-1699908575","selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"query":"(fim:\"true\"
      OR @fim:\"true\")","trigger_source":"security_signals"},"targets":["test"],"time_aggregation":0,"version":2}},{"id":"tiq-glx-quq","type":"notification_rules","attributes":{"created_at":1699908575600,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":true,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-List_notification_profiles_returns_OK_response-1699908575","selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"query":"(fim:\"true\"
      OR @fim:\"true\")","trigger_source":"security_signals"},"targets":["test"],"time_aggregation":0,"version":2}},{"id":"ue7-0sv-du1","type":"notification_rules","attributes":{"created_at":1699908576920,"created_by":{"name":"frog","handle":"frog@datadoghq.com"},"enabled":false,"modified_at":1725452072048,"modified_by":{"name":"frog","handle":"frog@datadoghq.com"},"name":"Test-Update_a_notification_profile_returns_OK_response-1699908576","selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"query":"(fim:\"true\"
      OR @fim:\"true\")","trigger_source":"security_signals"},"targets":["test2"],"time_aggregation":0,"version":3}},{"id":"wt5-y8s-3fa","type":"notification_rules","attributes":{"created_at":1737628561456,"created_by":{"name":"CI
      Account","handle":"9919ec9b-ebc7-49ee-8dc8-03626e717cca"},"enabled":true,"modified_at":1737628561456,"modified_by":{"name":"CI
      Account","handle":"9919ec9b-ebc7-49ee-8dc8-03626e717cca"},"name":"Test-Get_the_list_of_signal_based_rules_returns_The_list_of_notification_rules_response-1737628561","selectors":{"severities":["critical"],"rule_types":["signal_correlation"],"query":"env:test","trigger_source":"security_signals"},"targets":["@email@email.com"],"time_aggregation":0,"version":1}}]}'
    code: 200
    duration: 0ms
    headers:
      Content-Type:
      - application/vnd.api+json
    status: 200 OK
- request:
    body: ''
    form: {}
    headers:
      Accept:
      - '*/*'
    id: 2
    method: DELETE
    url: https://api.datadoghq.com/api/v2/security/signals/notification_rules/wt5-y8s-3fa
  response:
    body: ''
    code: 204
    duration: 0ms
    headers: {}
    status: 204 No Content
version: 2
