interactions:
- request:
    body: |
      {"data":{"attributes":{"enabled":true,"name":"Test-List_notification_rules_returns_OK_response-1713390910","selectors":{"attributes":["fim:true"],"implicit_vm_rule_match":false,"rule_tags":["fim:true"],"rule_types":["log_detection","cloud_configuration"],"severities":["high"],"signal_tags":[],"trigger_source":"security_signals"},"targets":["test"]},"type":"notification_rules"}}
    form: {}
    headers:
      Accept:
      - application/json
      Content-Type:
      - application/json
    id: 0
    method: POST
    url: https://api.datadoghq.com/api/v2/security_monitoring/configuration/notification_rules
  response:
    body: '{"data":{"id":"pbf-rdm-eut","attributes":{"version":1,"name":"Test-List_notification_rules_returns_OK_response-1713390910","targets":["test"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":["fim:true"],"query":"(fim:\"true\"
      OR @fim:\"true\")","migrated":true,"trigger_source":"security_signals","implicit_vm_rule_match":false},"enabled":true,"creation_date":1713390910773,"update_date":1713390910773,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"}}

      '
    code: 200
    duration: 0ms
    headers:
      Content-Type:
      - application/json
    status: 200 OK
- request:
    body: ''
    form: {}
    headers:
      Accept:
      - application/json
    id: 1
    method: GET
    url: https://api.datadoghq.com/api/v2/security_monitoring/configuration/notification_rules
  response:
    body: '{"data":[{"id":"hwk-zqh-vg4","attributes":{"version":1,"name":"Test-List_notification_profiles_returns_OK_response-1699905830","targets":["test"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":[],"query":"","migrated":false,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699905830776,"update_date":1699905830776,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"fsm-4am-ozw","attributes":{"version":1,"name":"Test-Update_a_notification_profile_returns_OK_response-1699905832","targets":["test"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":[],"query":"","migrated":false,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699905832107,"update_date":1699905832107,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"px4-xrb-b9v","attributes":{"version":1,"name":"Test-Create_a_notification_profile_returns_OK_response-1699905992","targets":["@slack-test"],"selectors":{"severities":["high"],"rule_types":["application_security","log_detection"],"rule_tags":["test:123"],"signal_tags":["env:prod"],"attributes":["env:prod","test:123"],"query":"(env:\"prod\"
      OR @env:\"prod\") AND (test:\"123\" OR @test:\"123\")","migrated":true,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699905992485,"update_date":1699905992485,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"ukt-yim-ouw","attributes":{"version":1,"name":"Test-Get_notification_profile_by_ID_returns_OK_response-1699905996","targets":["test"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":[],"query":"","migrated":false,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699905996937,"update_date":1699905996937,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"tpj-yqn-fcw","attributes":{"version":1,"name":"Test-List_notification_profiles_returns_OK_response-1699905997","targets":["test"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":[],"query":"","migrated":false,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699905997240,"update_date":1699905997240,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"tv9-9dw-fbd","attributes":{"version":1,"name":"Test-Update_a_notification_profile_returns_OK_response-1699905998","targets":["test"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":[],"query":"","migrated":false,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699905998529,"update_date":1699905998529,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"pdt-i8z-vcs","attributes":{"version":1,"name":"Test-Create_a_notification_profile_returns_OK_response-1699906081","targets":["@slack-test"],"selectors":{"severities":["high"],"rule_types":["application_security","log_detection"],"rule_tags":["test:123"],"signal_tags":["env:prod"],"attributes":["env:prod","test:123"],"query":"(env:\"prod\"
      OR @env:\"prod\") AND (test:\"123\" OR @test:\"123\")","migrated":true,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699906082093,"update_date":1699906082093,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"tlb-cvk-wup","attributes":{"version":1,"name":"Test-Get_notification_profile_by_ID_returns_OK_response-1699906087","targets":["test"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":[],"query":"","migrated":false,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699906087769,"update_date":1699906087769,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"sqp-oih-tp8","attributes":{"version":1,"name":"Test-List_notification_profiles_returns_OK_response-1699906087","targets":["test"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":[],"query":"","migrated":false,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699906088050,"update_date":1699906088050,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"zll-nff-pbx","attributes":{"version":1,"name":"Test-Update_a_notification_profile_returns_OK_response-1699906089","targets":["test"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":[],"query":"","migrated":false,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699906089134,"update_date":1699906089134,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"4u9-ooz-fwf","attributes":{"version":1,"name":"Test-Create_a_notification_profile_returns_OK_response-1699906572","targets":["@slack-test"],"selectors":{"severities":["high"],"rule_types":["application_security","log_detection"],"rule_tags":["test:123"],"signal_tags":["env:prod"],"attributes":["env:prod","test:123"],"query":"(env:\"prod\"
      OR @env:\"prod\") AND (test:\"123\" OR @test:\"123\")","migrated":true,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699906572841,"update_date":1699906572841,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"lny-xec-2r7","attributes":{"version":1,"name":"Test-Get_notification_profile_by_ID_returns_OK_response-1699906577","targets":["test"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":[],"query":"","migrated":false,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699906577427,"update_date":1699906577427,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"qfa-6nt-wn2","attributes":{"version":1,"name":"Test-List_notification_profiles_returns_OK_response-1699906577","targets":["test"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":[],"query":"","migrated":false,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699906577706,"update_date":1699906577706,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"zcr-tja-rut","attributes":{"version":2,"name":"Test-Update_a_notification_profile_returns_OK_response-1699906578","targets":["test"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":[],"query":"","migrated":false,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699906578815,"update_date":1699906578992,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"rca-ogs-ckx","attributes":{"version":1,"name":"Test-Create_a_notification_profile_returns_OK_response-1699906789","targets":["@slack-test"],"selectors":{"severities":["high"],"rule_types":["application_security","log_detection"],"rule_tags":["test:123"],"signal_tags":["env:prod"],"attributes":["env:prod","test:123"],"query":"(env:\"prod\"
      OR @env:\"prod\") AND (test:\"123\" OR @test:\"123\")","migrated":true,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699906789206,"update_date":1699906789206,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"dis-abp-grp","attributes":{"version":1,"name":"Test-Get_notification_profile_by_ID_returns_OK_response-1699906793","targets":["test"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":[],"query":"","migrated":false,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699906793874,"update_date":1699906793874,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"n5i-avj-8br","attributes":{"version":1,"name":"Test-List_notification_profiles_returns_OK_response-1699906794","targets":["test"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":[],"query":"","migrated":false,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699906794201,"update_date":1699906794201,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"wct-cix-3ay","attributes":{"version":2,"name":"Test-Update_a_notification_profile_returns_OK_response-1699906795","targets":["test2"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":[],"query":"","migrated":false,"implicit_vm_rule_match":false},"enabled":false,"creation_date":1699906795311,"update_date":1699906795504,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"pyf-t6u-dxp","attributes":{"version":1,"name":"Test-Create_a_notification_profile_returns_OK_response-1699907487","targets":["@slack-test"],"selectors":{"severities":["high"],"rule_types":["application_security","log_detection"],"rule_tags":["test:123"],"signal_tags":["env:prod"],"attributes":["env:prod","test:123"],"query":"(env:\"prod\"
      OR @env:\"prod\") AND (test:\"123\" OR @test:\"123\")","migrated":true,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699907487559,"update_date":1699907487559,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"vwj-uew-mas","attributes":{"version":1,"name":"Test-Get_notification_profile_by_ID_returns_OK_response-1699907492","targets":["test"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":[],"query":"","migrated":false,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699907492243,"update_date":1699907492243,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"a1y-ysu-rvw","attributes":{"version":1,"name":"Test-List_notification_profiles_returns_OK_response-1699907492","targets":["test"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":[],"query":"","migrated":false,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699907492600,"update_date":1699907492600,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"kq1-edx-tkt","attributes":{"version":2,"name":"Test-Update_a_notification_profile_returns_OK_response-1699907493","targets":["test2"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":[],"query":"","migrated":false,"implicit_vm_rule_match":false},"enabled":false,"creation_date":1699907493778,"update_date":1699907493989,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"4i4-raj-t0a","attributes":{"version":1,"name":"Test-Create_a_notification_profile_returns_OK_response-1699908569","targets":["@slack-test"],"selectors":{"severities":["high"],"rule_types":["application_security","log_detection"],"rule_tags":["test:123"],"signal_tags":["env:prod"],"attributes":["env:prod","test:123"],"query":"(env:\"prod\"
      OR @env:\"prod\") AND (test:\"123\" OR @test:\"123\")","migrated":true,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699908569876,"update_date":1699908569876,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"ncy-2zl-jge","attributes":{"version":1,"name":"Test-Get_notification_profile_by_ID_returns_OK_response-1699908575","targets":["test"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":["fim:true"],"query":"(fim:\"true\"
      OR @fim:\"true\")","migrated":true,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699908575238,"update_date":1699908575238,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"tiq-glx-quq","attributes":{"version":1,"name":"Test-List_notification_profiles_returns_OK_response-1699908575","targets":["test"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":["fim:true"],"query":"(fim:\"true\"
      OR @fim:\"true\")","migrated":true,"implicit_vm_rule_match":false},"enabled":true,"creation_date":1699908575600,"update_date":1699908575600,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"ue7-0sv-du1","attributes":{"version":2,"name":"Test-Update_a_notification_profile_returns_OK_response-1699908576","targets":["test2"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":["fim:true"],"query":"(fim:\"true\"
      OR @fim:\"true\")","migrated":true,"implicit_vm_rule_match":false},"enabled":false,"creation_date":1699908576920,"update_date":1699908577113,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"},{"id":"pbf-rdm-eut","attributes":{"version":1,"name":"Test-List_notification_rules_returns_OK_response-1713390910","targets":["test"],"selectors":{"severities":["high"],"rule_types":["log_detection","cloud_configuration"],"rule_tags":["fim:true"],"signal_tags":[],"attributes":["fim:true"],"query":"(fim:\"true\"
      OR @fim:\"true\")","migrated":true,"trigger_source":"security_signals","implicit_vm_rule_match":false},"enabled":true,"creation_date":1713390910773,"update_date":1713390910773,"creator":{"name":null,"handle":"frog@datadoghq.com"},"updater":{"name":null,"handle":"frog@datadoghq.com"}},"type":"notification_rules"}]}

      '
    code: 200
    duration: 0ms
    headers:
      Content-Type:
      - application/json
    status: 200 OK
- request:
    body: ''
    form: {}
    headers:
      Accept:
      - '*/*'
    id: 2
    method: DELETE
    url: https://api.datadoghq.com/api/v2/security_monitoring/configuration/notification_rules/pbf-rdm-eut
  response:
    body: ''
    code: 204
    duration: 0ms
    headers:
      Content-Type:
      - text/html; charset=utf-8
    status: 204 No Content
version: 2
