interactions:
- request:
    body: |
      {"data":{"attributes":{"description":"My Agent rule","enabled":true,"expression":"exec.file.name == \"sh\"","name":"testgetallcloudworkloadsecurityagentrulesreturnsokresponse1709907553"},"type":"agent_rule"}}
    form: {}
    headers:
      Accept:
      - application/json
      Content-Type:
      - application/json
    id: 0
    method: POST
    url: https://api.datadoghq.com/api/v2/security_monitoring/cloud_workload_security/agent_rules
  response:
    body: '{"data":{"id":"gd2-ogg-fyk","attributes":{"version":1,"name":"testgetallcloudworkloadsecurityagentrulesreturnsokresponse1709907553","description":"My
      Agent rule","expression":"exec.file.name == \"sh\"","category":"Process Activity","creationAuthorUuId":"cc32ddea-b5e4-11ec-93be-da7ad0900002","creationDate":1709907553752,"updateAuthorUuId":"cc32ddea-b5e4-11ec-93be-da7ad0900002","updateDate":1709907553752,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","defaultRule":false,"enabled":true,"creator":{"name":"Malo
      Le Goff","handle":"malo.legoff@datadoghq.com"},"updater":{"name":"Malo Le Goff","handle":"malo.legoff@datadoghq.com"}},"type":"agent_rule"}}

      '
    code: 200
    duration: 0ms
    headers:
      Content-Type:
      - application/json
    status: 200 OK
- request:
    body: ''
    form: {}
    headers:
      Accept:
      - application/json
    id: 1
    method: GET
    url: https://api.datadoghq.com/api/v2/security_monitoring/cloud_workload_security/agent_rules
  response:
    body: '{"data":[{"id":"gd2-ogg-fyk","attributes":{"version":1,"name":"testgetallcloudworkloadsecurityagentrulesreturnsokresponse1709907553","description":"My
      Agent rule","expression":"exec.file.name == \"sh\"","category":"Process Activity","creationAuthorUuId":"cc32ddea-b5e4-11ec-93be-da7ad0900002","creationDate":1709907553752,"updateAuthorUuId":"cc32ddea-b5e4-11ec-93be-da7ad0900002","updateDate":1709907553752,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":false,"creator":{"name":"Malo
      Le Goff","handle":"malo.legoff@datadoghq.com"},"updater":{"name":"Malo Le Goff","handle":"malo.legoff@datadoghq.com"}},"type":"agent_rule"},{"id":"g5j-9l5-phu","attributes":{"version":11,"name":"cryptominer_args","description":"A
      process launched with arguments associated with cryptominers","expression":"exec.args_flags
      in [\"cpu-priority\", \"donate-level\", ~\"randomx-1gb-pages\"] || exec.args
      in [~\"*stratum+tcp*\", ~\"*stratum+ssl*\", ~\"*stratum1+tcp*\", ~\"*stratum1+ssl*\",
      ~\"*stratum2+tcp*\", ~\"*stratum2+ssl*\", ~\"*nicehash*\", ~\"*yespower*\"]","category":"Process
      Activity","creationDate":0,"updateAuthorUuId":"3c3ddadd-9ceb-11ed-b5f9-b6e96f801924","updateDate":1709241156082,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":false,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"Daniel
      Zhou","handle":"daniel.zhou@datadoghq.com"}},"type":"agent_rule"},{"id":"ya1-tzs-p2g","attributes":{"version":2,"name":"tde_malware_ransomware_notes_written","description":"A
      possible ransomware note created under common user directories","expression":"open.file.path
      in [~\"/home/**\", ~\"/root/**\", ~\"/bin/**\", ~\"/usr/bin/**\", ~\"/opt/**\",
      ~\"/etc/**\", ~\"/var/log/**\", ~\"/var/lib/log/**\", ~\"/var/backup/**\", ~\"/var/www/**\"]
      && open.file.name in [r\".*(restore|recovery|readme|instruction|how_to|ransom).*\",
      r\".*(your_|crypt|lock|important).*\\.txt$\"]","category":"File Activity","creationAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","creationDate":1703167436145,"updateAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","updateDate":1708536266340,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":false,"creator":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"},"updater":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"}},"type":"agent_rule"},{"id":"xn0-ede-cwo","attributes":{"version":1,"name":"tde_nsenter_pid1_detection","description":"nsenter
      used in container to execute code on the OS PID1","expression":"exec.file.name
      == \"nsenter\" && exec.args_options in [\"target=1\", \"t=1\"] && container.id
      !=\"\"","category":"Process Activity","creationAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","creationDate":1707329054174,"updateAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","updateDate":1707329054174,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":false,"creator":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"},"updater":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"}},"type":"agent_rule"},{"id":"wyh-nt8-y0o","attributes":{"version":1,"name":"tde_red_team_domains_used","description":"Connection
      to red team domain","expression":"dns.question.name in [~\"*.interact.sh\" ,
      ~\"*.oast.pro\" , ~\"*.oast.live\" , ~\"*.oast.site\" , ~\"*.oast.online\" ,
      ~\"*.oast.fun\" , ~\"*.oast.me\" , ~\"*.burpcollaborator.net\" , ~\"*.oastify.com\"
      , ~\"*canarytokens.com\" , ~\"*.requestbin.net\" , ~\"*.dnslog.cn\"]","category":"Network
      Activity","creationAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","creationDate":1705421116371,"updateAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","updateDate":1705421116371,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":false,"creator":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"},"updater":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"}},"type":"agent_rule"},{"id":"mua-npg-7n2","attributes":{"version":1,"name":"looney_tunables_exploit","description":"Looney
      Tunables (CVE-2023-4911) exploit attempted","expression":"exec.file.mode & S_ISUID
      > 0 && exec.file.uid == 0 && exec.uid != 0 && exec.envs in [~\"*GLIBC_TUNABLES*\"]","category":"Process
      Activity","creationDate":0,"updateDate":1704404434303,"filters":["os == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"afy-gnp-rfp","attributes":{"version":1,"name":"kernel_msr_write","description":"A
      process attempted to enable writing to model-specific registers","expression":"exec.comm
      == \"modprobe\" && process.args =~ \"*msr*allow_writes*\"","category":"Process
      Activity","creationDate":0,"updateDate":1704404434302,"filters":["os == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"qew-m41-jfc","attributes":{"version":1,"name":"ransomware_note","description":"Possible
      ransomware note created under common user directories","expression":"open.flags
      & O_CREAT > 0 && open.file.path in [~\"/home/**\", ~\"/root/**\", ~\"/bin/**\",
      ~\"/usr/bin/**\", ~\"/opt/**\", ~\"/etc/**\", ~\"/var/log/**\", ~\"/var/lib/log/**\",
      ~\"/var/backup/**\", ~\"/var/www/**\"] && open.file.name in [r\"(?i).*(restore|recovery|readme|instruction|how_to|ransom).*|.*(your_|crypt|lock|important).*\\.txt$\"]
      && open.file.name != \"README.md\"","category":"File Activity","creationDate":0,"updateDate":1704404434302,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"mwt-r43-san","attributes":{"version":1,"name":"sensitive_tracing","description":"A
      process is tracing privileged processes or sshd for possible credential dumping","expression":"(ptrace.request
      == PTRACE_PEEKTEXT || ptrace.request == PTRACE_PEEKDATA || ptrace.request ==
      PTRACE_PEEKUSR) && ptrace.tracee.euid == 0 && process.comm not in [\"dlv\",
      \"dlv-linux-amd64\", \"strace\", \"gdb\", \"lldb-server\"]","category":"Kernel
      Activity","creationDate":0,"updateDate":1704404434302,"filters":["os == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"ul7-jol-1bw","attributes":{"version":1,"name":"cryptominer_envs","description":"Process
      environment variables match cryptocurrency miner","expression":"exec.envs in
      [~\"*POOL_USER*\", ~\"*POOL_URL*\", ~\"*POOL_PASS*\", ~\"*DONATE_LEVEL*\"]","category":"Process
      Activity","creationDate":0,"updateDate":1704404426851,"filters":["os == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"dqg-wa2-0oi","attributes":{"version":1,"name":"procdump_execution","description":"A
      tool used to dump process memory has been executed","expression":"exec.file.name
      in [\"procmon.exe\",\"procdump.exe\"]","category":"Process Activity","creationDate":0,"updateDate":1704404425515,"filters":["os
      == \"windows\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"csf-k3c-qka","attributes":{"version":1,"name":"minidump_usage","description":"Process
      memory was dumped using the minidump function from comsvcs.dll","expression":"exec.cmdline
      =~ \"*MiniDump*\"","category":"Process Activity","creationDate":0,"updateDate":1704404425504,"filters":["os
      == \"windows\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"ghp-mfr-1qz","attributes":{"version":1,"name":"tunnel_traffic","description":"Tunneling
      or port forwarding tool used","expression":"((exec.comm == \"pivotnacci\" ||
      exec.comm == \"gost\") && process.args in [r\".*(-L|-C|-R).*\"]) || (exec.comm
      in [\"ssh\", \"sshd\"] && process.args in [r\".*(-R|-L|-D|w).*\"] && process.args
      in [r\"((25[0-5]|(2[0-4]|1\\d|[1-9])\\d)\\.?\\b){4}\"] ) || (exec.comm == \"sshuttle\"
      && process.args in [r\".*(-r|--remote|-l|--listen).*\"]) || (exec.comm == \"socat\"
      && process.args in [r\".*(TCP4-LISTEN:|SOCKS).*\"]) || (exec.comm in [\"iodine\",
      \"iodined\", \"dnscat\", \"hans\", \"hans-ubuntu\", \"ptunnel-ng\", \"ssf\",
      \"3proxy\", \"ngrok\"] && process.parent.comm in [\"bash\", \"dash\", \"ash\",
      \"sh\", \"tcsh\", \"csh\", \"zsh\", \"ksh\", \"fish\"])","category":"Process
      Activity","creationDate":0,"updateDate":1704404425504,"filters":["os == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"uhr-n6q-lvh","attributes":{"version":1,"name":"iptables_egress_allowed","description":"Egress
      traffic allowed using iptables","expression":"exec.comm == \"iptables\" && process.args
      in [r\".*OUTPUT.*((25[0-5]|(2[0-4]|1\\d|[1-9]|)\\d)\\.?\\b){4}.*ACCEPT\"] &&
      process.args not in [r\"(127\\.)|(10\\.)|(172\\.1[6-9]\\.)|(172\\.2[0-9]\\.)|(^172\\.3[0-1]\\.)|(192\\.168\\.)|(169\\.254\\.)\"]","category":"Process
      Activity","creationDate":0,"updateDate":1704404424741,"filters":["os == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"642-j0s-psf","attributes":{"version":1,"name":"libpam_ebpf_hook","description":"Library
      libpam.so hooked using eBPF","expression":"bpf.cmd == BPF_MAP_CREATE && process.args
      in [r\".*libpam.so.*\"]","category":"Kernel Activity","creationDate":0,"updateDate":1704404424739,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"u8d-fot-gin","attributes":{"version":1,"name":"wmi_spawning_shell","description":"Command
      executed via WMI","expression":"exec.file.name in [~\"powershell*\",\"cmd.exe\"]
      && process.parent.file.name == \"WmiPrvSE.exe\"","category":"Process Activity","creationDate":0,"updateDate":1704404424705,"filters":["os
      == \"windows\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"17k-2xh-ie2","attributes":{"version":1,"name":"crackmap_exec_executed","description":"Known
      offensive tool crackmap exec executed","expression":"exec.cmdline in [~\"*crackmapexec*\",
      ~\"*cme*\"]","category":"Process Activity","creationDate":0,"updateDate":1704404424475,"filters":["os
      == \"windows\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"45j-2y7-vyd","attributes":{"version":1,"name":"chatroom_request","description":"A
      newly created file contacted a chatroom domain","expression":"dns.question.name
      in [\"discord.com\", \"api.telegram.org\", \"cdn.discordapp.com\"] && process.file.in_upper_layer
      && process.file.change_time < 60s","category":"Network Activity","creationDate":0,"updateDate":1704404424472,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"ecn-u6p-nqz","attributes":{"version":1,"name":"suspicious_bitsadmin_usage","description":"A
      suspicious bitsadmin command has been executed","expression":"exec.file.name
      == \"bitsadmin.exe\" && exec.cmdline in [~\"*addfile*\", ~\"*create*\", ~\"*resume*\"]","category":"Process
      Activity","creationDate":0,"updateDate":1704404424472,"filters":["os == \"windows\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"xcs-z8z-hx3","attributes":{"version":1,"name":"ntds_in_commandline","description":"NTDS
      file referenced in commandline","expression":"exec.cmdline =~ \"*ntds.dit*\"","category":"Process
      Activity","creationDate":0,"updateDate":1704404424468,"filters":["os == \"windows\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"l7e-zmy-5pd","attributes":{"version":1,"name":"scheduled_task_creation","description":"A
      scheduled task was created","expression":"exec.file.name in [\"at.exe\",\"schtasks.exe\"]","category":"Process
      Activity","creationDate":0,"updateDate":1704404424467,"filters":["os == \"windows\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"i8x-ujp-ueg","attributes":{"version":1,"name":"delete_system_log","description":"A
      process deleted common system log files","expression":"unlink.file.path in [\"/var/run/utmp\",
      \"/var/log/wtmp\", \"/var/log/btmp\", \"/var/log/lastlog\", \"/var/log/faillog\",
      \"/var/log/syslog\", \"/var/log/messages\", \"/var/log/secure\", \"/var/log/auth.log\",
      \"/var/log/boot.log\", \"/var/log/kern.log\"] && process.comm not in [\"dockerd\",
      \"containerd\"]","category":"File Activity","creationDate":0,"updateDate":1704404424465,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"xns-u7l-cxs","attributes":{"version":1,"name":"certutil_usage","description":"Certutil
      was executed to transmit or decode a potentially malicious file","expression":"exec.file.name
      == \"certutil.exe\" && ((exec.cmdline =~ \"*urlcache*\" && exec.cmdline =~ \"*split*\")
      || exec.cmdline =~ \"*decode*\")","category":"Process Activity","creationDate":0,"updateDate":1704404424457,"filters":["os
      == \"windows\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"hxr-rjo-6am","attributes":{"version":1,"name":"open_msr_writes","description":"A
      process opened a model-specific register (MSR) configuration file","expression":"open.file.path
      == \"/sys/module/msr/parameters/allow_writes\" && open.flags & O_CREAT|O_TRUNC|O_RDWR|O_WRONLY
      > 0","category":"File Activity","creationDate":0,"updateDate":1704404424453,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"jzh-eac-blf","attributes":{"version":1,"name":"exec_wrmsr","description":"The
      wrmsr program executed","expression":"exec.comm == \"wrmsr\"","category":"Process
      Activity","creationDate":0,"updateDate":1704404424444,"filters":["os == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"mdd-iec-z0k","attributes":{"version":14,"name":"database_shell_execution","description":"A
      database application spawned a shell, shell utility, or HTTP utility","expression":"(exec.file.path
      in [ \"/bin/dash\",\n  \"/usr/bin/dash\",\n  \"/bin/sh\",\n  \"/bin/static-sh\",\n  \"/usr/bin/sh\",\n  \"/bin/bash\",\n  \"/usr/bin/bash\",\n  \"/bin/bash-static\",\n  \"/usr/bin/zsh\",\n  \"/usr/bin/ash\",\n  \"/usr/bin/csh\",\n  \"/usr/bin/ksh\",\n  \"/usr/bin/tcsh\",\n  \"/usr/lib/initramfs-tools/bin/busybox\",\n  \"/bin/busybox\",\n  \"/usr/bin/fish\",\n  \"/bin/ksh93\",\n  \"/bin/rksh\",\n  \"/bin/rksh93\",\n  \"/bin/lksh\",\n  \"/bin/mksh\",\n  \"/bin/mksh-static\",\n  \"/usr/bin/csharp\",\n  \"/bin/posh\",\n  \"/usr/bin/rc\",\n  \"/bin/sash\",\n  \"/usr/bin/yash\",\n  \"/bin/zsh5\",\n  \"/bin/zsh5-static\"
      ] ||\n exec.comm in [\"wget\", \"curl\", \"lwp-download\"] ||\n exec.file.path
      in [\"/bin/cat\",\"/bin/chgrp\",\"/bin/chmod\",\"/bin/chown\",\"/bin/cp\",\"/bin/date\",\"/bin/dd\",\"/bin/df\",\"/bin/dir\",\"/bin/echo\",\"/bin/ln\",\"/bin/ls\",\"/bin/mkdir\",\"/bin/mknod\",\"/bin/mktemp\",\"/bin/mv\",\"/bin/pwd\",\"/bin/readlink\",\"/bin/rm\",\"/bin/rmdir\",\"/bin/sleep\",\"/bin/stty\",\"/bin/sync\",\"/bin/touch\",\"/bin/uname\",\"/bin/vdir\",\"/usr/bin/arch\",\"/usr/bin/b2sum\",\"/usr/bin/base32\",\"/usr/bin/base64\",\"/usr/bin/basename\",\"/usr/bin/chcon\",\"/usr/bin/cksum\",\"/usr/bin/comm\",\"/usr/bin/csplit\",\"/usr/bin/cut\",\"/usr/bin/dircolors\",\"/usr/bin/dirname\",\"/usr/bin/du\",\"/usr/bin/env\",\"/usr/bin/expand\",\"/usr/bin/expr\",\"/usr/bin/factor\",\"/usr/bin/fmt\",\"/usr/bin/fold\",\"/usr/bin/groups\",\"/usr/bin/head\",\"/usr/bin/hostid\",\"/usr/bin/id\",\"/usr/bin/install\",\"/usr/bin/join\",\"/usr/bin/link\",\"/usr/bin/logname\",\"/usr/bin/md5sum\",\"/usr/bin/md5sum.textutils\",\"/usr/bin/mkfifo\",\"/usr/bin/nice\",\"/usr/bin/nl\",\"/usr/bin/nohup\",\"/usr/bin/nproc\",\"/usr/bin/numfmt\",\"/usr/bin/od\",\"/usr/bin/paste\",\"/usr/bin/pathchk\",\"/usr/bin/pinky\",\"/usr/bin/pr\",\"/usr/bin/printenv\",\"/usr/bin/printf\",\"/usr/bin/ptx\",\"/usr/bin/realpath\",\"/usr/bin/runcon\",\"/usr/bin/seq\",\"/usr/bin/sha1sum\",\"/usr/bin/sha224sum\",\"/usr/bin/sha256sum\",\"/usr/bin/sha384sum\",\"/usr/bin/sha512sum\",\"/usr/bin/shred\",\"/usr/bin/shuf\",\"/usr/bin/sort\",\"/usr/bin/split\",\"/usr/bin/stat\",\"/usr/bin/stdbuf\",\"/usr/bin/sum\",\"/usr/bin/tac\",\"/usr/bin/tail\",\"/usr/bin/tee\",\"/usr/bin/test\",\"/usr/bin/timeout\",\"/usr/bin/tr\",\"/usr/bin/truncate\",\"/usr/bin/tsort\",\"/usr/bin/tty\",\"/usr/bin/unexpand\",\"/usr/bin/uniq\",\"/usr/bin/unlink\",\"/usr/bin/users\",\"/usr/bin/wc\",\"/usr/bin/who\",\"/usr/bin/whoami\",\"/usr/sbin/chroot\"])
      &&\nprocess.parent.file.name in [\"mysqld\", \"mongod\", \"postgres\"] &&\n!(process.parent.file.name
      == \"initdb\" &&\nexec.args == \"-c locale -a\") &&\n!(process.parent.file.name
      == \"postgres\" &&\nexec.args == ~\"*pg_wal*\")","category":"Process Activity","creationDate":1617722069155,"updateDate":1704404408433,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"wic-due-xxn","attributes":{"version":2,"name":"pci_11_5_critical_binaries_open_v2","description":"Critical
      system binaries may have been modified","expression":"(\n    open.flags & (O_CREAT|O_TRUNC|O_RDWR|O_WRONLY)
      > 0 &&\n    open.file.path in [ ~\"/bin/*\", ~\"/sbin/*\", ~\"/usr/bin/*\",
      ~\"/usr/sbin/*\", ~\"/usr/local/bin/*\", ~\"/usr/local/sbin/*\", ~\"/boot/**\"
      ]\n    && process.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/containerd\", \"/usr/local/bin/containerd\",
      \"/usr/bin/dockerd\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]\n    && process.ancestors.file.path
      not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)
      && container.created_at > 90s","category":"File Activity","creationDate":0,"updateDate":1704404408077,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"ie9-9ii-vjx","attributes":{"version":18,"name":"nsswitch_conf_mod_chmod","description":"nsswitch
      may have been modified without authorization","expression":"(\n    (chmod.file.path
      in [ \"/etc/nsswitch.conf\" ])\n) && chmod.file.destination.mode != chmod.file.mode
      && process.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/containerd\", \"/usr/local/bin/containerd\",
      \"/usr/bin/dockerd\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]","category":"File
      Activity","creationDate":1606142958657,"updateDate":1704404407750,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"1ez-rlj-tiq","attributes":{"version":2,"name":"nsswitch_conf_mod_open_v2","description":"nsswitch
      may have been modified without authorization","expression":"(\n    open.flags
      & ((O_RDWR|O_WRONLY|O_CREAT)) > 0 &&\n    (open.file.path in [ \"/etc/nsswitch.conf\"
      ])\n) && container.created_at > 90s && process.file.path not in [~\"/usr/bin/apt*\",
      \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/containerd\",
      \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]","category":"File
      Activity","creationDate":0,"updateDate":1704404407660,"filters":["os == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"oi0-rk3-alq","attributes":{"version":2,"name":"ssl_certificate_tampering_open_v2","description":"SSL
      certificates may have been tampered with","expression":"(\n    open.flags &
      (O_CREAT|O_RDWR|O_WRONLY) > 0 &&\n    (open.file.path in [ ~\"/etc/ssl/certs/**\",
      ~\"/etc/pki/**\" ])\n)\n&& process.file.path != \"/usr/sbin/update-ca-certificates\"\n&&
      process.ancestors.file.path != \"/usr/sbin/update-ca-certificates\"\n&& process.ancestors.file.path
      not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n&&
      process.file.name !~ \"runc*\"\n&& container.created_at > 90s","category":"File
      Activity","creationDate":0,"updateDate":1704404407651,"filters":["os == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"vzp-pj6-nlx","attributes":{"version":19,"name":"nsswitch_conf_mod_chown","description":"nsswitch
      may have been modified without authorization","expression":"(\n    (chown.file.path
      in [ \"/etc/nsswitch.conf\" ])\n) && (chown.file.destination.uid != chown.file.uid
      || chown.file.destination.gid != chown.file.gid) && process.file.path not in
      [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/containerd\", \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]","category":"File Activity","creationDate":1606142958657,"updateDate":1704404407506,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"wbw-rqf-s3a","attributes":{"version":18,"name":"nsswitch_conf_mod_open","description":"nsswitch
      may have been modified without authorization","expression":"(\n    open.flags
      & ((O_RDWR|O_WRONLY|O_CREAT)) > 0 &&\n    (open.file.path in [ \"/etc/nsswitch.conf\"
      ])\n) && process.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/containerd\", \"/usr/local/bin/containerd\",
      \"/usr/bin/dockerd\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]","category":"File
      Activity","creationDate":1606142958657,"updateDate":1704404407503,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"vkp-n2c-4el","attributes":{"version":3,"name":"credential_modified_open_v2","description":"Sensitive
      credential files were modified using a non-standard tool","expression":"(\n    open.flags
      & ((O_CREAT|O_RDWR|O_WRONLY|O_TRUNC)) > 0 &&\n    (open.file.path in [ \"/etc/shadow\",
      \"/etc/gshadow\" ])\n    && process.file.path not in [ \"/sbin/vipw\", \"/usr/sbin/vipw\",
      \"/sbin/vigr\", \"/usr/sbin/vigr\", \"/usr/bin/containerd\", \"/usr/local/bin/containerd\",
      \"/usr/bin/dockerd\", \"/usr/local/bin/dockerd\", \"/usr/sbin/groupadd\", \"/usr/sbin/useradd\",
      \"/usr/sbin/usermod\", \"/usr/sbin/userdel\", \"/usr/bin/gpasswd\", \"/usr/bin/chage\",
      \"/usr/sbin/chpasswd\", \"/usr/bin/passwd\" ]\n    && process.ancestors.file.path
      not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)
      && container.created_at > 90s","category":"File Activity","creationDate":0,"updateDate":1704404407503,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"ir2-b4s-gfn","attributes":{"version":3,"name":"ssh_authorized_keys_open_v2","description":"SSH
      modified keys may have been modified","expression":"(\n    open.flags & (O_CREAT|O_TRUNC|O_RDWR|O_WRONLY)
      > 0 &&\n    open.file.name in [ \"authorized_keys\", \"authorized_keys2\" ]
      && (open.file.path in [ ~\"/root/.ssh/*\", ~\"/home/*/.ssh/*\", ~\"/var/lib/*/.ssh/*\"
      ])\n) && container.created_at > 90s","category":"File Activity","creationDate":0,"updateDate":1704404407501,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"c2x-vcd-5b4","attributes":{"version":3,"name":"package_management_in_container_v2","description":"Package
      management was detected in a conatiner outside of container start_up","expression":"exec.file.path
      in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]
      && container.id != \"\" && container.created_at > 90s","category":"Process Activity","creationDate":0,"updateDate":1704404407500,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"nmo-zeb-pga","attributes":{"version":3,"name":"suspicious_suid_execution","description":"Recently
      written or modified suid file has been executed","expression":"((process.file.mode
      & S_ISUID > 0) && process.file.modification_time < 30s) && exec.file.name !=
      \"\" && process.ancestors.file.path not in [\"/opt/datadog-agent/embedded/bin/agent\",
      \"/opt/datadog-agent/embedded/bin/system-probe\", \"/opt/datadog-agent/embedded/bin/security-agent\",
      \"/opt/datadog-agent/embedded/bin/process-agent\", \"/opt/datadog-agent/bin/agent/agent\",
      \"/opt/datadog/apm/inject/auto_inject_runc\", \"/usr/bin/dd-host-install\",
      \"/usr/bin/dd-host-container-install\", \"/usr/bin/dd-container-install\", \"/opt/datadog-agent/bin/datadog-cluster-agent\"]","category":"Process
      Activity","creationDate":0,"updateDate":1704404407500,"filters":["os == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"crl-kkv-3cm","attributes":{"version":3,"name":"tde_testing_tampering","description":"testing
      only","expression":"exec.comm == \"abcdefgh\"","category":"Process Activity","creationAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","creationDate":1703684038882,"updateAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","updateDate":1704280473848,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":false,"creator":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"},"updater":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"}},"type":"agent_rule"},{"id":"s6d-kk2-xoh","attributes":{"version":1,"name":"tde_malware_tunneling_and_port_forwarding_technique_used","description":"Tunneling
      and port forwarding tool used","expression":"((exec.comm == \"pivotnacci\" ||
      exec.comm == \"gost\") && process.args in [r\".*(-L|-C|-R).*\"])||(exec.comm
      in [\"ssh\", \"sshd\"] && process.args in [r\".*(-R|-L|-D|w).*\"] && process.args
      in [r\"((25[0-5]|(2[0-4]|1\\d|[1-9])\\d)\\.?\\b){4}\"] ) || (exec.comm == \"sshuttle\"
      && process.args in [r\".*(-r|--remote|-l|--listen).*\"]) || (exec.comm == \"socat\"
      && process.args in [r\".*(TCP4-LISTEN:|SOCKS).*\"]) || (exec.comm in [\"iodine\",
      \"iodined\", \"dnscat\", \"hans\", \"hans-ubuntu\", \"ptunnel-ng\", \"ssf\",
      \"3proxy\", \"ngrok\"] && process.parent.comm in [\"bash\", \"dash\", \"ash\",
      \"sh\", \"tcsh\", \"csh\", \"zsh\", \"ksh\", \"fish\"])","category":"Process
      Activity","creationAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","creationDate":1703183027074,"updateAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","updateDate":1703183027074,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":false,"creator":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"},"updater":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"}},"type":"agent_rule"},{"id":"iqa-7wg-rxt","attributes":{"version":1,"name":"tde_malware_privileged_processes_or_sshd_traced","description":"A
      process is tracing privileged processes or sshd for possible credential dumping","expression":"((ptrace.tracee.euid==0
      && ptrace.tracee.uid ==0)||ptrace.tracee.comm in [~\"*sshd*\"]) && process.comm
      not in [\"dlv\"]","category":"Kernel Activity","creationAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","creationDate":1703180056299,"updateAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","updateDate":1703180056299,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":false,"creator":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"},"updater":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"}},"type":"agent_rule"},{"id":"w8h-hbp-12m","attributes":{"version":1,"name":"tde_malware_system_logs_deleted","description":"A
      process deleted common system log files","expression":"unlink.file.path in [\"/var/run/utmp\",
      \"/var/log/wtmp\", \"/var/log/btmp\", \"/var/log/lastlog\", \"/var/log/faillog\",
      \"/var/log/syslog\", \"/var/log/messages\", \"/var/log/secure\", \"/var/log/auth.log\",
      \"/var/log/boot.log\", \"/var/log/kern.log\"] && process.comm !=\"dockerd\"","category":"File
      Activity","creationAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","creationDate":1703178864120,"updateAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","updateDate":1703178864120,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":false,"creator":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"},"updater":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"}},"type":"agent_rule"},{"id":"wxv-xlp-34y","attributes":{"version":1,"name":"tde_malware_files_with_extensions_created","description":"Multiple
      files with extensions created under common user directories","expression":"rename.file.path
      in [~\"/home/**\", ~\"/root/**\", ~\"/bin/**\", ~\"/usr/bin/**\", ~\"/var/log/**\",
      ~\"/var/lib/log/**\", ~\"/var/backup/*\", ~\"/var/www/**\"] && rename.file.destination.name
      in [r\"\\.[0-9a-z]+$\"] && rename.file.destination.name not in [r\".*\\.(lock|dbtmp|log|journal|ini|sh|json|yml|tmp|snap|txt|pyc|stat|hcl|[0-9])+$\"]
      && process.comm not in [\"python\",\"python3\",\"agent\",\"security-agent\",\"kubectl\",\"kubelet\",\"datadog-cluster\"]","category":"File
      Activity","creationAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","creationDate":1703174626572,"updateAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","updateDate":1703174626572,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":false,"creator":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"},"updater":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"}},"type":"agent_rule"},{"id":"3fl-m83-qqt","attributes":{"version":1,"name":"tde_malware_proxychains_executed","description":"Proxychaining
      technique used","expression":"exec.comm == \"proxychains\"","category":"Process
      Activity","creationAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","creationDate":1703171141223,"updateAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","updateDate":1703171141223,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":false,"creator":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"},"updater":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"}},"type":"agent_rule"},{"id":"gha-zgq-l5p","attributes":{"version":1,"name":"tde_malware_egress_traffic_allowed_iptables","description":"iptables
      used to allow egress traffic","expression":"exec.comm == \"iptables\" && process.args
      in [r\".*OUTPUT.*((25[0-5]|(2[0-4]|1\\d|[1-9]|)\\d)\\.?\\b){4}.*ACCEPT\"] &&
      process.args not in [r\"(127\\.)|(10\\.)|(172\\.1[6-9]\\.)|(172\\.2[0-9]\\.)|(172\\.3[0-1]|\\.)|(192\\.168\\.)|(169\\.254\\.)\"]","category":"Process
      Activity","creationAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","creationDate":1703167436195,"updateAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","updateDate":1703167436195,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":false,"creator":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"},"updater":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"}},"type":"agent_rule"},{"id":"n9z-ini-wrv","attributes":{"version":1,"name":"tde_malware_kernel_module_loaded_from_tmp","description":"Kernel
      module loaded from common tmp directories","expression":"load_module.file.path
      in [ ~\"/tmp/**\", ~\"/var/tmp/**\" ]","category":"Kernel Activity","creationAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","creationDate":1703167436172,"updateAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","updateDate":1703167436172,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":false,"creator":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"},"updater":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"}},"type":"agent_rule"},{"id":"4jr-tig-mue","attributes":{"version":1,"name":"tde_malware_libpam_hooked_using_ebpf","description":"Libpam.so
      library hooked using ebpf","expression":"bpf.cmd == BPF_MAP_CREATE && process.args
      in [r\".*libpam.so.*\"]","category":"Kernel Activity","creationAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","creationDate":1703160289438,"updateAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","updateDate":1703160289438,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":false,"creator":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"},"updater":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"}},"type":"agent_rule"},{"id":"f24-lwh-8pz","attributes":{"version":3,"name":"ps_discovery","description":"Processes
      were listed using the ps command","expression":"exec.comm == \"ps\" && exec.argv
      not in [\"-p\", \"--pid\"] && process.ancestors.file.name not in [\"qualys-cloud-agent\",
      \"amazon-ssm-agent\"]","category":"Process Activity","creationDate":0,"updateAuthorUuId":"309c6bc6-6e68-11ec-b3fe-da7ad0900002","updateDate":1702489222385,"filters":[],"actions":[],"agentConstraint":"","enabled":false,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"Matt
      Mills","handle":"matt.mills@datadoghq.com"}},"type":"agent_rule"},{"id":"esa-kku-q4m","attributes":{"version":8,"name":"common_net_intrusion_util","description":"A
      network utility (nmap) commonly used in intrusion attacks was executed","expression":"exec.file.name
      in [\"nmap\", \"masscan\", \"fping\", \"zgrab\", \"zgrab2\", \"rustscan\", \"pnscan\"]
      && exec.args_flags not in [\"V\", \"version\"]","category":"Process Activity","creationDate":0,"updateAuthorUuId":"de54768c-eb9f-11e9-a77a-cb84d47a0c16","updateDate":1700488339815,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":false,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"C\u00e9cile
      Guyon","handle":"cecile.guyon@datadoghq.com"}},"type":"agent_rule"},{"id":"ll4-n4d-zsq","attributes":{"version":8,"name":"k8s_pod_service_account_token_accessed","description":"The
      Kubernetes pod service account token was accessed","expression":"open.file.path
      in [~\"/var/run/secrets/kubernetes.io/serviceaccount/**\", ~\"/run/secrets/kubernetes.io/serviceaccount/**\"]
      && open.file.name == \"token\" && process.file.path not in [\"/opt/datadog-agent/embedded/bin/agent\",
      \"/opt/datadog-agent/embedded/bin/system-probe\", \"/opt/datadog-agent/embedded/bin/security-agent\",
      \"/opt/datadog-agent/embedded/bin/process-agent\", \"/opt/datadog-agent/bin/agent/agent\",
      \"/opt/datadog/apm/inject/auto_inject_runc\", \"/usr/bin/dd-host-install\",
      \"/usr/bin/dd-host-container-install\", \"/usr/bin/dd-container-install\", \"/opt/datadog-agent/bin/datadog-cluster-agent\"]
      && process.file.path not in  [\"/usr/bin/cilium-agent\", \"/coredns\", \"/usr/bin/cilium-operator\",
      \"/manager\", \"/fluent-bit/bin/fluent-bit\", \"/usr/local/bin/cloud-node-manager\",
      \"/secrets-store-csi\", \"/bin/secrets-store-csi-driver-provider-aws\", \"/usr/bin/calico-node\",
      \"/opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent\", \"/nginx-ingress-controller\",
      \"/cluster-autoscaler\", \"/cluster-proportional-autoscaler\", \"/haproxy-ingress-controller\",
      \"/kube-state-metrics\", \"/fluent-bit-gke-exporter\", \"/bin/external-secrets\",
      \"/node-termination-handler\", \"/fluent-bit-gke-exporter\"] && process.ancestors.file.path
      not in [\"/opt/datadog-agent/embedded/bin/agent\", \"/opt/datadog-agent/embedded/bin/system-probe\",
      \"/opt/datadog-agent/embedded/bin/security-agent\", \"/opt/datadog-agent/embedded/bin/process-agent\",
      \"/opt/datadog-agent/bin/agent/agent\", \"/opt/datadog/apm/inject/auto_inject_runc\",
      \"/usr/bin/dd-host-install\", \"/usr/bin/dd-host-container-install\", \"/usr/bin/dd-container-install\",
      \"/opt/datadog-agent/bin/datadog-cluster-agent\"]","category":"File Activity","creationDate":0,"updateDate":1699614647574,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"o5b-3eb-em5","attributes":{"version":4,"name":"interactive_shell_in_container","description":"An
      interactive shell was started inside of a container","expression":"exec.file.path
      in [ \"/bin/dash\",\n  \"/usr/bin/dash\",\n  \"/bin/sh\",\n  \"/bin/static-sh\",\n  \"/usr/bin/sh\",\n  \"/bin/bash\",\n  \"/usr/bin/bash\",\n  \"/bin/bash-static\",\n  \"/usr/bin/zsh\",\n  \"/usr/bin/ash\",\n  \"/usr/bin/csh\",\n  \"/usr/bin/ksh\",\n  \"/usr/bin/tcsh\",\n  \"/usr/lib/initramfs-tools/bin/busybox\",\n  \"/bin/busybox\",\n  \"/usr/bin/fish\",\n  \"/bin/ksh93\",\n  \"/bin/rksh\",\n  \"/bin/rksh93\",\n  \"/bin/lksh\",\n  \"/bin/mksh\",\n  \"/bin/mksh-static\",\n  \"/usr/bin/csharp\",\n  \"/bin/posh\",\n  \"/usr/bin/rc\",\n  \"/bin/sash\",\n  \"/usr/bin/yash\",\n  \"/bin/zsh5\",\n  \"/bin/zsh5-static\"
      ] && exec.args_flags in [\"i\"] && container.id !=\"\"","category":"Process
      Activity","creationDate":1627392835654,"updateDate":1699614634532,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"pm7-0bt-lbp","attributes":{"version":19,"name":"ssh_authorized_keys_unlink","description":"SSH
      modified keys may have been modified","expression":"(\n    unlink.file.name
      in [ \"authorized_keys\", \"authorized_keys2\" ] && (unlink.file.path in [ ~\"/root/.ssh/*\",
      ~\"/home/*/.ssh/*\", ~\"/var/lib/*/.ssh/*\" ])\n)","category":"File Activity","creationDate":1642158535302,"updateDate":1699614632218,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"6ss-gx0-o0l","attributes":{"version":2,"name":"exec_lsmod","description":"Kernel
      modules were listed using the lsmod command","expression":"exec.comm == \"lsmod\"","category":"Process
      Activity","creationDate":0,"updateDate":1699614632049,"filters":["os == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"bay-wrp-htk","attributes":{"version":2,"name":"omigod","description":"Omiagent
      spawns a privileged child process","expression":"exec.uid >= 0 && process.ancestors.file.name
      == \"omiagent\"","category":"Process Activity","creationDate":1636729662305,"updateDate":1699614629763,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"5vv-6pw-c3z","attributes":{"version":2,"name":"exec_whoami","description":"The
      whoami command was executed","expression":"exec.comm == \"whoami\"","category":"Process
      Activity","creationDate":0,"updateDate":1699614622203,"filters":["os == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"lb9-6hv-6k2","attributes":{"version":22,"name":"systemd_modification_utimes","description":"A
      service may have been modified without authorization","expression":"(\n    (utimes.file.path
      in [ ~\"/lib/systemd/system/**\", ~\"/usr/lib/systemd/system/**\", ~\"/etc/systemd/system/**\"
      ])\n    && process.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\",
      \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\",
      \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)","category":"File
      Activity","creationDate":0,"updateDate":1699614620744,"filters":["os == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"u8t-ums-bdn","attributes":{"version":9,"name":"suspicious_container_client","description":"A
      container management utility was executed in a container","expression":"exec.file.name
      in [\"docker\", \"kubectl\"] && container.id != \"\"","category":"Process Activity","creationDate":1617722068555,"updateDate":1699614618370,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"3kb-bma-rya","attributes":{"version":4,"name":"auditd_config_modified","description":"The
      auditd configuration file was modified without using auditctl","expression":"open.file.path
      == \"/etc/audit/auditd.conf\" && open.flags & (O_CREAT|O_TRUNC|O_RDWR|O_WRONLY)
      > 0 && process.file.name != \"auditctl\"","category":"File Activity","creationDate":0,"updateDate":1699614615388,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"lag-ggh-k1o","attributes":{"version":2,"name":"network_sniffing_tool","description":"Local
      account groups were enumerated after container start up","expression":"exec.file.name
      in [\"tcpdump\", \"tshark\"]","category":"Process Activity","creationDate":0,"updateDate":1699614614908,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"o4t-6hb-gsb","attributes":{"version":22,"name":"systemd_modification_unlink","description":"A
      service may have been modified without authorization","expression":"(\n    (unlink.file.path
      in [ ~\"/lib/systemd/system/**\", ~\"/usr/lib/systemd/system/**\", ~\"/etc/systemd/system/**\"
      ])\n    && process.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\",
      \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\",
      \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)","category":"File
      Activity","creationDate":0,"updateDate":1699614614159,"filters":["os == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"cp9-wqy-ie5","attributes":{"version":19,"name":"ssh_authorized_keys_rename","description":"SSH
      modified keys may have been modified","expression":"(\n    rename.file.name
      in [ \"authorized_keys\", \"authorized_keys2\" ] && (rename.file.path in [ ~\"/root/.ssh/*\",
      ~\"/home/*/.ssh/*\", ~\"/var/lib/*/.ssh/*\" ]\n    || rename.file.destination.path
      in [ ~\"/root/.ssh/*\", ~\"/home/*/.ssh/*\", ~\"/var/lib/*/.ssh/*\" ])\n)","category":"File
      Activity","creationDate":1642158535225,"updateDate":1699614610736,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"mmd-hm9-nul","attributes":{"version":28,"name":"pci_11_5_critical_binaries_unlink","description":"Critical
      system binaries may have been modified","expression":"(\n    (unlink.file.path
      in [ ~\"/bin/*\", ~\"/sbin/*\", ~\"/usr/bin/*\", ~\"/usr/sbin/*\", ~\"/usr/local/bin/*\",
      ~\"/usr/local/sbin/*\", ~\"/boot/**\" ])\n    && process.file.path not in [~\"/usr/bin/apt*\",
      \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/containerd\",
      \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]\n    &&
      process.ancestors.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\",
      \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)","category":"File Activity","creationDate":1642158535384,"updateDate":1699614610678,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"sjc-t7h-y3g","attributes":{"version":2,"name":"sudoers_policy_modified_open","description":"Sudoers
      policy file may have been modified without authorization","expression":"\n(open.flags
      & (O_CREAT|O_TRUNC|O_RDWR|O_WRONLY) > 0 &&\n(open.file.path == \"/etc/sudoers\"))
      && process.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\",
      \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]","category":"File Activity","creationDate":0,"updateDate":1699614610658,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"wty-l8v-uum","attributes":{"version":22,"name":"systemd_modification_open","description":"A
      service may have been modified without authorization","expression":"(\n    open.flags
      & (O_CREAT|O_RDWR|O_WRONLY) > 0 &&\n    (open.file.path in [ ~\"/lib/systemd/system/**\",
      ~\"/usr/lib/systemd/system/**\", ~\"/etc/systemd/system/**\" ])\n    && process.file.path
      not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)","category":"File
      Activity","creationDate":1642158534936,"updateDate":1699614610639,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"1fj-fmh-6kw","attributes":{"version":4,"name":"compile_after_delivery","description":"A
      compiler wrote a suspicious file in a container","expression":"open.flags &
      O_CREAT > 0\n&& (\n  (open.file.path =~ \"/tmp/**\" && open.file.name in [~\"*.ko\",
      ~\".*\"])\n  || open.file.path in [~\"/var/tmp/**\", ~\"/dev/shm/**\", ~\"/root/**\",
      ~\"*/bin/*\", ~\"/usr/local/lib/**\"]\n)\n&& (process.comm in [\"javac\", \"clang\",
      \"gcc\",\"bcc\"] || process.ancestors.comm in [\"javac\", \"clang\", \"gcc\",\"bcc\"])\n&&
      process.file.name not in [\"pip\", ~\"python*\"]\n&& container.id != \"\"","category":"File
      Activity","creationDate":0,"updateAuthorUuId":"82ba1758-696c-11ea-828d-fb376ef71e70","updateDate":1699614610524,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"qox-gue-mq8","attributes":{"version":3,"name":"pwnkit_privilege_escalation","description":"A
      process was spawned with indicators of exploitation of CVE-2021-4034","expression":"(exec.file.path
      == \"/usr/bin/pkexec\" && exec.envs in [~\"*SHELL*\", ~\"*PATH*\"] && exec.envs
      not in [~\"*DISPLAY*\", ~\"*DESKTOP_SESSION*\"] && exec.uid != 0)","category":"Process
      Activity","creationDate":1643639113864,"updateDate":1699614610455,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"dlp-tcr-jju","attributes":{"version":2,"name":"kmod_list","description":"Kernel
      modules were listed using the kmod command","expression":"exec.comm == \"kmod\"
      && exec.args in [~\"*list*\"]","category":"Process Activity","creationDate":0,"updateDate":1699614610436,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"knr-3tx-cl8","attributes":{"version":2,"name":"java_shell_execution_parent","description":"A
      java process spawned a shell, shell utility, or HTTP utility","expression":"(exec.file.path
      in [ \"/bin/dash\",\n  \"/usr/bin/dash\",\n  \"/bin/sh\",\n  \"/bin/static-sh\",\n  \"/usr/bin/sh\",\n  \"/bin/bash\",\n  \"/usr/bin/bash\",\n  \"/bin/bash-static\",\n  \"/usr/bin/zsh\",\n  \"/usr/bin/ash\",\n  \"/usr/bin/csh\",\n  \"/usr/bin/ksh\",\n  \"/usr/bin/tcsh\",\n  \"/usr/lib/initramfs-tools/bin/busybox\",\n  \"/bin/busybox\",\n  \"/usr/bin/fish\",\n  \"/bin/ksh93\",\n  \"/bin/rksh\",\n  \"/bin/rksh93\",\n  \"/bin/lksh\",\n  \"/bin/mksh\",\n  \"/bin/mksh-static\",\n  \"/usr/bin/csharp\",\n  \"/bin/posh\",\n  \"/usr/bin/rc\",\n  \"/bin/sash\",\n  \"/usr/bin/yash\",\n  \"/bin/zsh5\",\n  \"/bin/zsh5-static\"
      ] ||\n exec.comm in [\"wget\", \"curl\", \"lwp-download\"] ||\n exec.file.path
      in [\"/bin/cat\",\"/bin/chgrp\",\"/bin/chmod\",\"/bin/chown\",\"/bin/cp\",\"/bin/date\",\"/bin/dd\",\"/bin/df\",\"/bin/dir\",\"/bin/echo\",\"/bin/ln\",\"/bin/ls\",\"/bin/mkdir\",\"/bin/mknod\",\"/bin/mktemp\",\"/bin/mv\",\"/bin/pwd\",\"/bin/readlink\",\"/bin/rm\",\"/bin/rmdir\",\"/bin/sleep\",\"/bin/stty\",\"/bin/sync\",\"/bin/touch\",\"/bin/uname\",\"/bin/vdir\",\"/usr/bin/arch\",\"/usr/bin/b2sum\",\"/usr/bin/base32\",\"/usr/bin/base64\",\"/usr/bin/basename\",\"/usr/bin/chcon\",\"/usr/bin/cksum\",\"/usr/bin/comm\",\"/usr/bin/csplit\",\"/usr/bin/cut\",\"/usr/bin/dircolors\",\"/usr/bin/dirname\",\"/usr/bin/du\",\"/usr/bin/env\",\"/usr/bin/expand\",\"/usr/bin/expr\",\"/usr/bin/factor\",\"/usr/bin/fmt\",\"/usr/bin/fold\",\"/usr/bin/groups\",\"/usr/bin/head\",\"/usr/bin/hostid\",\"/usr/bin/id\",\"/usr/bin/install\",\"/usr/bin/join\",\"/usr/bin/link\",\"/usr/bin/logname\",\"/usr/bin/md5sum\",\"/usr/bin/md5sum.textutils\",\"/usr/bin/mkfifo\",\"/usr/bin/nice\",\"/usr/bin/nl\",\"/usr/bin/nohup\",\"/usr/bin/nproc\",\"/usr/bin/numfmt\",\"/usr/bin/od\",\"/usr/bin/paste\",\"/usr/bin/pathchk\",\"/usr/bin/pinky\",\"/usr/bin/pr\",\"/usr/bin/printenv\",\"/usr/bin/printf\",\"/usr/bin/ptx\",\"/usr/bin/realpath\",\"/usr/bin/runcon\",\"/usr/bin/seq\",\"/usr/bin/sha1sum\",\"/usr/bin/sha224sum\",\"/usr/bin/sha256sum\",\"/usr/bin/sha384sum\",\"/usr/bin/sha512sum\",\"/usr/bin/shred\",\"/usr/bin/shuf\",\"/usr/bin/sort\",\"/usr/bin/split\",\"/usr/bin/stat\",\"/usr/bin/stdbuf\",\"/usr/bin/sum\",\"/usr/bin/tac\",\"/usr/bin/tail\",\"/usr/bin/tee\",\"/usr/bin/test\",\"/usr/bin/timeout\",\"/usr/bin/tr\",\"/usr/bin/truncate\",\"/usr/bin/tsort\",\"/usr/bin/tty\",\"/usr/bin/unexpand\",\"/usr/bin/uniq\",\"/usr/bin/unlink\",\"/usr/bin/users\",\"/usr/bin/wc\",\"/usr/bin/who\",\"/usr/bin/whoami\",\"/usr/sbin/chroot\"])\n&&
      process.parent.file.name == \"java\"","category":"Process Activity","creationDate":0,"updateDate":1699614610329,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"r8w-red-u4k","attributes":{"version":2,"name":"kernel_module_load_from_memory","description":"A
      kernel module was loaded from memory","expression":"load_module.loaded_from_memory
      == true","category":"Kernel Activity","creationDate":1650293718630,"updateDate":1699614610258,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"jnv-fq4-f23","attributes":{"version":2,"name":"sudoers_policy_modified_chmod","description":"Sudoers
      policy file may have been modified without authorization","expression":"(\n    (chmod.file.path
      == \"/etc/sudoers\") \n) && chmod.file.destination.mode != chmod.file.mode &&
      process.ancestors.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\",
      \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]","category":"File Activity","creationDate":0,"updateDate":1699614610235,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"ji5-8o4-btp","attributes":{"version":2,"name":"kubernetes_dns_enumeration","description":"Kubernetes
      DNS enumeration","expression":"dns.question.name == \"any.any.svc.cluster.local\"
      && dns.question.type == SRV && container.id != \"\"","category":"Network Activity","creationDate":0,"updateDate":1699614610050,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"3j1-wdg-qsg","attributes":{"version":28,"name":"pci_11_5_critical_binaries_open","description":"Critical
      system binaries may have been modified","expression":"(\n    open.flags & (O_CREAT|O_TRUNC|O_RDWR|O_WRONLY)
      > 0 &&\n    open.file.path in [ ~\"/bin/*\", ~\"/sbin/*\", ~\"/usr/bin/*\",
      ~\"/usr/sbin/*\", ~\"/usr/local/bin/*\", ~\"/usr/local/sbin/*\", ~\"/boot/**\"
      ]\n    && process.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/containerd\", \"/usr/local/bin/containerd\",
      \"/usr/bin/dockerd\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]\n    && process.ancestors.file.path
      not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)","category":"File
      Activity","creationDate":1642158535263,"updateDate":1699614610036,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"vaz-icd-nel","attributes":{"version":2,"name":"net_file_download","description":"A
      suspicious file was written by a network utility","expression":"open.flags &
      O_CREAT > 0 && process.comm in [\"wget\", \"curl\", \"lwp-download\"]\n&& (\n  (open.file.path
      =~ \"/tmp/**\" && open.file.name in [~\"*.sh\", ~\"*.c\", ~\"*.so\", ~\"*.ko\"])\n  ||
      open.file.path in [~\"/usr/**\", ~\"/lib/**\", ~\"/etc/**\", ~\"/var/tmp/**\",
      ~\"/dev/shm/**\"]\n)","category":"File Activity","creationDate":0,"updateDate":1699614609925,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"hir-1j3-tsx","attributes":{"version":20,"name":"ssh_authorized_keys_chown","description":"SSH
      modified keys may have been modified","expression":"(\n    chown.file.name in
      [ \"authorized_keys\", \"authorized_keys2\" ] && (chown.file.path in [ ~\"/root/.ssh/*\",
      ~\"/home/*/.ssh/*\", ~\"/var/lib/*/.ssh/*\" ])\n) && (chown.file.destination.uid
      != chown.file.uid || chown.file.destination.gid != chown.file.gid)","category":"File
      Activity","creationDate":1642158534934,"updateDate":1699614609845,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"mag-ijd-ucx","attributes":{"version":2,"name":"sudoers_policy_modified_utimes","description":"Sudoers
      policy file may have been modified without authorization","expression":"(\n    (utimes.file.path
      == \"/etc/sudoers\")\n) && process.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\",
      \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/containerd\",
      \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]","category":"File
      Activity","creationDate":0,"updateDate":1699614609831,"filters":["os == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"yq3-x9w-n3j","attributes":{"version":2,"name":"tar_execution","description":"Tar
      archive created","expression":"exec.file.path == \"/usr/bin/tar\" && exec.args_flags
      in [\"create\",\"c\"]","category":"Process Activity","creationDate":0,"updateDate":1699614609831,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"sfh-mqa-shl","attributes":{"version":24,"name":"ssl_certificate_tampering_chown","description":"SSL
      certificates may have been tampered with","expression":"(\n    (chown.file.path
      in [ ~\"/etc/ssl/certs/**\", ~\"/etc/pki/**\" ])\n    && process.file.path not
      in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)
      && (chown.file.destination.uid != chown.file.uid || chown.file.destination.gid
      != chown.file.gid)\n&& process.file.path != \"/usr/sbin/update-ca-certificates\"\n&&
      process.ancestors.file.path != \"/usr/sbin/update-ca-certificates\"\n&& process.ancestors.file.path
      not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n&&
      process.file.name !~ \"runc*\"","category":"File Activity","creationDate":1642158535153,"updateDate":1699614609662,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"f6g-gbx-9l6","attributes":{"version":4,"name":"auditd_rule_file_modified","description":"The
      auditd rules file was modified without using auditctl","expression":"open.file.path
      in [\"/etc/audit/rules.d/audit.rules\", \"/etc/audit/audit.rules\"] && open.flags
      & (O_CREAT|O_TRUNC|O_RDWR|O_WRONLY) > 0 && process.file.name != \"auditctl\"","category":"File
      Activity","creationDate":0,"updateDate":1699614609625,"filters":["os == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"ysi-0bm-8tc","attributes":{"version":34,"name":"kernel_module_chmod","description":"A
      new kernel module was added","expression":"(\n    (chmod.file.path in [ ~\"/lib/modules/**\",
      ~\"/usr/lib/modules/**\" ])\n    && process.file.path not in [~\"/usr/bin/apt*\",
      \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\",
      ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n    &&
      process.ancestors.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\",
      \"/sbin/apk\", \"/usr/lib/snapd/snapd\"] && process.ancestors.file.path != \"/usr/bin/kmod\"\n)
      && chmod.file.destination.mode != chmod.file.mode","category":"File Activity","creationDate":1642158535040,"updateDate":1699614609526,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"0sl-ako-4w6","attributes":{"version":24,"name":"ssl_certificate_tampering_utimes","description":"SSL
      certificates may have been tampered with","expression":"(\n    (utimes.file.path
      in [ ~\"/etc/ssl/certs/**\" ])\n    && process.file.path not in [~\"/usr/bin/apt*\",
      \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\",
      ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)\n&&
      process.file.path != \"/usr/sbin/update-ca-certificates\"\n&& process.ancestors.file.path
      != \"/usr/sbin/update-ca-certificates\"\n&& process.ancestors.file.path not
      in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n&&
      process.file.name !~ \"runc*\"","category":"File Activity","creationDate":0,"updateDate":1699614609522,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"4ec-mzv-u5g","attributes":{"version":5,"name":"kernel_module_load","description":"A
      kernel module was loaded","expression":"load_module.name not in [\"nf_tables\",
      \"iptable_filter\", \"ip6table_filter\", \"bpfilter\", \"ip6_tables\", \"ip6table_nat\",
      \"nf_reject_ipv4\", \"ipt_REJECT\", \"iptable_raw\"] && process.ancestors.file.name
      not in [~\"falcon*\", \"unattended-upgrade\", \"apt.systemd.daily\", \"xtables-legacy-multi\",
      \"ssm-agent-worker\"]","category":"Kernel Activity","creationDate":1650293718458,"updateDate":1699614609521,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"kik-wm5-my4","attributes":{"version":5,"name":"dynamic_linker_config_unlink","description":"A
      process unlinked a dynamic linker config file","expression":"unlink.file.path
      in [\"/etc/ld.so.preload\", \"/etc/ld.so.conf\", ~\"/etc/ld.so.conf.d/*.conf\"]
      && process.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\",
      \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]","category":"File Activity","creationDate":0,"updateDate":1699614609521,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"tji-eua-ery","attributes":{"version":2,"name":"sudoers_policy_modified_rename","description":"Sudoers
      policy file may have been modified without authorization","expression":"(\n    (rename.file.path
      == \"/etc/sudoers\"\n    || rename.file.destination.path == \"/etc/sudoers\")\n)","category":"File
      Activity","creationDate":0,"updateDate":1699614609520,"filters":["os == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"bpi-apd-1ad","attributes":{"version":1,"name":"offensive_k8s_tool","description":"A
      known kubernetes pentesting tool has been executed","expression":"(exec.file.name
      in [ ~\"python*\" ] && (\"KubiScan.py\" in exec.argv || \"kubestriker\" in exec.argv
      ) ) || exec.file.name in [ \"kubiscan\",\"kdigger\",\"kube-hunter\",\"rakkess\",\"peirates\",\"kubescape\",\"kubeaudit\",\"kube-linter\",\"stratus\",~\"botb-*\"]","category":"Process
      Activity","creationDate":0,"updateDate":1699605542656,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"rcz-xwn-5lq","attributes":{"version":1,"name":"redis_save_module","description":"Redis
      module has been created","expression":"(open.flags & (O_CREAT|O_TRUNC|O_RDWR|O_WRONLY)
      > 0 && open.file.path =~ \"/tmp/**\" && open.file.name in [~\"*.rdb\", ~\"*.aof\",
      ~\"*.so\"]) && process.file.name in [\"redis-check-rdb\", \"redis-server\"]","category":"File
      Activity","creationDate":0,"updateDate":1699605540650,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"oit-dq6-jtz","attributes":{"version":4,"name":"net_util_exfiltration","description":"Exfiltration
      attempt via network utility","expression":"exec.comm in [\"wget\", \"curl\",
      \"lwp-download\"] && \nexec.args_options in [ ~\"post-file=*\", ~\"post-data=*\",
      ~\"T=*\", ~\"d=@*\", ~\"upload-file=*\", ~\"F=file*\"] &&\nexec.args not in
      [~\"*localhost*\", ~\"*127.0.0.1*\"]","category":"Process Activity","creationDate":0,"updateDate":1699605533426,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"wos-cqg-alj","attributes":{"version":27,"name":"pci_11_5_critical_binaries_rename","description":"Critical
      system binaries may have been modified","expression":"(\n    (rename.file.path
      in [ ~\"/bin/*\", ~\"/sbin/*\", ~\"/usr/bin/*\", ~\"/usr/sbin/*\", ~\"/usr/local/bin/*\",
      ~\"/usr/local/sbin/*\", ~\"/boot/**\" ]\n    || rename.file.destination.path
      in [ ~\"/bin/*\", ~\"/sbin/*\", ~\"/usr/bin/*\", ~\"/usr/sbin/*\", ~\"/usr/local/bin/*\",
      ~\"/usr/local/sbin/*\", ~\"/boot/**\" ])\n    && process.file.path not in [~\"/usr/bin/apt*\",
      \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/containerd\",
      \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]\n    &&
      process.ancestors.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\",
      \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)","category":"File Activity","creationDate":1642158535169,"updateDate":1699605533116,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"1bt-oqb-nhw","attributes":{"version":27,"name":"pci_11_5_critical_binaries_link","description":"Critical
      system binaries may have been modified","expression":"(\n    (link.file.path
      in [ ~\"/bin/*\", ~\"/sbin/*\", ~\"/usr/bin/*\", ~\"/usr/sbin/*\", ~\"/usr/local/bin/*\",
      ~\"/usr/local/sbin/*\", ~\"/boot/**\" ]\n    || link.file.destination.path in
      [ ~\"/bin/*\", ~\"/sbin/*\", ~\"/usr/bin/*\", ~\"/usr/sbin/*\", ~\"/usr/local/bin/*\",
      ~\"/usr/local/sbin/*\", ~\"/boot/**\" ])\n    && process.file.path not in [~\"/usr/bin/apt*\",
      \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/containerd\",
      \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]\n    &&
      process.ancestors.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\",
      \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)","category":"File Activity","creationDate":1642158535044,"updateDate":1699605533055,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"f1p-4uk-ji9","attributes":{"version":2,"name":"selinux_disable_enforcement","description":"SELinux
      enforcement status was disabled","expression":"selinux.enforce.status in [\"permissive\",
      \"disabled\"] && process.ancestors.args != ~\"*BECOME-SUCCESS*\"","category":"Kernel
      Activity","creationDate":1635332067172,"updateDate":1699605533031,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"ewk-kr1-m8w","attributes":{"version":6,"name":"runc_modification","description":"The
      runc binary was modified in a non-standard way","expression":"open.file.path
      in [\"/usr/bin/runc\", \"/usr/sbin/runc\", \"/usr/bin/docker-runc\"]\n&& open.flags
      & O_CREAT|O_TRUNC|O_RDWR|O_WRONLY > 0\n&& process.file.path not in [~\"/usr/bin/apt*\",
      \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/containerd\",
      \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]\n&&
      process.ancestors.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\",
      \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]","category":"File Activity","creationDate":1627392837049,"updateDate":1699605532961,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"4ym-hxb-nfc","attributes":{"version":27,"name":"pci_11_5_critical_binaries_utimes","description":"Critical
      system binaries may have been modified","expression":"(\n    (utimes.file.path
      in [ ~\"/bin/*\", ~\"/sbin/*\", ~\"/usr/bin/*\", ~\"/usr/sbin/*\", ~\"/usr/local/bin/*\",
      ~\"/usr/local/sbin/*\", ~\"/boot/**\" ])\n    && process.file.path not in [~\"/usr/bin/apt*\",
      \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/containerd\",
      \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]\n    &&
      process.ancestors.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\",
      \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)","category":"File Activity","creationDate":1642158535079,"updateDate":1699605532927,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"39x-fmc-9sw","attributes":{"version":27,"name":"pci_11_5_critical_binaries_chown","description":"Critical
      system binaries may have been modified","expression":"(\n    (chown.file.path
      in [ ~\"/bin/*\", ~\"/sbin/*\", ~\"/usr/bin/*\", ~\"/usr/sbin/*\", ~\"/usr/local/bin/*\",
      ~\"/usr/local/sbin/*\", ~\"/boot/**\" ])\n    && process.file.path not in [~\"/usr/bin/apt*\",
      \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/containerd\",
      \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]\n    &&
      process.ancestors.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\",
      \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n) && (chown.file.destination.uid !=
      chown.file.uid || chown.file.destination.gid != chown.file.gid)","category":"File
      Activity","creationDate":1642158535097,"updateDate":1699605532862,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"3xp-uvx-hxk","attributes":{"version":13,"name":"apparmor_modified_tty","description":"An
      AppArmor profile was modified in an interactive session","expression":"exec.file.name
      in [\"aa-disable\", \"aa-complain\", \"aa-audit\"] && exec.tty_name !=\"\"","category":"Process
      Activity","creationDate":1627392836162,"updateAuthorUuId":"f4183a42-8a64-11ea-93df-c318904b3ca4","updateDate":1699605532856,"filters":["os
      == \"linux\""],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"v4a-bat-ppk","attributes":{"version":27,"name":"pci_11_5_critical_binaries_chmod","description":"Critical
      system binaries may have been modified","expression":"(\n    (chmod.file.path
      in [ ~\"/bin/*\", ~\"/sbin/*\", ~\"/usr/bin/*\", ~\"/usr/sbin/*\", ~\"/usr/local/bin/*\",
      ~\"/usr/local/sbin/*\", ~\"/boot/**\" ])\n    && process.file.path not in [~\"/usr/bin/apt*\",
      \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/containerd\",
      \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]\n    &&
      process.ancestors.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\",
      \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n) && chmod.file.destination.mode !=
      chmod.file.mode","category":"File Activity","creationDate":1642158535079,"updateDate":1699605532822,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"ylg-dxo-yuk","attributes":{"version":2,"name":"rc_scripts_modified","description":"RC
      scripts modified","expression":"(open.flags & (O_CREAT|O_TRUNC|O_RDWR|O_WRONLY)
      > 0 && (open.file.path in [\"/etc/rc.common\", \"/etc/rc.local\"])) && process.ancestors.file.path
      not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]","category":"File
      Activity","creationDate":0,"updateDate":1699605532814,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"mal-nic-u3y","attributes":{"version":3,"name":"Deno_unauthorized_subprocess_created","description":"Unauthorized
      subprocess created by deno runtime","expression":"exec.comm !=\"\" && process.ancestors.comm==\"deno\"
      && process.ancestors.args not in [r\".*(allow-run|-A|allow-all).*\"]","category":"Process
      Activity","creationAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","creationDate":1691743022082,"updateAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","updateDate":1692012153553,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":false,"creator":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"},"updater":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"}},"type":"agent_rule"},{"id":"cwq-z6j-igp","attributes":{"version":2,"name":"Deno_unauthorized_network_access_performed","description":"Unauthorized
      network access by deno runtime","expression":"bind.addr.family>=0 && process.comm==\"deno\"
      && process.args not in [r\".*(allow-net|allow-ffi|-A|allow-all).*\"]","category":"Kernel
      Activity","creationAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","creationDate":1691743022106,"updateAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","updateDate":1692012153529,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":false,"creator":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"},"updater":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"}},"type":"agent_rule"},{"id":"hfc-a0c-8yl","attributes":{"version":1,"name":"executable_bit_added","description":"The
      executable bit was added to a newly created file","expression":"chmod.file.in_upper_layer
      &&\nchmod.file.change_time < 30s &&\ncontainer.id != \"\" &&\nchmod.file.destination.mode
      != chmod.file.mode &&\nchmod.file.destination.mode & S_IXUSR|S_IXGRP|S_IXOTH
      > 0 &&\nprocess.argv in [\"+x\"]","category":"File Activity","creationDate":0,"updateDate":1690311003102,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"osi-fya-a5p","attributes":{"version":19,"name":"ssh_authorized_keys_link","description":"SSH
      modified keys may have been modified","expression":"(\n    link.file.name in
      [ \"authorized_keys\", \"authorized_keys2\" ] && (link.file.path in [ ~\"/root/.ssh/*\",
      ~\"/home/*/.ssh/*\", ~\"/var/lib/*/.ssh/*\" ]\n    || link.file.destination.path
      in [ ~\"/root/.ssh/*\", ~\"/home/*/.ssh/*\", ~\"/var/lib/*/.ssh/*\" ])\n)","category":"File
      Activity","creationDate":1642158535286,"updateDate":1690311003028,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"o5j-dvu-sdy","attributes":{"version":19,"name":"ssh_authorized_keys_utimes","description":"SSH
      modified keys may have been modified","expression":"(\n    utimes.file.name
      in [ \"authorized_keys\", \"authorized_keys2\" ] && (utimes.file.path in [ ~\"/root/.ssh/*\",
      ~\"/home/*/.ssh/*\", ~\"/var/lib/*/.ssh/*\" ])\n)","category":"File Activity","creationDate":1642158535278,"updateDate":1690311003028,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"rut-8bg-ycb","attributes":{"version":31,"name":"credential_modified_utimes","description":"Sensitive
      credential files were modified using a non-standard tool","expression":"(\n    (utimes.file.path
      in [ \"/etc/shadow\", \"/etc/gshadow\" ])\n    && process.file.path not in [
      \"/sbin/vipw\", \"/usr/sbin/vipw\", \"/sbin/vigr\", \"/usr/sbin/vigr\", \"/usr/bin/containerd\",
      \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\", \"/usr/local/bin/dockerd\",
      \"/usr/sbin/groupadd\", \"/usr/sbin/useradd\", \"/usr/sbin/usermod\", \"/usr/sbin/userdel\",
      \"/usr/bin/gpasswd\", \"/usr/bin/chage\", \"/usr/sbin/chpasswd\", \"/usr/bin/passwd\"
      ]\n    && process.ancestors.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\",
      \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\",
      \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)","category":"File
      Activity","creationDate":1642158535200,"updateDate":1690311003028,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"qka-g4s-khh","attributes":{"version":19,"name":"ssh_authorized_keys_open","description":"SSH
      modified keys may have been modified","expression":"(\n    open.flags & (O_CREAT|O_TRUNC|O_RDWR|O_WRONLY)
      > 0 &&\n    open.file.name in [ \"authorized_keys\", \"authorized_keys2\" ]
      && (open.file.path in [ ~\"/root/.ssh/*\", ~\"/home/*/.ssh/*\", ~\"/var/lib/*/.ssh/*\"
      ])\n)","category":"File Activity","creationDate":1642158534864,"updateDate":1690311003028,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"g5n-jhl-zge","attributes":{"version":17,"name":"pam_modification_rename","description":"PAM
      may have been modified without authorization","expression":"(\n    (rename.file.path
      in [ ~\"/etc/pam.d/**\", \"/etc/pam.conf\" ]\n    || rename.file.destination.path
      in [ ~\"/etc/pam.d/**\", \"/etc/pam.conf\" ])\n)","category":"File Activity","creationDate":1606142936138,"updateDate":1690311003028,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"xrg-evq-ka5","attributes":{"version":17,"name":"pam_modification_unlink","description":"PAM
      may have been modified without authorization","expression":"(\n    (unlink.file.path
      in [ ~\"/etc/pam.d/**\", \"/etc/pam.conf\" ])\n)","category":"File Activity","creationDate":1606142936138,"updateDate":1690311003028,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"nnu-ch5-3gm","attributes":{"version":1,"name":"deploy_priv_container","description":"A
      privileged container was created","expression":"exec.file.name != \"\" && container.created_at
      < 1s && process.cap_permitted & CAP_SYS_ADMIN > 0","category":"Process Activity","creationDate":0,"updateDate":1688748464067,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"6ln-wqy-y8b","attributes":{"version":1,"name":"net_util_in_container_v2","description":"A
      network utility was executed in a container","expression":"(exec.comm in [\"socat\",
      \"dig\", \"nslookup\", \"host\", ~\"netcat*\", ~\"nc*\", \"ncat\"] ||\n exec.comm
      in [\"wget\", \"curl\", \"lwp-download\"]) &&\ncontainer.id != \"\" && exec.args
      not in [ ~\"*localhost*\", ~\"*127.0.0.1*\", ~\"*motd.ubuntu.com*\" ] && container.created_at
      > 180s","category":"Process Activity","creationDate":0,"updateDate":1688748463994,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"hmy-il6-bk5","attributes":{"version":1,"name":"hidden_file_executed","description":"A
      hidden file was executed in a suspicious folder","expression":"exec.file.name
      =~ \".*\" && exec.file.path in [~\"/home/**\", ~\"/tmp/**\", ~\"/var/tmp/**\",
      ~\"/dev/shm/**\"]","category":"Process Activity","creationDate":0,"updateDate":1688748463951,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"iwa-79s-pb3","attributes":{"version":1,"name":"shell_profile_modification","description":"Shell
      profile was modified","expression":"open.file.path in [~\"/home/*/*profile\",
      ~\"/home/*/*rc\"] && open.flags & ((O_CREAT|O_TRUNC|O_RDWR|O_WRONLY)) > 0","category":"File
      Activity","creationDate":0,"updateDate":1688748463951,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"mr2-bwg-0jr","attributes":{"version":1,"name":"suid_file_execution","description":"a
      SUID file was executed","expression":"(setuid.euid == 0 || setuid.uid  == 0)  &&
      process.file.mode & S_ISUID > 0  && process.file.uid == 0  && process.uid !=
      0  && process.file.path != \"/usr/bin/sudo\"","category":"File Activity","creationDate":0,"updateDate":1688748463947,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"zdz-pje-kbg","attributes":{"version":4,"name":"python_cli_code","description":"Python
      code was provided on the command line","expression":"exec.file.name == ~\"python*\"
      && exec.args_flags in [\"c\"] && exec.args in [~\"*-c*SOCK_STREAM*\", ~\"*-c*subprocess*\",
      \"*-c*/bash*\", \"*-c*/bin/sh*\", \"*-c*pty.spawn*\"] && exec.args !~ \"*setuptools*\"","category":"Process
      Activity","creationDate":0,"updateDate":1688748460425,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"doi-13m-kzx","attributes":{"version":1,"name":"kubernetes_offensive_tool_executed","description":"Kubernetes
      offensive tool executed","expression":"(exec.file.name in [ ~\"python*\" ] &&
      (\"KubiScan.py\" in exec.argv || \"kubestriker\" in exec.argv )) || exec.file.name
      in [\"kubiscan\",\"kdigger\",\"kube-hunter\",\"rakkess\",\"peirates\",\"kubescape\",\"kubeaudit\",\"kube-linter\",\"stratus\",~\"botb-*\"]","category":"Process
      Activity","creationAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","creationDate":1688462439963,"updateAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","updateDate":1688462439963,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":false,"creator":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"},"updater":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"}},"type":"agent_rule"},{"id":"nrd-9be-wnm","attributes":{"version":9,"name":"compiler_in_container","description":"Compiler
      Executed in Container","expression":"(exec.file.name in [\"javac\", \"clang\",
      \"gcc\",\"bcc\"] || (exec.file.name == \"go\" && exec.args in [~\"*build*\",
      ~\"*run*\"])) && container.id !=\"\" && process.ancestors.file.path != \"/usr/bin/cilium-agent\"","category":"Process
      Activity","creationDate":1627392836759,"updateAuthorUuId":"9d3a4eb0-1e67-11ed-b20c-da7ad0900002","updateDate":1685978095211,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"John
      Murray","handle":"john.murray@datadoghq.com"}},"type":"agent_rule"},{"id":"jea-2m4-kyy","attributes":{"version":1,"name":"curl_docker_socket","description":"The
      Docker socket was referenced in a cURL command","expression":"exec.file.name
      == \"curl\" && exec.args_flags in [\"unix-socket\"] && exec.args in [\"*docker.sock*\"]
      && container.id != \"\"","category":"Process Activity","creationDate":0,"updateDate":1684184973805,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"i1f-7yg-x6s","attributes":{"version":1,"name":"sudoers_policy_modified_link","description":"Sudoers
      policy file may have been modified without authorization","expression":"(\n    (link.file.path
      == \"/etc/sudoers\"\n    || link.file.destination.path == \"/etc/sudoers\")\n)","category":"File
      Activity","creationDate":0,"updateDate":1684184973412,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"r5j-bb3-dmf","attributes":{"version":1,"name":"read_release_info","description":"OS
      information was read from the /etc/lsb-release file","expression":"open.file.path
      == \"/etc/lsb-release\" && open.flags & O_RDONLY > 0","category":"File Activity","creationDate":0,"updateDate":1684184973295,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"98m-cex-egg","attributes":{"version":1,"name":"user_deleted_tty","description":"A
      user was deleted via an interactive session","expression":"exec.file.name in
      [\"userdel\", \"deluser\"] && exec.tty_name !=\"\" && process.ancestors.file.path
      not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]","category":"Process
      Activity","creationDate":0,"updateDate":1684184973238,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"luc-at7-mvw","attributes":{"version":1,"name":"sudoers_policy_modified_chown","description":"Sudoers
      policy file may have been modified without authorization","expression":"(\n    (chown.file.path
      == \"/etc/sudoers\")\n) && (chown.file.destination.uid != chown.file.uid ||
      chown.file.destination.gid != chown.file.gid)","category":"File Activity","creationDate":0,"updateDate":1684184973211,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"8qc-61h-epb","attributes":{"version":1,"name":"sudoers_policy_modified_unlink","description":"Sudoers
      policy file may have been modified without authorization","expression":"(\n    (unlink.file.path
      == \"/etc/sudoers\")\n)","category":"File Activity","creationDate":0,"updateDate":1684184973209,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"2np-cy4-jad","attributes":{"version":1,"name":"service_stop","description":"systemctl
      used to stop a service","expression":"exec.file.name == \"systemctl\" && exec.args
      in [~\"*stop*\"]","category":"Process Activity","creationDate":0,"updateDate":1684184973206,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"azw-asm-uwe","attributes":{"version":1,"name":"read_kubeconfig","description":"The
      kubeconfig file was accessed","expression":"open.file.path in [~\"/home/*/.kube/config\",
      \"/root/.kube/config\"]","category":"File Activity","creationDate":0,"updateDate":1684184973196,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"qp4-oog-vwu","attributes":{"version":1,"name":"jupyterhub_shell","description":"A
      shell command was executed from a JupyterHub code cell","expression":"exec.file.path
      == \"/usr/bin/bash\" && process.ancestors.comm == \"jupyterhub-sing\"","category":"Process
      Activity","creationAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","creationDate":1682687626099,"updateAuthorUuId":"9b3398f3-af79-49aa-b643-8a607ee6f848","updateDate":1682687626099,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":false,"creator":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"},"updater":{"name":"Threat
      Detection Engineering CI/CD","handle":"9b3398f3-af79-49aa-b643-8a607ee6f848"}},"type":"agent_rule"},{"id":"k2h-ntz-zno","attributes":{"version":3,"name":"auditctl_usage","description":"The
      auditctl command was used to modify auditd","expression":"exec.file.name ==
      \"auditctl\"","category":"Process Activity","creationDate":0,"updateDate":1681806567456,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"Cl\u00e9ment
      Kuzniewycz","handle":"clement.kuzniewycz@datadoghq.com"}},"type":"agent_rule"},{"id":"fft-hfp-fuu","attributes":{"version":7,"name":"aws_eks_service_account_token_accessed","description":"The
      AWS EKS service account token was accessed","expression":"open.file.path =~
      \"/var/run/secrets/eks.amazonaws.com/serviceaccount/**\" && open.file.name ==
      \"token\" && process.file.path not in [\"/opt/datadog-agent/embedded/bin/agent\",
      \"/opt/datadog-agent/embedded/bin/system-probe\", \"/opt/datadog-agent/embedded/bin/security-agent\",
      \"/opt/datadog-agent/embedded/bin/process-agent\", \"/opt/datadog-agent/bin/agent/agent\",
      \"/opt/datadog/apm/inject/auto_inject_runc\", \"/usr/bin/dd-host-install\",
      \"/usr/bin/dd-host-container-install\", \"/usr/bin/dd-container-install\", \"/opt/datadog-agent/bin/datadog-cluster-agent\"]","category":"File
      Activity","creationDate":0,"updateDate":1681806564733,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"Cl\u00e9ment
      Kuzniewycz","handle":"clement.kuzniewycz@datadoghq.com"}},"type":"agent_rule"},{"id":"ucr-akl-jgo","attributes":{"version":3,"name":"aws_imds","description":"An
      AWS IMDS was called via a network utility","expression":"exec.comm in [\"wget\",
      \"curl\", \"lwp-download\"] && exec.args in [~\"*169.254.169.254/latest/meta-data/iam/security-credentials/*\",
      \"*169.254.170.2$AWS_CONTAINER_CREDENTIALS_RELATIVE_URI\", ~\"*169.254.170.2/*/credentials?id=*\"]","category":"Process
      Activity","creationDate":0,"updateDate":1681806563896,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"Cl\u00e9ment
      Kuzniewycz","handle":"clement.kuzniewycz@datadoghq.com"}},"type":"agent_rule"},{"id":"p6d-hln-r9c","attributes":{"version":23,"name":"ssl_certificate_tampering_chmod","description":"SSL
      certificates may have been tampered with","expression":"(\n    (chmod.file.path
      in [ ~\"/etc/ssl/certs/**\", ~\"/etc/pki/**\" ])\n    && process.file.path not
      in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)
      && chmod.file.mode != chmod.file.destination.mode\n&& process.file.path != \"/usr/sbin/update-ca-certificates\"\n&&
      process.ancestors.file.path != \"/usr/sbin/update-ca-certificates\"\n&& process.ancestors.file.path
      not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n&&
      process.file.name !~ \"runc*\"","category":"File Activity","creationDate":1642158535314,"updateDate":1681490426484,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"9e8-rvn-6hv","attributes":{"version":23,"name":"ssl_certificate_tampering_unlink","description":"SSL
      certificates may have been tampered with","expression":"(\n    (unlink.file.path
      in [ ~\"/etc/ssl/certs/**\" ])\n    && process.file.path not in [~\"/usr/bin/apt*\",
      \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\",
      ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)\n&&
      process.file.path != \"/usr/sbin/update-ca-certificates\"\n&& process.ancestors.file.path
      != \"/usr/sbin/update-ca-certificates\"\n&& process.ancestors.file.path not
      in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n&&
      process.file.name !~ \"runc*\"","category":"File Activity","creationDate":1642158535055,"updateDate":1681490425998,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"rim-3ys-upw","attributes":{"version":3,"name":"dynamic_linker_config_write","description":"A
      process wrote to a dynamic linker config file","expression":"open.file.path
      in [\"/etc/ld.so.preload\", \"/etc/ld.so.conf\", \"/etc/ld.so.conf.d/*.conf\"]
      && open.flags & (O_CREAT|O_TRUNC|O_RDWR|O_WRONLY) > 0 && process.file.path not
      in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/containerd\", \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\"] && process.ancestors.file.path not in
      [\"/opt/datadog-agent/embedded/bin/agent\", \"/opt/datadog-agent/embedded/bin/system-probe\",
      \"/opt/datadog-agent/embedded/bin/security-agent\", \"/opt/datadog-agent/embedded/bin/process-agent\",
      \"/opt/datadog-agent/bin/agent/agent\", \"/opt/datadog/apm/inject/auto_inject_runc\",
      \"/usr/bin/dd-host-install\", \"/usr/bin/dd-host-container-install\", \"/usr/bin/dd-container-install\",
      \"/opt/datadog-agent/bin/datadog-cluster-agent\"]","category":"File Activity","creationDate":0,"updateDate":1681490425873,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"twt-qsc-twv","attributes":{"version":23,"name":"ssl_certificate_tampering_link","description":"SSL
      certificates may have been tampered with","expression":"(\n    (link.file.path
      in [ ~\"/etc/ssl/certs/**\", ~\"/etc/pki/**\" ]\n    || link.file.destination.path
      in [ ~\"/etc/ssl/certs/**\", ~\"/etc/pki/**\" ])\n    && process.file.path not
      in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n    &&
      process.file.path != \"/usr/sbin/update-ca-certificates\"\n    && process.ancestors.file.path
      != \"/usr/sbin/update-ca-certificates\"\n    && process.ancestors.file.path
      not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n    &&
      process.file.name !~ \"runc*\"\n)","category":"File Activity","creationDate":1642158535139,"updateDate":1681490425573,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"1n2-xpg-6nx","attributes":{"version":23,"name":"ssl_certificate_tampering_open","description":"SSL
      certificates may have been tampered with","expression":"(\n    open.flags &
      (O_CREAT|O_RDWR|O_WRONLY) > 0 &&\n    (open.file.path in [ ~\"/etc/ssl/certs/**\",
      ~\"/etc/pki/**\" ])\n)\n&& process.file.path != \"/usr/sbin/update-ca-certificates\"\n&&
      process.ancestors.file.path != \"/usr/sbin/update-ca-certificates\"\n&& process.ancestors.file.path
      not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n&&
      process.file.name !~ \"runc*\"","category":"File Activity","creationDate":0,"updateDate":1681490425289,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"uot-9ro-hpp","attributes":{"version":2,"name":"shell_history_deleted","description":"Shell
      History was Deleted","expression":"(unlink.file.name  =~ r\".([dbazfi]*sh)(_history)$\")
      && process.comm not in  [\"dockerd\", \"containerd\"]","category":"File Activity","creationDate":0,"updateDate":1681490425280,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"jxj-xnb-lua","attributes":{"version":3,"name":"shell_history_truncated","description":"Shell
      History was Deleted","expression":"open.flags & (O_CREAT|O_TRUNC|O_RDWR|O_WRONLY)
      > 0 && open.file.name =~ r\".([dbazfi]*sh)(_history)$\" && open.file.path in
      [~\"/root/*\", ~\"/home/**\"] && process.file.name == \"truncate\"","category":"File
      Activity","creationDate":0,"updateDate":1681490425220,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"gur-w5f-2kn","attributes":{"version":23,"name":"ssl_certificate_tampering_rename","description":"SSL
      certificates may have been tampered with","expression":"(\n    (rename.file.path
      in [ ~\"/etc/ssl/certs/**\", ~\"/etc/pki/**\" ]\n    || rename.file.destination.path
      in [ ~\"/etc/ssl/certs/**\", ~\"/etc/pki/**\" ])\n    && process.file.path not
      in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)\n&&
      process.file.path != \"/usr/sbin/update-ca-certificates\"\n&& process.ancestors.file.path
      != \"/usr/sbin/update-ca-certificates\"\n&& process.ancestors.file.path not
      in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n&&
      process.file.name !~ \"runc*\"","category":"File Activity","creationDate":1642158535082,"updateDate":1681490425217,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"jiu-wmv-ig0","attributes":{"version":35,"name":"credential_modified_chmod","description":"Sensitive
      credential files were modified using a non-standard tool","expression":"(\n    (chmod.file.path
      in [ \"/etc/shadow\", \"/etc/gshadow\" ])\n    && process.file.path not in [
      \"/sbin/vipw\", \"/usr/sbin/vipw\", \"/sbin/vigr\", \"/usr/sbin/vigr\", \"/usr/bin/containerd\",
      \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\", \"/usr/local/bin/dockerd\",
      \"/usr/sbin/groupadd\", \"/usr/sbin/useradd\", \"/usr/sbin/usermod\", \"/usr/sbin/userdel\",
      \"/usr/bin/gpasswd\", \"/usr/bin/chage\", \"/usr/sbin/chpasswd\", \"/usr/bin/passwd\"
      ]\n    && process.ancestors.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\",
      \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\",
      \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n) && chmod.file.destination.mode
      != chmod.file.mode","category":"File Activity","creationDate":1642158535177,"updateDate":1678909084442,"filters":[],"actions":[],"agentConstraint":"","enabled":false,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"Nick
      Allen","handle":"nick.allen@datadoghq.com"}},"type":"agent_rule"},{"id":"bg2-noz-ouf","attributes":{"version":6,"name":"dirty_pipe_attempt","description":"Potential
      Dirty pipe exploitation attempt","expression":"(splice.pipe_entry_flag & PIPE_BUF_FLAG_CAN_MERGE)
      != 0 && (splice.pipe_exit_flag & PIPE_BUF_FLAG_CAN_MERGE) == 0 && (process.uid
      != 0 && process.gid != 0)","category":"File Activity","creationDate":1648564123603,"updateDate":1678308032425,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"Alexander
      Daskalov","handle":"alexander.daskalov@datadoghq.com"}},"type":"agent_rule"},{"id":"ydj-k3d-kh3","attributes":{"version":4,"name":"ip_check_domain","description":"A
      DNS lookup was done for a IP check service","expression":"dns.question.name
      in [\"icanhazip.com\", \"ip-api.com\", \"myip.opendns.com\", \"checkip.amazonaws.com\",
      \"whatismyip.akamai.com\"] && process.file.name != \"\"","category":"Network
      Activity","creationDate":1648643213312,"updateDate":1678307295173,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"Alexander
      Daskalov","handle":"alexander.daskalov@datadoghq.com"}},"type":"agent_rule"},{"id":"i64-vlz-y6u","attributes":{"version":22,"name":"systemd_modification_chmod","description":"A
      service may have been modified without authorization","expression":"(\n    (chmod.file.path
      in [ ~\"/lib/systemd/system/**\", ~\"/usr/lib/systemd/system/**\", ~\"/etc/systemd/system/**\"
      ])\n    && process.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\",
      \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\",
      \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n) && chmod.file.destination.mode
      != chmod.file.mode","category":"File Activity","creationDate":1642158535224,"updateDate":1677793411681,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"69h-fh3-8gd","attributes":{"version":1,"name":"tty_shell_in_container","description":"A
      shell with a TTY was executed in a container","expression":"exec.file.path in
      [ \"/bin/dash\",\n  \"/usr/bin/dash\",\n  \"/bin/sh\",\n  \"/bin/static-sh\",\n  \"/usr/bin/sh\",\n  \"/bin/bash\",\n  \"/usr/bin/bash\",\n  \"/bin/bash-static\",\n  \"/usr/bin/zsh\",\n  \"/usr/bin/ash\",\n  \"/usr/bin/csh\",\n  \"/usr/bin/ksh\",\n  \"/usr/bin/tcsh\",\n  \"/usr/lib/initramfs-tools/bin/busybox\",\n  \"/bin/busybox\",\n  \"/usr/bin/fish\",\n  \"/bin/ksh93\",\n  \"/bin/rksh\",\n  \"/bin/rksh93\",\n  \"/bin/lksh\",\n  \"/bin/mksh\",\n  \"/bin/mksh-static\",\n  \"/usr/bin/csharp\",\n  \"/bin/posh\",\n  \"/usr/bin/rc\",\n  \"/bin/sash\",\n  \"/usr/bin/yash\",\n  \"/bin/zsh5\",\n  \"/bin/zsh5-static\"
      ] && process.tty_name != \"\" && process.container.id != \"\"","category":"Process
      Activity","creationDate":0,"updateDate":1677793400846,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"ygs-aya-gxb","attributes":{"version":1,"name":"redis_sandbox_escape","description":"Detects
      CVE-2022-0543","expression":"(open.file.path =~ \"/usr/lib/x86_64-linux-gnu/*\"
      && open.file.name in [\"libc-2.29.so\", \"libc-2.30.so\", \"libc-2.31.so\",
      \"libc-2.32.so\", \"libc-2.33.so\", \"libc-2.34.so\", \"libc-2.35.so\", \"libc-2.36.so\",
      \"libc-2.37.so\"]) && process.ancestors.comm in [\"redis-check-rdb\", \"redis-server\"]","category":"File
      Activity","creationDate":0,"updateDate":1677793399338,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"h2l-v6b-akf","attributes":{"version":1,"name":"base64_decode","description":"The
      base64 command was used to decode information","expression":"exec.file.name
      == \"base64\" && exec.args_flags in [\"d\"]","category":"Process Activity","creationDate":0,"updateDate":1677793399280,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"jvq-pxe-ygn","attributes":{"version":21,"name":"systemd_modification_rename","description":"A
      service may have been modified without authorization","expression":"(\n    (rename.file.path
      in [ ~\"/lib/systemd/system/**\", ~\"/usr/lib/systemd/system/**\", ~\"/etc/systemd/system/**\"
      ]\n    || rename.file.destination.path in [ ~\"/lib/systemd/system/**\", ~\"/usr/lib/systemd/system/**\",
      ~\"/etc/systemd/system/**\" ])\n    && process.file.path not in [~\"/usr/bin/apt*\",
      \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\",
      ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)","category":"File
      Activity","creationDate":0,"updateDate":1677793384295,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"esw-xou-pwg","attributes":{"version":11,"name":"package_management_in_container","description":"Package
      management was detected in a container","expression":"exec.file.path in [~\"/usr/bin/apt*\",
      \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\",
      ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]
      && container.id != \"\"","category":"Process Activity","creationDate":1617722067648,"updateDate":1677793383505,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"0yf-x4j-zbg","attributes":{"version":6,"name":"user_created_tty","description":"A
      user was created via an interactive session","expression":"exec.file.name in
      [\"useradd\", \"newusers\", \"adduser\"] && exec.tty_name !=\"\" && process.ancestors.file.path
      not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]
      && exec.args_flags not in [\"D\"]","category":"Process Activity","creationDate":1627392836979,"updateDate":1677793382984,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"7nm-5gf-ghj","attributes":{"version":3,"name":"new_binary_execution_in_container","description":"A
      container executed a new binary not found in the container image","expression":"container.id
      != \"\" && process.file.in_upper_layer && process.file.modification_time < 30s
      && exec.file.name != \"\"","category":"Process Activity","creationDate":1652129906455,"updateDate":1677793380182,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"wib-i2s-0eb","attributes":{"version":17,"name":"pam_modification_utimes","description":"PAM
      may have been modified without authorization","expression":"(\n    (utimes.file.path
      in [ ~\"/etc/pam.d/**\", \"/etc/pam.conf\" ])\n) && process.file.path not in
      [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/containerd\", \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]","category":"File Activity","creationDate":1606142936138,"updateDate":1677793376369,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"d1p-2un-5ay","attributes":{"version":21,"name":"systemd_modification_link","description":"A
      service may have been modified without authorization","expression":"(\n    (link.file.path
      in [ ~\"/lib/systemd/system/**\", ~\"/usr/lib/systemd/system/**\", ~\"/etc/systemd/system/**\"
      ]\n    || link.file.destination.path in [ ~\"/lib/systemd/system/**\", ~\"/usr/lib/systemd/system/**\",
      ~\"/etc/systemd/system/**\" ])\n    && process.file.path not in [~\"/usr/bin/apt*\",
      \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\",
      ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)","category":"File
      Activity","creationDate":0,"updateDate":1677793376080,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"aic-m2b-kbp","attributes":{"version":22,"name":"systemd_modification_chown","description":"A
      service may have been modified without authorization","expression":"(\n    (chown.file.path
      in [ ~\"/lib/systemd/system/**\", ~\"/usr/lib/systemd/system/**\", ~\"/etc/systemd/system/**\"
      ])\n    && process.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\",
      \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\",
      \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n) && (chown.file.destination.uid
      != chown.file.uid || chown.file.destination.gid != chown.file.gid)","category":"File
      Activity","creationDate":0,"updateDate":1677793375206,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"rxa-v6v-oyz","attributes":{"version":31,"name":"credential_modified_rename","description":"Sensitive
      credential files were modified using a non-standard tool","expression":"(\n    (rename.file.path
      in [ \"/etc/shadow\", \"/etc/gshadow\" ]\n    || rename.file.destination.path
      in [ \"/etc/shadow\", \"/etc/gshadow\" ])\n    && process.file.path not in [
      \"/sbin/vipw\", \"/usr/sbin/vipw\", \"/sbin/vigr\", \"/usr/sbin/vigr\", \"/usr/bin/containerd\",
      \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\", \"/usr/local/bin/dockerd\",
      \"/usr/sbin/groupadd\", \"/usr/sbin/useradd\", \"/usr/sbin/usermod\", \"/usr/sbin/userdel\",
      \"/usr/bin/gpasswd\", \"/usr/bin/chage\", \"/usr/sbin/chpasswd\", \"/usr/bin/passwd\"
      ]\n    && process.ancestors.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\",
      \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\",
      \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)","category":"File
      Activity","creationDate":1642158535356,"updateDate":1677793375033,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"tys-u1m-rgt","attributes":{"version":33,"name":"kernel_module_chown","description":"A
      new kernel module was added","expression":"(\n    (chown.file.path in [ ~\"/lib/modules/**\",
      ~\"/usr/lib/modules/**\" ])\n    && process.file.path not in [~\"/usr/bin/apt*\",
      \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\",
      ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n    &&
      process.ancestors.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\",
      \"/sbin/apk\", \"/usr/lib/snapd/snapd\"] && process.ancestors.file.path != \"/usr/bin/kmod\"\n)
      && (chown.file.destination.uid != chown.file.uid || chown.file.destination.gid
      != chown.file.gid)","category":"File Activity","creationDate":1598516746168,"updateDate":1677793374885,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"hzz-0oh-mji","attributes":{"version":32,"name":"kernel_module_utimes","description":"A
      new kernel module was added","expression":"(\n    (utimes.file.path in [ ~\"/lib/modules/**\",
      ~\"/usr/lib/modules/**\" ])\n    && process.file.path not in [~\"/usr/bin/apt*\",
      \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\",
      ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n    &&
      process.ancestors.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\",
      \"/sbin/apk\", \"/usr/lib/snapd/snapd\"] && process.ancestors.file.path != \"/usr/bin/kmod\"\n)","category":"File
      Activity","creationDate":1598516746168,"updateDate":1677793374395,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"om1-5ch-5sf","attributes":{"version":32,"name":"kernel_module_unlink","description":"A
      new kernel module was added","expression":"(\n    (unlink.file.path in [ ~\"/lib/modules/**\",
      ~\"/usr/lib/modules/**\" ])\n    && process.file.path not in [~\"/usr/bin/apt*\",
      \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\",
      ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n    &&
      process.ancestors.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\",
      \"/sbin/apk\", \"/usr/lib/snapd/snapd\"] && process.ancestors.file.path != \"/usr/bin/kmod\"\n)","category":"File
      Activity","creationDate":1598516746168,"updateDate":1677793372622,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"wwu-ysx-rm7","attributes":{"version":32,"name":"kernel_module_rename","description":"A
      new kernel module was added","expression":"(\n    (rename.file.path in [ ~\"/lib/modules/**\",
      ~\"/usr/lib/modules/**\" ]\n    || rename.file.destination.path in [ ~\"/lib/modules/**\",
      ~\"/usr/lib/modules/**\" ])\n    && process.file.path not in [~\"/usr/bin/apt*\",
      \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\",
      ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n    &&
      process.ancestors.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\",
      \"/sbin/apk\", \"/usr/lib/snapd/snapd\"] && process.ancestors.file.path != \"/usr/bin/kmod\"\n)","category":"File
      Activity","creationDate":1642158535229,"updateDate":1677793372373,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"rza-8h3-4lj","attributes":{"version":32,"name":"credential_modified_chown","description":"Sensitive
      credential files were modified using a non-standard tool","expression":"(\n    (chown.file.path
      in [ \"/etc/shadow\", \"/etc/gshadow\" ])\n    && process.file.path not in [
      \"/sbin/vipw\", \"/usr/sbin/vipw\", \"/sbin/vigr\", \"/usr/sbin/vigr\", \"/usr/bin/containerd\",
      \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\", \"/usr/local/bin/dockerd\",
      \"/usr/sbin/groupadd\", \"/usr/sbin/useradd\", \"/usr/sbin/usermod\", \"/usr/sbin/userdel\",
      \"/usr/bin/gpasswd\", \"/usr/bin/chage\", \"/usr/sbin/chpasswd\", \"/usr/bin/passwd\"
      ]\n    && process.ancestors.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\",
      \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\",
      \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n) && (chown.file.destination.uid
      != chown.file.uid || chown.file.destination.gid != chown.file.gid)","category":"File
      Activity","creationDate":1642158534952,"updateDate":1677793372165,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"s17-cle-cuf","attributes":{"version":31,"name":"credential_modified_link","description":"Sensitive
      credential files were modified using a non-standard tool","expression":"(\n    (link.file.path
      in [ \"/etc/shadow\", \"/etc/gshadow\" ]\n    || link.file.destination.path
      in [ \"/etc/shadow\", \"/etc/gshadow\" ])\n    && process.file.path not in [
      \"/sbin/vipw\", \"/usr/sbin/vipw\", \"/sbin/vigr\", \"/usr/sbin/vigr\", \"/usr/bin/containerd\",
      \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\", \"/usr/local/bin/dockerd\",
      \"/usr/sbin/groupadd\", \"/usr/sbin/useradd\", \"/usr/sbin/usermod\", \"/usr/sbin/userdel\",
      \"/usr/bin/gpasswd\", \"/usr/bin/chage\", \"/usr/sbin/chpasswd\", \"/usr/bin/passwd\"
      ]\n    && process.ancestors.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\",
      \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\",
      \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)","category":"File
      Activity","creationDate":1642158535271,"updateDate":1677793372149,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"ty2-qc4-drd","attributes":{"version":32,"name":"kernel_module_link","description":"A
      new kernel module was added","expression":"(\n    (link.file.path in [ ~\"/lib/modules/**\",
      ~\"/usr/lib/modules/**\" ]\n    || link.file.destination.path in [ ~\"/lib/modules/**\",
      ~\"/usr/lib/modules/**\" ])\n    && process.file.path not in [~\"/usr/bin/apt*\",
      \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\",
      ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n    &&
      process.ancestors.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\",
      \"/sbin/apk\", \"/usr/lib/snapd/snapd\"] && process.ancestors.file.path != \"/usr/bin/kmod\"\n)","category":"File
      Activity","creationDate":1642158535200,"updateDate":1677793372103,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"hsk-ug8-fu7","attributes":{"version":32,"name":"kernel_module_open","description":"A
      new kernel module was added","expression":"(\n    open.flags & (O_CREAT|O_TRUNC|O_RDWR|O_WRONLY)
      > 0 &&\n    (open.file.path in [ ~\"/lib/modules/**\", ~\"/usr/lib/modules/**\"
      ])\n    && process.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\",
      \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\",
      \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n    && process.ancestors.file.path
      not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\", \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]
      && process.ancestors.file.path != \"/usr/bin/kmod\"\n)","category":"File Activity","creationDate":1598516746168,"updateDate":1677793371891,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"rme-dmd-trz","attributes":{"version":31,"name":"credential_modified_unlink","description":"Sensitive
      credential files were modified using a non-standard tool","expression":"(\n    (unlink.file.path
      in [ \"/etc/shadow\", \"/etc/gshadow\" ])\n    && process.file.path not in [
      \"/sbin/vipw\", \"/usr/sbin/vipw\", \"/sbin/vigr\", \"/usr/sbin/vigr\", \"/usr/bin/containerd\",
      \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\", \"/usr/local/bin/dockerd\",
      \"/usr/sbin/groupadd\", \"/usr/sbin/useradd\", \"/usr/sbin/usermod\", \"/usr/sbin/userdel\",
      \"/usr/bin/gpasswd\", \"/usr/bin/chage\", \"/usr/sbin/chpasswd\", \"/usr/bin/passwd\"
      ]\n    && process.ancestors.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\",
      \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\",
      \"/usr/bin/yum\", \"/sbin/apk\", \"/usr/lib/snapd/snapd\"]\n)","category":"File
      Activity","creationDate":1642158535113,"updateDate":1677793371890,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"bya-q5x-vjt","attributes":{"version":24,"name":"cron_at_job_creation_rename","description":"An
      unauthorized job was added to cron scheduling","expression":"(\n    (rename.file.path
      in [ ~\"/var/spool/cron/**\", ~\"/etc/cron.*/**\", ~\"/etc/crontab\" ]\n    ||
      rename.file.destination.path in [ ~\"/var/spool/cron/**\", ~\"/etc/cron.*/**\",
      ~\"/etc/crontab\" ])\n    && process.file.path not in [ \"/usr/bin/at\", \"/usr/bin/crontab\"
      ]\n)\n&& process.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/containerd\", \"/usr/local/bin/containerd\",
      \"/usr/bin/dockerd\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]","category":"File
      Activity","creationDate":1606142961130,"updateDate":1674486419017,"filters":[],"actions":[],"agentConstraint":"","enabled":false,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"6p8-mws-jmo","attributes":{"version":1,"name":"potential_web_shell_parent","description":"A
      web application spawned a shell or shell utility","expression":"(exec.file.path
      in [ \"/bin/dash\",\n  \"/usr/bin/dash\",\n  \"/bin/sh\",\n  \"/bin/static-sh\",\n  \"/usr/bin/sh\",\n  \"/bin/bash\",\n  \"/usr/bin/bash\",\n  \"/bin/bash-static\",\n  \"/usr/bin/zsh\",\n  \"/usr/bin/ash\",\n  \"/usr/bin/csh\",\n  \"/usr/bin/ksh\",\n  \"/usr/bin/tcsh\",\n  \"/usr/lib/initramfs-tools/bin/busybox\",\n  \"/bin/busybox\",\n  \"/usr/bin/fish\",\n  \"/bin/ksh93\",\n  \"/bin/rksh\",\n  \"/bin/rksh93\",\n  \"/bin/lksh\",\n  \"/bin/mksh\",\n  \"/bin/mksh-static\",\n  \"/usr/bin/csharp\",\n  \"/bin/posh\",\n  \"/usr/bin/rc\",\n  \"/bin/sash\",\n  \"/usr/bin/yash\",\n  \"/bin/zsh5\",\n  \"/bin/zsh5-static\"
      ] || exec.comm in [\"wget\", \"curl\", \"lwp-download\"] || exec.file.path in
      [\"/bin/cat\",\"/bin/chgrp\",\"/bin/chmod\",\"/bin/chown\",\"/bin/cp\",\"/bin/date\",\"/bin/dd\",\"/bin/df\",\"/bin/dir\",\"/bin/echo\",\"/bin/ln\",\"/bin/ls\",\"/bin/mkdir\",\"/bin/mknod\",\"/bin/mktemp\",\"/bin/mv\",\"/bin/pwd\",\"/bin/readlink\",\"/bin/rm\",\"/bin/rmdir\",\"/bin/sleep\",\"/bin/stty\",\"/bin/sync\",\"/bin/touch\",\"/bin/uname\",\"/bin/vdir\",\"/usr/bin/arch\",\"/usr/bin/b2sum\",\"/usr/bin/base32\",\"/usr/bin/base64\",\"/usr/bin/basename\",\"/usr/bin/chcon\",\"/usr/bin/cksum\",\"/usr/bin/comm\",\"/usr/bin/csplit\",\"/usr/bin/cut\",\"/usr/bin/dircolors\",\"/usr/bin/dirname\",\"/usr/bin/du\",\"/usr/bin/env\",\"/usr/bin/expand\",\"/usr/bin/expr\",\"/usr/bin/factor\",\"/usr/bin/fmt\",\"/usr/bin/fold\",\"/usr/bin/groups\",\"/usr/bin/head\",\"/usr/bin/hostid\",\"/usr/bin/id\",\"/usr/bin/install\",\"/usr/bin/join\",\"/usr/bin/link\",\"/usr/bin/logname\",\"/usr/bin/md5sum\",\"/usr/bin/md5sum.textutils\",\"/usr/bin/mkfifo\",\"/usr/bin/nice\",\"/usr/bin/nl\",\"/usr/bin/nohup\",\"/usr/bin/nproc\",\"/usr/bin/numfmt\",\"/usr/bin/od\",\"/usr/bin/paste\",\"/usr/bin/pathchk\",\"/usr/bin/pinky\",\"/usr/bin/pr\",\"/usr/bin/printenv\",\"/usr/bin/printf\",\"/usr/bin/ptx\",\"/usr/bin/realpath\",\"/usr/bin/runcon\",\"/usr/bin/seq\",\"/usr/bin/sha1sum\",\"/usr/bin/sha224sum\",\"/usr/bin/sha256sum\",\"/usr/bin/sha384sum\",\"/usr/bin/sha512sum\",\"/usr/bin/shred\",\"/usr/bin/shuf\",\"/usr/bin/sort\",\"/usr/bin/split\",\"/usr/bin/stat\",\"/usr/bin/stdbuf\",\"/usr/bin/sum\",\"/usr/bin/tac\",\"/usr/bin/tail\",\"/usr/bin/tee\",\"/usr/bin/test\",\"/usr/bin/timeout\",\"/usr/bin/tr\",\"/usr/bin/truncate\",\"/usr/bin/tsort\",\"/usr/bin/tty\",\"/usr/bin/unexpand\",\"/usr/bin/uniq\",\"/usr/bin/unlink\",\"/usr/bin/users\",\"/usr/bin/wc\",\"/usr/bin/who\",\"/usr/bin/whoami\",\"/usr/sbin/chroot\"])
      &&\n(process.parent.file.name in [\"apache2\", \"nginx\", ~\"tomcat*\", \"httpd\"]
      || process.parent.file.name =~ \"php*\")","category":"Process Activity","creationDate":0,"updateDate":1674486410462,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"c3b-qwh-lwy","attributes":{"version":1,"name":"mount_host_fs","description":"The
      host file system was mounted in a container","expression":"mount.source.path
      == \"/\" && mount.fs_type != \"overlay\" && container.id != \"\"","category":"File
      Activity","creationDate":0,"updateDate":1674486409763,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"mfw-adh-mba","attributes":{"version":1,"name":"memfd_create","description":"memfd
      object created","expression":"exec.file.name =~ \"memfd*\" && exec.file.path
      == \"\"","category":"Process Activity","creationDate":0,"updateDate":1674486409582,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"ylo-d9p-7e2","attributes":{"version":25,"name":"cron_at_job_creation_chmod","description":"An
      unauthorized job was added to cron scheduling","expression":"(\n    (chmod.file.path
      in [ ~\"/var/spool/cron/**\", ~\"/etc/cron.*/**\", ~\"/etc/crontab\" ])\n    &&
      process.file.path not in [ \"/usr/bin/at\", \"/usr/bin/crontab\" ]\n) && chmod.file.destination.mode
      != chmod.file.mode\n&& process.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\",
      \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/containerd\",
      \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]","category":"File
      Activity","creationDate":1606142961130,"updateDate":1674486392555,"filters":[],"actions":[],"agentConstraint":"","enabled":false,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"zwi-z69-wxv","attributes":{"version":25,"name":"cron_at_job_creation_chown","description":"An
      unauthorized job was added to cron scheduling","expression":"(\n    (chown.file.path
      in [ ~\"/var/spool/cron/**\", ~\"/etc/cron.*/**\", ~\"/etc/crontab\" ])\n    &&
      process.file.path not in [ \"/usr/bin/at\", \"/usr/bin/crontab\" ]\n) && (chown.file.destination.uid
      != chown.file.uid || chown.file.destination.gid != chown.file.gid)\n&& process.file.path
      not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/containerd\", \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]","category":"File Activity","creationDate":1606142961130,"updateDate":1674486392076,"filters":[],"actions":[],"agentConstraint":"","enabled":false,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"abd-4hy-aep","attributes":{"version":25,"name":"cron_at_job_creation_utimes","description":"An
      unauthorized job was added to cron scheduling","expression":"(\n    (utimes.file.path
      in [ ~\"/var/spool/cron/**\", ~\"/etc/cron.*/**\", ~\"/etc/crontab\" ])\n    &&
      process.file.path not in [ \"/usr/bin/at\", \"/usr/bin/crontab\" ]\n)\n&& process.file.path
      not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/containerd\", \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]","category":"File Activity","creationDate":1606142961130,"updateDate":1674486391087,"filters":[],"actions":[],"agentConstraint":"","enabled":false,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"kft-h30-mqm","attributes":{"version":25,"name":"cron_at_job_creation_unlink","description":"An
      unauthorized job was added to cron scheduling","expression":"(\n    (unlink.file.path
      in [ ~\"/var/spool/cron/**\", ~\"/etc/cron.*/**\", ~\"/etc/crontab\" ])\n    &&
      process.file.path not in [ \"/usr/bin/at\", \"/usr/bin/crontab\" ]\n)\n&& process.file.path
      not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\",
      \"/usr/bin/containerd\", \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\",
      \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]","category":"File Activity","creationDate":1606142961130,"updateDate":1674486390957,"filters":[],"actions":[],"agentConstraint":"","enabled":false,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"xda-xrq-k9e","attributes":{"version":25,"name":"cron_at_job_creation_open","description":"An
      unauthorized job was added to cron scheduling","expression":"(\n    open.flags
      & (O_CREAT|O_RDWR|O_WRONLY) > 0 &&\n    (open.file.path in [ ~\"/var/spool/cron/**\",
      ~\"/etc/cron.*/**\", ~\"/etc/crontab\" ])\n    && process.file.path not in [
      \"/usr/bin/at\", \"/usr/bin/crontab\" ]\n)\n&& process.file.path not in [~\"/usr/bin/apt*\",
      \"/usr/bin/dpkg\", \"/usr/bin/rpm\", \"/usr/bin/unattended-upgrade\", \"/usr/bin/containerd\",
      \"/usr/local/bin/containerd\", \"/usr/bin/dockerd\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]","category":"File
      Activity","creationDate":1606142961130,"updateDate":1674486390712,"filters":[],"actions":[],"agentConstraint":"","enabled":false,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"vxt-pdr-0cl","attributes":{"version":25,"name":"cron_at_job_creation_link","description":"An
      unauthorized job was added to cron scheduling","expression":"(\n    (link.file.path
      in [ ~\"/var/spool/cron/**\", ~\"/etc/cron.*/**\", ~\"/etc/crontab\" ]\n    ||
      link.file.destination.path in [ ~\"/var/spool/cron/**\", ~\"/etc/cron.*/**\",
      ~\"/etc/crontab\" ])\n    && process.file.path not in [ \"/usr/bin/at\", \"/usr/bin/crontab\"
      ]\n)\n&& process.file.path not in [~\"/usr/bin/apt*\", \"/usr/bin/dpkg\", \"/usr/bin/rpm\",
      \"/usr/bin/unattended-upgrade\", \"/usr/bin/containerd\", \"/usr/local/bin/containerd\",
      \"/usr/bin/dockerd\", \"/usr/bin/npm\", ~\"/usr/bin/pip*\"]","category":"File
      Activity","creationDate":1606142961130,"updateDate":1674486390691,"filters":[],"actions":[],"agentConstraint":"","enabled":false,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"z01-5m6-bbi","attributes":{"version":1,"name":"gcp_imds","description":"An
      GCP IMDS was called via a network utility","expression":"exec.comm in [\"wget\",
      \"curl\", \"lwp-download\"] && exec.args in [~\"*metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/token\",
      ~\"*169.254.169.254/computeMetadata/v1/instance/service-accounts/default/token\"]","category":"Process
      Activity","creationDate":0,"updateDate":1670604148337,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"tez-7by-uke","attributes":{"version":1,"name":"azure_imds","description":"An
      Azure IMDS was called via a network utility","expression":"exec.comm in [\"wget\",
      \"curl\", \"lwp-download\"] && exec.args in [~\"*169.254.169.254/metadata/identity/oauth2/token?api-version=*\"]","category":"Process
      Activity","creationDate":0,"updateDate":1670604148316,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"fcs-rzj-p0a","attributes":{"version":1,"name":"net_unusual_request","description":"Network
      utility executed with suspicious URI","expression":"exec.comm in [\"wget\",
      \"curl\", \"lwp-download\"] && exec.args in [~\"*.php*\", ~\"*.jpg*\"] ","category":"Process
      Activity","creationDate":0,"updateDate":1670604148316,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"u4x-0kv-jq1","attributes":{"version":2,"name":"ptrace_antidebug","description":"A
      process uses an anti-debugging technique to block debuggers","expression":"ptrace.request
      == PTRACE_TRACEME && process.file.name != \"\"","category":"Kernel Activity","creationDate":1650293718435,"updateDate":1670604142703,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"hyc-d0a-iat","attributes":{"version":9,"name":"passwd_execution","description":"The
      passwd or chpasswd utility was used to modify an account password","expression":"exec.file.path
      in [\"/usr/bin/passwd\", \"/usr/sbin/chpasswd\"] && exec.args_flags not in [\"S\",
      \"status\"]","category":"Process Activity","creationDate":1617722068383,"updateDate":1666888149907,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"vls-ztk-8p0","attributes":{"version":2,"name":"dirty_pipe_exploitation","description":"Potential
      Dirty pipe exploitation","expression":"(splice.pipe_exit_flag & PIPE_BUF_FLAG_CAN_MERGE)
      > 0  && (process.uid != 0 && process.gid != 0)","category":"File Activity","creationDate":1648564123563,"updateDate":1666888149012,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"3ga-ibr-dlw","attributes":{"version":19,"name":"net_util_in_container","description":"A
      network utility was executed in a container","expression":"(exec.comm in [\"socat\",
      \"dig\", \"nslookup\", \"host\", ~\"netcat*\", ~\"nc*\", \"ncat\"] ||\n exec.comm
      in [\"wget\", \"curl\", \"lwp-download\"]) &&\ncontainer.id != \"\" && exec.args
      not in [ ~\"*localhost*\", ~\"*127.0.0.1*\", ~\"*motd.ubuntu.com*\" ]","category":"Process
      Activity","creationDate":1617722068439,"updateDate":1666888148873,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"kel-je5-jhu","attributes":{"version":14,"name":"net_util","description":"A
      network utility was executed","expression":"(exec.comm in [\"socat\", \"dig\",
      \"nslookup\", \"host\", ~\"netcat*\", ~\"nc*\", \"ncat\"] ||\n exec.comm in
      [\"wget\", \"curl\", \"lwp-download\"]) &&\ncontainer.id == \"\" && exec.args
      not in [ ~\"*localhost*\", ~\"*127.0.0.1*\", ~\"*motd.ubuntu.com*\" ]","category":"Process
      Activity","creationDate":1617722067377,"updateDate":1666888148817,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"zp1-2vr-dji","attributes":{"version":1,"name":"ld_preload_unusual_library_path","description":"The
      LD_PRELOAD variable is populated by a link to a suspicious file directory","expression":"exec.envs
      in [~\"LD_PRELOAD=*/tmp/*\" ,~\"LD_PRELOAD=/dev/shm/*\" ]","category":"Process
      Activity","creationDate":0,"updateDate":1665475122104,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"iha-seu-ukg","attributes":{"version":18,"name":"pam_modification_chown","description":"PAM
      may have been modified without authorization","expression":"(\n    (chown.file.path
      in [ ~\"/etc/pam.d/**\", \"/etc/pam.conf\" ])\n) && (chown.file.destination.uid
      != chown.file.uid || chown.file.destination.gid != chown.file.gid)","category":"File
      Activity","creationDate":1642158535185,"updateDate":1665475117830,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"5jz-f4m-ujl","attributes":{"version":17,"name":"pam_modification_chmod","description":"PAM
      may have been modified without authorization","expression":"(\n    (chmod.file.path
      in [ ~\"/etc/pam.d/**\", \"/etc/pam.conf\" ])\n) && chmod.file.destination.mode
      != chmod.file.mode","category":"File Activity","creationDate":1606142936138,"updateDate":1665475098297,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"hyg-xco-0yu","attributes":{"version":19,"name":"ssh_authorized_keys_chmod","description":"SSH
      modified keys may have been modified","expression":"(\n    chmod.file.name in
      [ \"authorized_keys\", \"authorized_keys2\" ] && (chmod.file.path in [ ~\"/root/.ssh/*\",
      ~\"/home/*/.ssh/*\", ~\"/var/lib/*/.ssh/*\" ])\n) && chmod.file.destination.mode
      != chmod.file.mode","category":"File Activity","creationDate":1642158535014,"updateDate":1665475096405,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"m6c-qaa-oq5","attributes":{"version":1,"name":"shell_history_symlink","description":"A
      symbolic link for shell history was created targeting /dev/null","expression":"exec.comm
      == \"ln\" && exec.args in [~\"*.*history*\", \"/dev/null\"]","category":"Process
      Activity","creationDate":0,"updateDate":1661193978111,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"e8x-hfv-opq","attributes":{"version":3,"name":"potential_cryptominer","description":"A
      process resolved a DNS name associated with cryptomining activity","expression":"dns.question.name
      in [~\"*minexmr.com\", ~\"*nanopool.org\", ~\"*supportxmr.com\", ~\"*c3pool.com\",
      ~\"*p2pool.io\", ~\"*ethermine.org\", ~\"*f2pool.com\", ~\"*poolin.me\", ~\"*rplant.xyz\"]
      && process.file.name != \"\"","category":"Network Activity","creationDate":1648643213236,"updateDate":1658502066736,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"o9o-bqw-xda","attributes":{"version":2,"name":"paste_site","description":"A
      DNS lookup was done for a pastebin-like site","expression":"dns.question.name
      in [\"pastebin.com\", \"ghostbin.com\", \"termbin.com\", \"klgrth.io\"] && process.file.name
      != \"\"","category":"Network Activity","creationDate":1648643213212,"updateDate":1654020328112,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"ozc-4r6-5v6","attributes":{"version":2,"name":"kernel_module_load_container","description":"A
      container loaded a new kernel module","expression":"load_module.name != \"\"
      && container.id !=\"\"","category":"Kernel Activity","creationDate":1650293718705,"updateDate":1650371510304,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"qxl-uky-d3i","attributes":{"version":1,"name":"ptrace_injection","description":"A
      process attempted to inject code into another process","expression":"ptrace.request
      == PTRACE_POKETEXT || ptrace.request == PTRACE_POKEDATA || ptrace.request ==
      PTRACE_POKEUSR","category":"Kernel Activity","creationDate":1650293718540,"updateDate":1650293782685,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"hkb-qnu-nin","attributes":{"version":1,"name":"kernel_module_load_from_memory_container","description":"A
      kernel module was loaded from memory inside a container","expression":"load_module.loaded_from_memory
      == true && container.id !=\"\"","category":"Kernel Activity","creationDate":1650293718365,"updateDate":1650293782651,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"vgp-c7n-4ww","attributes":{"version":17,"name":"pam_modification_open","description":"PAM
      may have been modified without authorization","expression":"(\n    open.flags
      & (O_CREAT|O_TRUNC|O_RDWR|O_WRONLY) > 0 &&\n    (open.file.path in [ ~\"/etc/pam.d/**\",
      \"/etc/pam.conf\" ])\n)","category":"File Activity","creationDate":1642158535331,"updateDate":1643993958380,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"dk5-qem-ukk","attributes":{"version":17,"name":"pam_modification_link","description":"PAM
      may have been modified without authorization","expression":"(\n    (link.file.path
      in [ ~\"/etc/pam.d/**\", \"/etc/pam.conf\" ]\n    || link.file.destination.path
      in [ ~\"/etc/pam.d/**\", \"/etc/pam.conf\" ])\n)","category":"File Activity","creationDate":1642158535089,"updateDate":1643993957839,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"g0j-tcx-9yi","attributes":{"version":16,"name":"nsswitch_conf_mod_link","description":"Nsswitch
      Configuration Modified","expression":"(\n    (link.file.path in [ \"/etc/nsswitch.conf\"
      ]\n    || link.file.destination.path in [ \"/etc/nsswitch.conf\" ])\n)","category":"File
      Activity","creationDate":1606142958657,"updateDate":1628512222322,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"wu3-ect-q5y","attributes":{"version":16,"name":"nsswitch_conf_mod_rename","description":"Nsswitch
      Configuration Modified","expression":"(\n    (rename.file.path in [ \"/etc/nsswitch.conf\"
      ]\n    || rename.file.destination.path in [ \"/etc/nsswitch.conf\" ])\n)","category":"File
      Activity","creationDate":1606142958657,"updateDate":1628512222322,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"nfl-b7w-jla","attributes":{"version":16,"name":"nsswitch_conf_mod_unlink","description":"Nsswitch
      Configuration Modified","expression":"(\n    (unlink.file.path in [ \"/etc/nsswitch.conf\"
      ])\n)","category":"File Activity","creationDate":1606142958657,"updateDate":1628512222322,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"},{"id":"vti-qnm-wg7","attributes":{"version":16,"name":"nsswitch_conf_mod_utimes","description":"Nsswitch
      Configuration Modified","expression":"(\n    (utimes.file.path in [ \"/etc/nsswitch.conf\"
      ])\n)","category":"File Activity","creationDate":1606142958657,"updateDate":1628512222322,"filters":[],"actions":[],"agentConstraint":"","enabled":true,"defaultRule":true,"creator":{"name":"","handle":""},"updater":{"name":"","handle":""}},"type":"agent_rule"}]}

      '
    code: 200
    duration: 0ms
    headers:
      Content-Type:
      - application/json
    status: 200 OK
- request:
    body: ''
    form: {}
    headers:
      Accept:
      - '*/*'
    id: 2
    method: DELETE
    url: https://api.datadoghq.com/api/v2/security_monitoring/cloud_workload_security/agent_rules/gd2-ogg-fyk
  response:
    body: ''
    code: 204
    duration: 0ms
    headers: {}
    status: 204 No Content
version: 2
